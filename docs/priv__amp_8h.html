<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.19"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>qCrypto: errorcorrection/subcomponents/priv_amp.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">qCrypto
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
   <div id="projectbrief">A collection of code for a practical entanglement-based quantum key distribution system</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.19 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('priv__amp_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">priv_amp.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>privacy amplification portions of the code  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="defaultdefinitions_8h_source.html">../definitions/defaultdefinitions.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="globalvars_8h_source.html">../definitions/globalvars.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="processblock_8h_source.html">../definitions/processblock.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="packets_8h_source.html">../definitions/packets.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="pkt__header__7_8h_source.html">../../packetheaders/pkt_header_7.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="comms_8h_source.html">comms.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="helpers_8h_source.html">helpers.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="debug_8h_source.html">debug.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="processblock__mgmt_8h_source.html">processblock_mgmt.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for priv_amp.h:</div>
<div class="dyncontent">
<div class="center"><img src="priv__amp_8h__incl.png" border="0" usemap="#aerrorcorrection_2subcomponents_2priv__amp_8h" alt=""/></div>
<map name="errorcorrection_2subcomponents_2priv__amp_8h" id="errorcorrection_2subcomponents_2priv__amp_8h">
<area shape="rect" title="privacy amplification portions of the code" alt="" coords="909,5,1110,47"/>
<area shape="rect" href="defaultdefinitions_8h.html" title="Definition file for default variables in ecd2." alt="" coords="1062,751,1269,777"/>
<area shape="rect" href="globalvars_8h.html" title="Definition file for global variables and arguments in ecd2." alt="" coords="926,95,1093,121"/>
<area shape="rect" href="helpers_8h.html" title="helper functions or helper enums for ecd2" alt="" coords="642,169,825,196"/>
<area shape="rect" href="processblock_8h.html" title="Header file containing the definitions of the processBlock &amp; block related data for the error correct..." alt="" coords="439,676,561,703"/>
<area shape="rect" href="packets_8h.html" title=" " alt="" coords="985,594,1140,621"/>
<area shape="rect" href="comms_8h.html" title="code on communications w.r.t. error correction." alt="" coords="499,512,575,539"/>
<area shape="rect" href="debug_8h.html" title="debugging helper functions for ecd2" alt="" coords="429,594,497,621"/>
<area shape="rect" href="processblock__mgmt_8h.html" title=" " alt="" coords="1131,512,1282,539"/>
<area shape="rect" href="pkt__header__7_8h.html" title=" " alt="" coords="1420,587,1551,628"/>
<area shape="rect" href="algorithms_8h.html" title="Definition file for error correction algorithms." alt="" coords="347,244,504,285"/>
<area shape="rect" href="rnd_8h.html" title="Random number sources." alt="" coords="1056,512,1107,539"/>
<area shape="rect" href="packet__manager_8h.html" title="Definition file for structure involving packet management of algorithm and its metadata in the proces..." alt="" coords="257,751,386,777"/>
<area shape="rect" href="data__manager_8h.html" title="Definition file for structure involving data management of algorithm specific data and its metadata i..." alt="" coords="411,751,589,777"/>
<area shape="rect" href="cascade__biconf_8h.html" title="Cascade biconf algorithm implementation." alt="" coords="904,423,1043,464"/>
<area shape="rect" href="qber__estim_8h.html" title=" " alt="" coords="640,333,779,375"/>
<area shape="rect" href="proc__state_8h.html" title="Defines processing states." alt="" coords="737,587,860,628"/>
<area shape="rect" href="pkt__header__3_8h.html" title=" " alt="" coords="1215,587,1345,628"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="priv__amp_8h__dep__incl.png" border="0" usemap="#aerrorcorrection_2subcomponents_2priv__amp_8hdep" alt=""/></div>
<map name="errorcorrection_2subcomponents_2priv__amp_8hdep" id="errorcorrection_2subcomponents_2priv__amp_8hdep">
<area shape="rect" title="privacy amplification portions of the code" alt="" coords="502,5,703,47"/>
<area shape="rect" href="cascade__biconf_8h.html" title="Cascade biconf algorithm implementation." alt="" coords="710,95,911,136"/>
<area shape="rect" href="algorithms_8h.html" title="Definition file for error correction algorithms." alt="" coords="347,184,515,225"/>
<area shape="rect" href="ecd2_8h.html" title="Error correction demon. (modifications to original errcd see below)." alt="" coords="441,638,589,665"/>
<area shape="rect" href="priv__amp_8c.html" title=" " alt="" coords="1411,95,1613,136"/>
<area shape="rect" href="qber__estim_8h.html" title=" " alt="" coords="950,541,1151,583"/>
<area shape="rect" href="cascade__biconf_8c.html" title=" " alt="" coords="641,184,842,225"/>
<area shape="rect" href="algorithms_8c.html" title=" " alt="" coords="347,273,515,315"/>
<area shape="rect" href="helpers_8h.html" title="helper functions or helper enums for ecd2" alt="" coords="613,273,814,315"/>
<area shape="rect" href="comms_8h.html" title="code on communications w.r.t. error correction." alt="" coords="239,452,441,493"/>
<area shape="rect" href="debug_8h.html" title="debugging helper functions for ecd2" alt="" coords="881,363,1082,404"/>
<area shape="rect" href="globalvars_8h.html" title="Definition file for global variables and arguments in ecd2." alt="" coords="256,363,424,404"/>
<area shape="rect" href="processblock__mgmt_8h.html" title=" " alt="" coords="603,452,805,493"/>
<area shape="rect" href="helpers_8c.html" title=" " alt="" coords="499,363,701,404"/>
<area shape="rect" href="comms_8c.html" title=" " alt="" coords="275,541,477,583"/>
<area shape="rect" href="qber__estim_8c.html" title=" " alt="" coords="950,631,1151,672"/>
<area shape="rect" href="ecd2_8c.html" title=" " alt="" coords="441,720,589,747"/>
<area shape="rect" href="processblock__mgmt_8c.html" title=" " alt="" coords="603,541,805,583"/>
<area shape="rect" href="debug_8c.html" title=" " alt="" coords="881,452,1082,493"/>
</map>
</div>
</div>
<p><a href="priv__amp_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader">PRIVACY AMPLIFICATION HELPER FUNCTIONS</div></td></tr>
<tr class="memitem:a7908e2233e4f07dbb3da7bfa6fcc409b"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="priv__amp_8h.html#a7908e2233e4f07dbb3da7bfa6fcc409b">phi</a> (float z)</td></tr>
<tr class="memdesc:a7908e2233e4f07dbb3da7bfa6fcc409b"><td class="mdescLeft">&#160;</td><td class="mdescRight">helper: eve's error knowledge  <a href="priv__amp_8h.html#a7908e2233e4f07dbb3da7bfa6fcc409b">More...</a><br /></td></tr>
<tr class="separator:a7908e2233e4f07dbb3da7bfa6fcc409b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6191b118553d1fbe518e4cb9dc10c3cd"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="priv__amp_8h.html#a6191b118553d1fbe518e4cb9dc10c3cd">binentrop</a> (float q)</td></tr>
<tr class="separator:a6191b118553d1fbe518e4cb9dc10c3cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">PRIVACY AMPLIFICATION MAIN FUNCTIONS</div></td></tr>
<tr class="memitem:a429724db4a14d3b8171683f1ea4786aa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="priv__amp_8h.html#a429724db4a14d3b8171683f1ea4786aa">privAmp_sendPrivAmpMsgAndPrivAmp</a> (<a class="el" href="data__manager_8h.html#a7dfe752c36d0273736b6282f64b674c6">ProcessBlock</a> *pb)</td></tr>
<tr class="memdesc:a429724db4a14d3b8171683f1ea4786aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to initiate the privacy amplification.  <a href="priv__amp_8h.html#a429724db4a14d3b8171683f1ea4786aa">More...</a><br /></td></tr>
<tr class="separator:a429724db4a14d3b8171683f1ea4786aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a542068c2130f42502e1e4c743251f08b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="priv__amp_8h.html#a542068c2130f42502e1e4c743251f08b">privAmp_receivePrivAmpMsg</a> (<a class="el" href="data__manager_8h.html#a7dfe752c36d0273736b6282f64b674c6">ProcessBlock</a> *pb, char *receivebuf)</td></tr>
<tr class="memdesc:a542068c2130f42502e1e4c743251f08b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to process a privacy amplification message.  <a href="priv__amp_8h.html#a542068c2130f42502e1e4c743251f08b">More...</a><br /></td></tr>
<tr class="separator:a542068c2130f42502e1e4c743251f08b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09193ce60c20fc9ebea0acec44d5e430"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="priv__amp_8h.html#a09193ce60c20fc9ebea0acec44d5e430">privAmp_doPrivAmp</a> (<a class="el" href="data__manager_8h.html#a7dfe752c36d0273736b6282f64b674c6">ProcessBlock</a> *pb, unsigned int seed, int lostbits)</td></tr>
<tr class="memdesc:a09193ce60c20fc9ebea0acec44d5e430"><td class="mdescLeft">&#160;</td><td class="mdescRight">Do core part of the privacy amplification.  <a href="priv__amp_8h.html#a09193ce60c20fc9ebea0acec44d5e430">More...</a><br /></td></tr>
<tr class="separator:a09193ce60c20fc9ebea0acec44d5e430"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>privacy amplification portions of the code </p>
<p><br  />
 Part of the quantum key distribution software for error correction and privacy amplification. Description see below.</p>
<p>Copyright (C) 2020 Matthew Lee, National University of Singapore <a href="#" onclick="location.href='mai'+'lto:'+'cra'+'zo'+'ter'+'@g'+'mai'+'l.'+'com'; return false;">crazo<span style="display: none;">.nosp@m.</span>ter@<span style="display: none;">.nosp@m.</span>gmail<span style="display: none;">.nosp@m.</span>.com</a> Copyright (C) 2005-2007 Christian Kurtsiefer, National University of Singapore <a href="#" onclick="location.href='mai'+'lto:'+'chr'+'is'+'tia'+'n.'+'kur'+'ts'+'ief'+'er'+'@gm'+'ai'+'l.c'+'om'; return false;">chris<span style="display: none;">.nosp@m.</span>tian<span style="display: none;">.nosp@m.</span>.kurt<span style="display: none;">.nosp@m.</span>sief<span style="display: none;">.nosp@m.</span>er@gm<span style="display: none;">.nosp@m.</span>ail.<span style="display: none;">.nosp@m.</span>com</a></p>
<p>This source code is free software; you can redistribute it and/or modify it under the terms of the GNU Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.</p>
<p>This source code is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. Please refer to the GNU Public License for more details.</p>
<p>You should have received a copy of the GNU Public License along with this source code; if not, write to: Free Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</p>
<p>@license GPL-3.0+ <a href="http://spdx.org/licenses/GPL-3.0+">http://spdx.org/licenses/GPL-3.0+</a></p>
<hr  />
<p>This is a refactored version of Kurtsiefer's <a class="el" href="ecd2_8c.html">ecd2.c</a> to modularize parts of the code. This section modularizes the parts of the code that is predominantly used for privacy amplification. </p>

<p class="definition">Definition in file <a class="el" href="priv__amp_8h_source.html">priv_amp.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a6191b118553d1fbe518e4cb9dc10c3cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6191b118553d1fbe518e4cb9dc10c3cd">&#9670;&nbsp;</a></span>binentrop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float binentrop </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>q</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">q</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>float </dd></dl>

<p class="definition">Definition at line <a class="el" href="priv__amp_8c_source.html#l00022">22</a> of file <a class="el" href="priv__amp_8c_source.html">priv_amp.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;                         {</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <span class="keywordflow">return</span> (-q * log(q) - (1 - q) * log(1 - q)) / log(2.);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7908e2233e4f07dbb3da7bfa6fcc409b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7908e2233e4f07dbb3da7bfa6fcc409b">&#9670;&nbsp;</a></span>phi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float phi </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>z</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>helper: eve's error knowledge </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">z</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>float </dd></dl>

<p class="definition">Definition at line <a class="el" href="priv__amp_8c_source.html#l00012">12</a> of file <a class="el" href="priv__amp_8c_source.html">priv_amp.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;                   {</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  <span class="keywordflow">return</span> ((1 + z) * log(1 + z) + (1 - z) * log(1 - z)) / log(2.);</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a09193ce60c20fc9ebea0acec44d5e430"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09193ce60c20fc9ebea0acec44d5e430">&#9670;&nbsp;</a></span>privAmp_doPrivAmp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int privAmp_doPrivAmp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="data__manager_8h.html#a7dfe752c36d0273736b6282f64b674c6">ProcessBlock</a> *&#160;</td>
          <td class="paramname"><em>pb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>seed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lostbits</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Do core part of the privacy amplification. </p>
<p>Calculates the compression ratio based on the lost bits, saves the final key and removes the processBlock from the list.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pb</td><td>processBlock ptr </td></tr>
    <tr><td class="paramname">seed</td><td></td></tr>
    <tr><td class="paramname">lostbits</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0 if success, otherwise error code </dd></dl>

<p class="definition">Definition at line <a class="el" href="priv__amp_8c_source.html#l00091">91</a> of file <a class="el" href="priv__amp_8c_source.html">priv_amp.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                                                                         {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keywordtype">int</span> sneakloss;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordtype">float</span> trueerror, safe_error;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="comment">// float cheeky_error;</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *finalkey;  <span class="comment">/* pointer to final key */</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> m;          <span class="comment">/* addition register */</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordtype">int</span> numwords, mlen;      <span class="comment">/* number of words in final key / message length */</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="keyword">struct </span><a class="code" href="structheader__7.html">header_7</a> *outmsg; <span class="comment">/* keeps output message */</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, j;                <span class="comment">/* counting indices */</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordtype">char</span> <a class="code" href="costream_8c.html#a5e4d5eded57665a7c40e22af8ff60b9a">ffnam</a>[<a class="code" href="defaultdefinitions_8h.html#aec3288ab4aa26c22d51e4bb59434682c">FNAME_LENGTH</a> + 10]; <span class="comment">/* to store filename */</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordtype">int</span> written, rv;              <span class="comment">/* counts writeout bits, return value */</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keywordtype">int</span> redundantloss; <span class="comment">/* keeps track of redundancy in error correction */</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="keywordtype">float</span> BellHelper;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="comment">/* determine final key size */</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="comment">/* redundancy in parity negotiation; we transmit the last bit which could#</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">     be deducked from tracking the whole parity information per block. For</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">     each detected error, there is one bit redundant, which is overcounted</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">     in the leakage */</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  redundantloss = pb-&gt;<a class="code" href="struct_process_blk.html#a898ec0cfdc185bd10dfb14b83c8ba380">correctedErrors</a>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="comment">/* This is the error rate found in the error correction process. It should</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">     be a fair representation of the errors on that block of raw key bits,</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">     but a safety margin on the error of the error should be added, e.g.</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">     in terms of multiples of the standard deviation assuming a poissonian</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">     distribution for errors to happen (not sure why this is a careless</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">     assumption in the first place either. */</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  trueerror = (float)pb-&gt;<a class="code" href="struct_process_blk.html#a898ec0cfdc185bd10dfb14b83c8ba380">correctedErrors</a> / (<span class="keywordtype">float</span>)pb-&gt;<a class="code" href="struct_process_blk.html#a362004851d12dc70281465703a51b9f3">workbits</a>;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="comment">/* This &#39;intrisic error&#39; thing is very dodgy, it should not be used at all</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">     unless you know what Eve is doing (which by definition you don&#39;t).</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">     Therefore, it s functionality is mostly commented out, only the</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">     basic query remains. The idea is based on the hope ventilated</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">     at some point that there is a basic error (of the kind of a detector</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">     dark count rate) which does lead to any information</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">     loss to the eavesdropper. Relies on lack of imagination how an</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">     eavesdropper can influence this basic error rather than on fundamental</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">     laws. Since this is dirty, we might as well assume that such an error</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">     is UNCORRELATED to errors caused by potential eavesdropping, and</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">     assume they add quadratically. Let&#39;s at least check that the true</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">     error is not smaller than the &quot;basic&quot; error..... */</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structarguments.html">arguments</a>.<a class="code" href="structarguments.html#ac44f2a7e77a2650c6698ac567111326f">intrinsicErrRate</a> &lt; trueerror) {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="comment">// Unused code</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="comment">// cheeky_error = sqrt(trueerror * trueerror - arguments.intrinsicErrRate * arguments.intrinsicErrRate);</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="comment">/* Dodgy intrinsic error subtraction would happen here. */</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="comment">/* We now evaluate the knowledge of an eavesdropper on the initial raw</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">       key for a given error rate, excluding the communication on error</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">       correction */</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="structarguments.html">arguments</a>.<a class="code" href="structarguments.html#af78000c59f253e0d7c3ca2f9fb3075c8">bellmode</a>) { <span class="comment">/* do single-photon source bound */</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      safe_error = trueerror;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      <span class="keywordflow">if</span> (pb-&gt;<a class="code" href="struct_process_blk.html#a898ec0cfdc185bd10dfb14b83c8ba380">correctedErrors</a> &gt; 0) {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        safe_error *= (1. + <a class="code" href="structarguments.html">arguments</a>.<a class="code" href="structarguments.html#a782cee4d1f7bd03d966a2ea6afd8b999">errorMargin</a> / sqrt(pb-&gt;<a class="code" href="struct_process_blk.html#a898ec0cfdc185bd10dfb14b83c8ba380">correctedErrors</a>));</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      sneakloss = (int)(<a class="code" href="priv__amp_8c.html#a6191b118553d1fbe518e4cb9dc10c3cd">binentrop</a>(safe_error) * pb-&gt;<a class="code" href="struct_process_blk.html#a362004851d12dc70281465703a51b9f3">workbits</a>);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="comment">/* old version of the loss to eve:</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">         sneakloss =</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">        (int)(phi(2*sqrt(trueerror*(1-trueerror)))/2.*pb-&gt;workbits);</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">      */</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    } <span class="keywordflow">else</span> { <span class="comment">/* we do the device-indepenent estimation */</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      BellHelper = pb-&gt;<a class="code" href="struct_process_blk.html#a1997687e76df9219b2baef75fb3e13b4">bellValue</a> * pb-&gt;<a class="code" href="struct_process_blk.html#a1997687e76df9219b2baef75fb3e13b4">bellValue</a> / 4. - 1.;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="keywordflow">if</span> (BellHelper &lt; 0.) { <span class="comment">/* we have no key...*/</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        sneakloss = pb-&gt;<a class="code" href="struct_process_blk.html#a362004851d12dc70281465703a51b9f3">workbits</a>;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      } <span class="keywordflow">else</span> { <span class="comment">/* there is hope... */</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        sneakloss = (int)(pb-&gt;<a class="code" href="struct_process_blk.html#a362004851d12dc70281465703a51b9f3">workbits</a> * <a class="code" href="priv__amp_8c.html#a6191b118553d1fbe518e4cb9dc10c3cd">binentrop</a>((1. + sqrt(BellHelper)) / 2.));</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    sneakloss = 0; <span class="comment">/* Wruaghhh - how dirty... */</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="comment">/* here we do the accounting of gained and lost bits */</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  pb-&gt;<a class="code" href="struct_process_blk.html#a91bdb0727e24efac48637a4c96e408a1">finalKeyBits</a> = pb-&gt;<a class="code" href="struct_process_blk.html#a362004851d12dc70281465703a51b9f3">workbits</a> - (pb-&gt;<a class="code" href="struct_process_blk.html#a8850ed5670798e8cef4e05769dbe0faf">leakageBits</a> + sneakloss) + redundantloss;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="keywordflow">if</span> (pb-&gt;<a class="code" href="struct_process_blk.html#a91bdb0727e24efac48637a4c96e408a1">finalKeyBits</a> &lt; 0) pb-&gt;<a class="code" href="struct_process_blk.html#a91bdb0727e24efac48637a4c96e408a1">finalKeyBits</a> = 0; <span class="comment">/* no hope. */</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="comment">/* dirtwork for testing. I need to leave this in because it is the basis</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">   for may of the plots we have. */</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  printf(<span class="stringliteral">&quot;PA disable: %d\n&quot;</span>, <a class="code" href="structarguments.html">arguments</a>.<a class="code" href="structarguments.html#a9309b6838bd1c1c973b3b20bf7c26736">disablePrivAmp</a>);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structarguments.html">arguments</a>.<a class="code" href="structarguments.html#a9309b6838bd1c1c973b3b20bf7c26736">disablePrivAmp</a>) {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    pb-&gt;<a class="code" href="struct_process_blk.html#a91bdb0727e24efac48637a4c96e408a1">finalKeyBits</a> = pb-&gt;<a class="code" href="struct_process_blk.html#a362004851d12dc70281465703a51b9f3">workbits</a>;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  printf(<span class="stringliteral">&quot;before privacy amp:\n corrected errors: %d\n workbits: %d\n&quot;</span>,</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;         pb-&gt;<a class="code" href="struct_process_blk.html#a898ec0cfdc185bd10dfb14b83c8ba380">correctedErrors</a>, pb-&gt;<a class="code" href="struct_process_blk.html#a362004851d12dc70281465703a51b9f3">workbits</a>);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  printf(<span class="stringliteral">&quot; trueerror: %f\n sneakloss: %d\n leakageBits: %d\n&quot;</span>, trueerror,</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;         sneakloss, pb-&gt;<a class="code" href="struct_process_blk.html#a8850ed5670798e8cef4e05769dbe0faf">leakageBits</a> - redundantloss);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  printf(<span class="stringliteral">&quot; finakeybits: %d\n&quot;</span>, pb-&gt;<a class="code" href="struct_process_blk.html#a91bdb0727e24efac48637a4c96e408a1">finalKeyBits</a>);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="preprocessor">  #ifdef DEBUG</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  fflush(stdout);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="comment">/* initiate seed */</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  pb-&gt;<a class="code" href="struct_process_blk.html#a6dabf9f2d34fb0aaa09e814078f1e757">rngState</a> = seed;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="comment">/* set last bits to zero in workbits.... */</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  numwords = <a class="code" href="helpers_8h.html#ad30e1442a0cf0d5240af264aa777d3b1">wordCount</a>(pb-&gt;<a class="code" href="struct_process_blk.html#a362004851d12dc70281465703a51b9f3">workbits</a>);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="helpers_8h.html#a34baab3b983b289ac535bd10023d8a38">modulo32</a>(pb-&gt;<a class="code" href="struct_process_blk.html#a362004851d12dc70281465703a51b9f3">workbits</a>) != 0)</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    pb-&gt;<a class="code" href="struct_process_blk.html#a71512748b2ec9f702475209ae8f8b880">mainBufPtr</a>[numwords - 1] &amp;= (0xffffffff &lt;&lt; (32 - <a class="code" href="helpers_8h.html#a34baab3b983b289ac535bd10023d8a38">modulo32</a>(pb-&gt;<a class="code" href="struct_process_blk.html#a362004851d12dc70281465703a51b9f3">workbits</a>)));</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="comment">/* prepare structure for final key */</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  mlen = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structheader__7.html">header_7</a>) + <a class="code" href="helpers_8h.html#ad30e1442a0cf0d5240af264aa777d3b1">wordCount</a>(pb-&gt;finalKeyBits) * <a class="code" href="defaultdefinitions_8h.html#a92ed8507d1cd2331ad09275c5c4c1c89">WORD_SIZE</a>;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  outmsg = (<span class="keyword">struct </span><a class="code" href="structheader__7.html">header_7</a> *)<a class="code" href="debug_8c.html#af8c2db3d81151416ecd3dcb6f38e3711">malloc2</a>(mlen);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="keywordflow">if</span> (!outmsg) <span class="keywordflow">return</span> 63;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  outmsg-&gt;<a class="code" href="structheader__7.html#a08ea28e2fbeb87380a81fcb3c1bef8f0">tag</a> = <a class="code" href="pkt__header__7_8h.html#a14ea2cca450c06c029139e6f8a77524f">TYPE_7_TAG</a>; <span class="comment">/* final key file */</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  outmsg-&gt;<a class="code" href="structheader__7.html#aab7a9200bfffed9a73f057aa631b5b7f">epoc</a> = pb-&gt;<a class="code" href="struct_process_blk.html#a088e5bd90f2269b8d49e78c9ef57f416">startEpoch</a>;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  outmsg-&gt;<a class="code" href="structheader__7.html#aa8f93ad861493fbd92cd41c8d6fa3ea6">numberOfEpochs</a> = pb-&gt;<a class="code" href="struct_process_blk.html#a63d7547cdbe9adcf0fd4f978b60d450e">numberOfEpochs</a>;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  outmsg-&gt;<a class="code" href="structheader__7.html#aca413382a94bc8f2f6cca2841b4c4ea2">numberofbits</a> = pb-&gt;<a class="code" href="struct_process_blk.html#a91bdb0727e24efac48637a4c96e408a1">finalKeyBits</a>;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  finalkey = (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *)&amp;outmsg[1]; <span class="comment">/* here starts data area */</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="comment">/* clear target buffer */</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  bzero(finalkey, <a class="code" href="helpers_8h.html#ad30e1442a0cf0d5240af264aa777d3b1">wordCount</a>(pb-&gt;<a class="code" href="struct_process_blk.html#a91bdb0727e24efac48637a4c96e408a1">finalKeyBits</a>) * <a class="code" href="defaultdefinitions_8h.html#a92ed8507d1cd2331ad09275c5c4c1c89">WORD_SIZE</a>);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <span class="comment">/* prepare final key */</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structarguments.html">arguments</a>.<a class="code" href="structarguments.html#a9309b6838bd1c1c973b3b20bf7c26736">disablePrivAmp</a>) { <span class="comment">/* no PA fo debugging */</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordflow">for</span> (j = 0; j &lt; numwords; j++) finalkey[j] = pb-&gt;<a class="code" href="struct_process_blk.html#a71512748b2ec9f702475209ae8f8b880">mainBufPtr</a>[j];</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  } <span class="keywordflow">else</span> { <span class="comment">/* do privacy amplification */</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">/* create compression matrix on the fly while preparing key */</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; pb-&gt;<a class="code" href="struct_process_blk.html#a91bdb0727e24efac48637a4c96e408a1">finalKeyBits</a>; <a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) { <span class="comment">/* go through all targetbits */</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      m = 0;                                 <span class="comment">/* initial word */</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; numwords; j++)</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        m ^= (pb-&gt;<a class="code" href="struct_process_blk.html#a71512748b2ec9f702475209ae8f8b880">mainBufPtr</a>[j] &amp; <a class="code" href="rnd_8c.html#ac7342e547b47c3b84efa8ce904143330">rnd_getPrngValue2_32</a>(&amp;pb-&gt;<a class="code" href="struct_process_blk.html#a6dabf9f2d34fb0aaa09e814078f1e757">rngState</a>));</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="rnd_8h.html#aaf02c22d1eaba1246f132d148dd3d548">calcParity</a>(m)) finalkey[<a class="code" href="helpers_8h.html#a4f662f55b8c7569ec85c48cca009914d">wordIndex</a>(<a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)] |= <a class="code" href="helpers_8h.html#a7638838ced95eb558ffd96635e2e568b">uint32AllZeroExceptAtN</a>(<a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    }</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="comment">/* send final key to file */</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  strncpy(<a class="code" href="costream_8c.html#a5e4d5eded57665a7c40e22af8ff60b9a">ffnam</a>, <a class="code" href="structarguments.html">arguments</a>.<a class="code" href="structarguments.html#abdbee6d4b3a536e2becf596c1bcf5ac5">fname</a>[<a class="code" href="defaultdefinitions_8h.html#a60dccdec5aced9500d5f728bce5b9b3ea7a2d9b621d426a7b283d249f78abea59">handleId_finalKeyDir</a>], <a class="code" href="defaultdefinitions_8h.html#aec3288ab4aa26c22d51e4bb59434682c">FNAME_LENGTH</a>);                <span class="comment">/* fnal key directory */</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <a class="code" href="helpers_8c.html#a9e1a87974d8c015ddb41f248076f09e0">atohex</a>(&amp;<a class="code" href="costream_8c.html#a5e4d5eded57665a7c40e22af8ff60b9a">ffnam</a>[strlen(<a class="code" href="costream_8c.html#a5e4d5eded57665a7c40e22af8ff60b9a">ffnam</a>)], pb-&gt;<a class="code" href="struct_process_blk.html#a088e5bd90f2269b8d49e78c9ef57f416">startEpoch</a>);        <span class="comment">/* add file name */</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <a class="code" href="structarguments.html">arguments</a>.<a class="code" href="structarguments.html#a010b3658a3dcd362f7515ab8a6058d29">handle</a>[<a class="code" href="defaultdefinitions_8h.html#a60dccdec5aced9500d5f728bce5b9b3ea7a2d9b621d426a7b283d249f78abea59">handleId_finalKeyDir</a>] = open(<a class="code" href="costream_8c.html#a5e4d5eded57665a7c40e22af8ff60b9a">ffnam</a>, <a class="code" href="defaultdefinitions_8h.html#a9717e87db02535babd2dcd5f3d922ff4">FILE_OUTMODE</a>, <a class="code" href="defaultdefinitions_8h.html#a57b412b0a0d579ea23b6c61d69615939">OUT_PERMISSIONS</a>); <span class="comment">/* open target */</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="keywordflow">if</span> (-1 == <a class="code" href="structarguments.html">arguments</a>.<a class="code" href="structarguments.html#a010b3658a3dcd362f7515ab8a6058d29">handle</a>[<a class="code" href="defaultdefinitions_8h.html#a60dccdec5aced9500d5f728bce5b9b3ea7a2d9b621d426a7b283d249f78abea59">handleId_finalKeyDir</a>]) <span class="keywordflow">return</span> 64;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  written = 0;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="keywordflow">while</span> (1) {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    rv = write(<a class="code" href="structarguments.html">arguments</a>.<a class="code" href="structarguments.html#a010b3658a3dcd362f7515ab8a6058d29">handle</a>[<a class="code" href="defaultdefinitions_8h.html#a60dccdec5aced9500d5f728bce5b9b3ea7a2d9b621d426a7b283d249f78abea59">handleId_finalKeyDir</a>], &amp;((<span class="keywordtype">char</span> *)outmsg)[written], mlen - written);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">if</span> (rv == -1) <span class="keywordflow">return</span> 65; <span class="comment">/* write error happened */</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    written += rv;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordflow">if</span> (written &gt;= mlen) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    usleep(100000); <span class="comment">/* sleep 100 msec */</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  close(<a class="code" href="structarguments.html">arguments</a>.<a class="code" href="structarguments.html#a010b3658a3dcd362f7515ab8a6058d29">handle</a>[<a class="code" href="defaultdefinitions_8h.html#a60dccdec5aced9500d5f728bce5b9b3ea7a2d9b621d426a7b283d249f78abea59">handleId_finalKeyDir</a>]);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="comment">/* send notification */</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="structarguments.html">arguments</a>.<a class="code" href="structarguments.html#adbb1d332beeaeab234c275c94bfdef88">verbosityLevel</a>) {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordflow">case</span> VERBOSITY_EPOCH: <span class="comment">/* output raw block name */</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      fprintf(<a class="code" href="structarguments.html">arguments</a>.<a class="code" href="structarguments.html#acb34c8b6cb0bb283ab18ae33c2fcee21">fhandle</a>[<a class="code" href="defaultdefinitions_8h.html#a60dccdec5aced9500d5f728bce5b9b3ea61d4048a034b1debc9e694bcbb6ef95c">handleId_notifyPipe</a>], <span class="stringliteral">&quot;%08x\n&quot;</span>, pb-&gt;<a class="code" href="struct_process_blk.html#a088e5bd90f2269b8d49e78c9ef57f416">startEpoch</a>);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordflow">case</span> VERBOSITY_EPOCH_FIN: <span class="comment">/* block name and final bits */</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      fprintf(<a class="code" href="structarguments.html">arguments</a>.<a class="code" href="structarguments.html#acb34c8b6cb0bb283ab18ae33c2fcee21">fhandle</a>[<a class="code" href="defaultdefinitions_8h.html#a60dccdec5aced9500d5f728bce5b9b3ea61d4048a034b1debc9e694bcbb6ef95c">handleId_notifyPipe</a>], <span class="stringliteral">&quot;%08x %d\n&quot;</span>, pb-&gt;<a class="code" href="struct_process_blk.html#a088e5bd90f2269b8d49e78c9ef57f416">startEpoch</a>, pb-&gt;<a class="code" href="struct_process_blk.html#a91bdb0727e24efac48637a4c96e408a1">finalKeyBits</a>);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordflow">case</span> VERBOSITY_EPOCH_INI_FIN_ERR: <span class="comment">/* block name, ini bits, final bits, error rate */</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      fprintf(<a class="code" href="structarguments.html">arguments</a>.<a class="code" href="structarguments.html#acb34c8b6cb0bb283ab18ae33c2fcee21">fhandle</a>[<a class="code" href="defaultdefinitions_8h.html#a60dccdec5aced9500d5f728bce5b9b3ea61d4048a034b1debc9e694bcbb6ef95c">handleId_notifyPipe</a>], <span class="stringliteral">&quot;%08x %d %d %.4f\n&quot;</span>, pb-&gt;<a class="code" href="struct_process_blk.html#a088e5bd90f2269b8d49e78c9ef57f416">startEpoch</a>, pb-&gt;<a class="code" href="struct_process_blk.html#a00d64b570e9257f36870db25eb4cbfa9">initialBits</a>,</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;              pb-&gt;<a class="code" href="struct_process_blk.html#a91bdb0727e24efac48637a4c96e408a1">finalKeyBits</a>, trueerror);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordflow">case</span> VERBOSITY_EPOCH_INI_FIN_ERR_PLAIN: <span class="comment">/* same as with 2 but with text */</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      fprintf(<a class="code" href="structarguments.html">arguments</a>.<a class="code" href="structarguments.html#acb34c8b6cb0bb283ab18ae33c2fcee21">fhandle</a>[<a class="code" href="defaultdefinitions_8h.html#a60dccdec5aced9500d5f728bce5b9b3ea61d4048a034b1debc9e694bcbb6ef95c">handleId_notifyPipe</a>],</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;              <span class="stringliteral">&quot;startEpoch: %08x initial bit number: %d final bit number: %d &quot;</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;              <span class="stringliteral">&quot;error rate: %.4f\n&quot;</span>,</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;              pb-&gt;<a class="code" href="struct_process_blk.html#a088e5bd90f2269b8d49e78c9ef57f416">startEpoch</a>, pb-&gt;<a class="code" href="struct_process_blk.html#a00d64b570e9257f36870db25eb4cbfa9">initialBits</a>, pb-&gt;<a class="code" href="struct_process_blk.html#a91bdb0727e24efac48637a4c96e408a1">finalKeyBits</a>, trueerror);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keywordflow">case</span> VERBOSITY_EPOCH_INI_FIN_ERR_EXPLICIT: <span class="comment">/* block name, ini bits, final bits, error rate, leak bits */</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      fprintf(<a class="code" href="structarguments.html">arguments</a>.<a class="code" href="structarguments.html#acb34c8b6cb0bb283ab18ae33c2fcee21">fhandle</a>[<a class="code" href="defaultdefinitions_8h.html#a60dccdec5aced9500d5f728bce5b9b3ea61d4048a034b1debc9e694bcbb6ef95c">handleId_notifyPipe</a>], <span class="stringliteral">&quot;%08x %d %d %.4f %d\n&quot;</span>, pb-&gt;<a class="code" href="struct_process_blk.html#a088e5bd90f2269b8d49e78c9ef57f416">startEpoch</a>,</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;              pb-&gt;<a class="code" href="struct_process_blk.html#a00d64b570e9257f36870db25eb4cbfa9">initialBits</a>, pb-&gt;<a class="code" href="struct_process_blk.html#a91bdb0727e24efac48637a4c96e408a1">finalKeyBits</a>, trueerror, pb-&gt;<a class="code" href="struct_process_blk.html#a8850ed5670798e8cef4e05769dbe0faf">leakageBits</a>);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordflow">case</span> VERBOSITY_EPOCH_INI_FIN_ERR_EXPLICIT_WITH_COMMENTS: <span class="comment">/* same as with 4 but with text */</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      fprintf(<a class="code" href="structarguments.html">arguments</a>.<a class="code" href="structarguments.html#acb34c8b6cb0bb283ab18ae33c2fcee21">fhandle</a>[<a class="code" href="defaultdefinitions_8h.html#a60dccdec5aced9500d5f728bce5b9b3ea61d4048a034b1debc9e694bcbb6ef95c">handleId_notifyPipe</a>],</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;              <span class="stringliteral">&quot;startEpoch: %08x initial bit number: %d final bit number: %d &quot;</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;              <span class="stringliteral">&quot;error rate: %.4f leaked bits in EC: %d\n&quot;</span>,</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;              pb-&gt;<a class="code" href="struct_process_blk.html#a088e5bd90f2269b8d49e78c9ef57f416">startEpoch</a>, pb-&gt;<a class="code" href="struct_process_blk.html#a00d64b570e9257f36870db25eb4cbfa9">initialBits</a>, pb-&gt;<a class="code" href="struct_process_blk.html#a91bdb0727e24efac48637a4c96e408a1">finalKeyBits</a>, trueerror,</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;              pb-&gt;<a class="code" href="struct_process_blk.html#a8850ed5670798e8cef4e05769dbe0faf">leakageBits</a>);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="preprocessor">  #ifdef DEBUG</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  printf(<span class="stringliteral">&quot;startEpoch: %08x initial bit number: %d final bit number: %d error rate: %.4f leaked bits in EC: %d\n&quot;</span>,</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;              pb-&gt;<a class="code" href="struct_process_blk.html#a088e5bd90f2269b8d49e78c9ef57f416">startEpoch</a>, pb-&gt;<a class="code" href="struct_process_blk.html#a00d64b570e9257f36870db25eb4cbfa9">initialBits</a>, pb-&gt;<a class="code" href="struct_process_blk.html#a91bdb0727e24efac48637a4c96e408a1">finalKeyBits</a>, trueerror, pb-&gt;<a class="code" href="struct_process_blk.html#a8850ed5670798e8cef4e05769dbe0faf">leakageBits</a>);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  fflush(stdout);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  fflush(<a class="code" href="structarguments.html">arguments</a>.<a class="code" href="structarguments.html#acb34c8b6cb0bb283ab18ae33c2fcee21">fhandle</a>[<a class="code" href="defaultdefinitions_8h.html#a60dccdec5aced9500d5f728bce5b9b3ea61d4048a034b1debc9e694bcbb6ef95c">handleId_notifyPipe</a>]);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="comment">/* cleanup outmessage buf */</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <a class="code" href="debug_8c.html#ae9cba13dc8aa5d62e13112d01be090ba">free2</a>(outmsg);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="comment">/* destroy processBlock */</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  printf(<span class="stringliteral">&quot;remove processBlock\n&quot;</span>);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  fflush(stdout);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="processblock__mgmt_8c.html#ad73d89425bfa5a819b138512f90f67b2">pBlkMgmt_removeProcessBlk</a>(pb-&gt;<a class="code" href="struct_process_blk.html#a088e5bd90f2269b8d49e78c9ef57f416">startEpoch</a>);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="comment">/* return benignly */</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a542068c2130f42502e1e4c743251f08b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a542068c2130f42502e1e4c743251f08b">&#9670;&nbsp;</a></span>privAmp_receivePrivAmpMsg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int privAmp_receivePrivAmpMsg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="data__manager_8h.html#a7dfe752c36d0273736b6282f64b674c6">ProcessBlock</a> *&#160;</td>
          <td class="paramname"><em>pb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>receivebuf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to process a privacy amplification message. </p>
<p>Parses the message and passes the real work over to the do_privacyamplification part</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">receivebuf</td><td>incoming message </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0 if success, otherwise error code </dd></dl>

<p class="definition">Definition at line <a class="el" href="priv__amp_8c_source.html#l00066">66</a> of file <a class="el" href="priv__amp_8c_source.html">priv_amp.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                                                                  {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="comment">// Get header</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__8.html">EcPktHdr_StartPrivAmp</a> *in_head = (<a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__8.html">EcPktHdr_StartPrivAmp</a> *)receivebuf;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="comment">/* retrieve number of corrected bits */</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  pb-&gt;<a class="code" href="struct_process_blk.html#a898ec0cfdc185bd10dfb14b83c8ba380">correctedErrors</a> = in_head-&gt;<a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__8.html#af3d8715d27083d703a50e5b78faf63b7">correctedbits</a>;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="comment">/* do some consistency checks???*/</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="comment">/* pass to the core prog */</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="priv__amp_8c.html#a09193ce60c20fc9ebea0acec44d5e430">privAmp_doPrivAmp</a>(pb, in_head-&gt;<a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__8.html#a464345774f6f474a182c9c83500c5c08">seed</a>, in_head-&gt;<a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__8.html#a7d3544a55477fc9814b3276efd48cbe2">lostbits</a>);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a429724db4a14d3b8171683f1ea4786aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a429724db4a14d3b8171683f1ea4786aa">&#9670;&nbsp;</a></span>privAmp_sendPrivAmpMsgAndPrivAmp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int privAmp_sendPrivAmpMsgAndPrivAmp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="data__manager_8h.html#a7dfe752c36d0273736b6282f64b674c6">ProcessBlock</a> *&#160;</td>
          <td class="paramname"><em>pb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to initiate the privacy amplification. </p>
<p>Sends out a message with a PRNG seed (message 8), and hand over to the core routine for the PA.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pb</td><td>processBlock ptr </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0 if success, otherwise error code </dd></dl>

<p class="definition">Definition at line <a class="el" href="priv__amp_8c_source.html#l00038">38</a> of file <a class="el" href="priv__amp_8c_source.html">priv_amp.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                                                       {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__8.html">EcPktHdr_StartPrivAmp</a> *h8; <span class="comment">/* head for trigger message */</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordtype">int</span> errorCode = 0;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="comment">/* prepare messagehead */</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  errorCode = <a class="code" href="comms_8c.html#a1477d8fd71e31e647ca5d244bca9da92">comms_createEcHeader</a>((<span class="keywordtype">char</span> **)&amp;h8, <a class="code" href="packets_8h.html#a8d7b5505e1e2c97c051c0423356147aea910eac00d12d4ce4c61172cfe48c0bd0">SUBTYPE_START_PRIV_AMP</a>, 0, pb);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keywordflow">if</span> (errorCode) <span class="keywordflow">return</span> 62; <span class="comment">// hardcoded in original impl.</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  errorCode = <a class="code" href="rnd_8c.html#aa6b05135c822665d94e10db94975f86a">rnd_generateRngSeed</a>(&amp;(h8-&gt;<a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__8.html#a464345774f6f474a182c9c83500c5c08">seed</a>));   <span class="comment">/* generate local RNG seed */</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordflow">if</span> (errorCode) <span class="keywordflow">return</span> errorCode;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  h8-&gt;<a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__8.html#a7d3544a55477fc9814b3276efd48cbe2">lostbits</a> = pb-&gt;<a class="code" href="struct_process_blk.html#a8850ed5670798e8cef4e05769dbe0faf">leakageBits</a>; <span class="comment">/* this is what we use for PA */</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  h8-&gt;<a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__8.html#af3d8715d27083d703a50e5b78faf63b7">correctedbits</a> = pb-&gt;<a class="code" href="struct_process_blk.html#a898ec0cfdc185bd10dfb14b83c8ba380">correctedErrors</a>;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="comment">/* insert message in msg pool */</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <a class="code" href="comms_8c.html#a75f878fc47eb039ab852cb1f4b2320d3">comms_insertSendPacket</a>((<span class="keywordtype">char</span> *)h8, h8-&gt;base.totalLengthInBytes);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="comment">/* do actual privacy amplification */</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="priv__amp_8c.html#a09193ce60c20fc9ebea0acec44d5e430">privAmp_doPrivAmp</a>(pb, h8-&gt;<a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__8.html#a464345774f6f474a182c9c83500c5c08">seed</a>, pb-&gt;<a class="code" href="struct_process_blk.html#a8850ed5670798e8cef4e05769dbe0faf">leakageBits</a>);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="ahelpers_8h_html_ad30e1442a0cf0d5240af264aa777d3b1"><div class="ttname"><a href="helpers_8h.html#ad30e1442a0cf0d5240af264aa777d3b1">wordCount</a></div><div class="ttdeci">#define wordCount(LAST_BIT_INDEX)</div><div class="ttdoc">Macro to get number of 32-bit words that used by buffer.</div><div class="ttdef"><b>Definition:</b> <a href="helpers_8h_source.html#l00067">helpers.h:66</a></div></div>
<div class="ttc" id="adefaultdefinitions_8h_html_a9717e87db02535babd2dcd5f3d922ff4"><div class="ttname"><a href="defaultdefinitions_8h.html#a9717e87db02535babd2dcd5f3d922ff4">FILE_OUTMODE</a></div><div class="ttdeci">#define FILE_OUTMODE</div><div class="ttdef"><b>Definition:</b> <a href="defaultdefinitions_8h_source.html#l00058">defaultdefinitions.h:57</a></div></div>
<div class="ttc" id="astruct_process_blk_html_a088e5bd90f2269b8d49e78c9ef57f416"><div class="ttname"><a href="struct_process_blk.html#a088e5bd90f2269b8d49e78c9ef57f416">ProcessBlk::startEpoch</a></div><div class="ttdeci">unsigned int startEpoch</div><div class="ttdoc">initial epoch of block</div><div class="ttdef"><b>Definition:</b> <a href="processblock_8h_source.html#l00104">processblock.h:104</a></div></div>
<div class="ttc" id="astruct_process_blk_html_a8850ed5670798e8cef4e05769dbe0faf"><div class="ttname"><a href="struct_process_blk.html#a8850ed5670798e8cef4e05769dbe0faf">ProcessBlk::leakageBits</a></div><div class="ttdeci">int leakageBits</div><div class="ttdoc">information which has gone public</div><div class="ttdef"><b>Definition:</b> <a href="processblock_8h_source.html#l00114">processblock.h:114</a></div></div>
<div class="ttc" id="adefaultdefinitions_8h_html_a57b412b0a0d579ea23b6c61d69615939"><div class="ttname"><a href="defaultdefinitions_8h.html#a57b412b0a0d579ea23b6c61d69615939">OUT_PERMISSIONS</a></div><div class="ttdeci">#define OUT_PERMISSIONS</div><div class="ttdef"><b>Definition:</b> <a href="defaultdefinitions_8h_source.html#l00059">defaultdefinitions.h:58</a></div></div>
<div class="ttc" id="adebug_8c_html_ae9cba13dc8aa5d62e13112d01be090ba"><div class="ttname"><a href="debug_8c.html#ae9cba13dc8aa5d62e13112d01be090ba">free2</a></div><div class="ttdeci">void free2(void *p)</div><div class="ttdoc">free wrapper for debugging purposes</div><div class="ttdef"><b>Definition:</b> <a href="debug_8c_source.html#l00029">debug.c:29</a></div></div>
<div class="ttc" id="adefaultdefinitions_8h_html_a60dccdec5aced9500d5f728bce5b9b3ea61d4048a034b1debc9e694bcbb6ef95c"><div class="ttname"><a href="defaultdefinitions_8h.html#a60dccdec5aced9500d5f728bce5b9b3ea61d4048a034b1debc9e694bcbb6ef95c">handleId_notifyPipe</a></div><div class="ttdeci">@ handleId_notifyPipe</div><div class="ttdef"><b>Definition:</b> <a href="defaultdefinitions_8h_source.html#l00089">defaultdefinitions.h:89</a></div></div>
<div class="ttc" id="astructheader__7_html"><div class="ttname"><a href="structheader__7.html">header_7</a></div><div class="ttdef"><b>Definition:</b> <a href="pkt__header__7_8h_source.html#l00007">pkt_header_7.h:7</a></div></div>
<div class="ttc" id="astructheader__7_html_aca413382a94bc8f2f6cca2841b4c4ea2"><div class="ttname"><a href="structheader__7.html#aca413382a94bc8f2f6cca2841b4c4ea2">header_7::numberofbits</a></div><div class="ttdeci">int numberofbits</div><div class="ttdef"><b>Definition:</b> <a href="pkt__header__7_8h_source.html#l00011">pkt_header_7.h:11</a></div></div>
<div class="ttc" id="astructarguments_html"><div class="ttname"><a href="structarguments.html">arguments</a></div><div class="ttdoc">Arguments struct to be parsed in.</div><div class="ttdef"><b>Definition:</b> <a href="globalvars_8h_source.html#l00055">globalvars.h:55</a></div></div>
<div class="ttc" id="astruct_process_blk_html_a91bdb0727e24efac48637a4c96e408a1"><div class="ttname"><a href="struct_process_blk.html#a91bdb0727e24efac48637a4c96e408a1">ProcessBlk::finalKeyBits</a></div><div class="ttdeci">int finalKeyBits</div><div class="ttdoc">how much is left</div><div class="ttdef"><b>Definition:</b> <a href="processblock_8h_source.html#l00120">processblock.h:120</a></div></div>
<div class="ttc" id="astruct_e_r_r_c___e_r_r_d_e_t__8_html_a7d3544a55477fc9814b3276efd48cbe2"><div class="ttname"><a href="struct_e_r_r_c___e_r_r_d_e_t__8.html#a7d3544a55477fc9814b3276efd48cbe2">ERRC_ERRDET_8::lostbits</a></div><div class="ttdeci">unsigned int lostbits</div><div class="ttdoc">number of lost bits in this run</div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00173">packets.h:173</a></div></div>
<div class="ttc" id="adefaultdefinitions_8h_html_aec3288ab4aa26c22d51e4bb59434682c"><div class="ttname"><a href="defaultdefinitions_8h.html#aec3288ab4aa26c22d51e4bb59434682c">FNAME_LENGTH</a></div><div class="ttdeci">#define FNAME_LENGTH</div><div class="ttdoc">length of file name buffers</div><div class="ttdef"><b>Definition:</b> <a href="defaultdefinitions_8h_source.html#l00039">defaultdefinitions.h:38</a></div></div>
<div class="ttc" id="astruct_process_blk_html_a898ec0cfdc185bd10dfb14b83c8ba380"><div class="ttname"><a href="struct_process_blk.html#a898ec0cfdc185bd10dfb14b83c8ba380">ProcessBlk::correctedErrors</a></div><div class="ttdeci">int correctedErrors</div><div class="ttdoc">number of corrected bits</div><div class="ttdef"><b>Definition:</b> <a href="processblock_8h_source.html#l00118">processblock.h:118</a></div></div>
<div class="ttc" id="astruct_e_r_r_c___e_r_r_d_e_t__8_html"><div class="ttname"><a href="struct_e_r_r_c___e_r_r_d_e_t__8.html">ERRC_ERRDET_8</a></div><div class="ttdoc">privacy amplification start message</div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00170">packets.h:170</a></div></div>
<div class="ttc" id="acomms_8c_html_a75f878fc47eb039ab852cb1f4b2320d3"><div class="ttname"><a href="comms_8c.html#a75f878fc47eb039ab852cb1f4b2320d3">comms_insertSendPacket</a></div><div class="ttdeci">int comms_insertSendPacket(char *message, int length)</div><div class="ttdoc">Helper to insert a send packet in the sendpacket queue.</div><div class="ttdef"><b>Definition:</b> <a href="comms_8c_source.html#l00016">comms.c:16</a></div></div>
<div class="ttc" id="ahelpers_8h_html_a34baab3b983b289ac535bd10023d8a38"><div class="ttname"><a href="helpers_8h.html#a34baab3b983b289ac535bd10023d8a38">modulo32</a></div><div class="ttdeci">#define modulo32(X)</div><div class="ttdoc">Can also be defined as &quot;get least significant 5 bits&quot;, but this definition is more meaningful.</div><div class="ttdef"><b>Definition:</b> <a href="helpers_8h_source.html#l00068">helpers.h:67</a></div></div>
<div class="ttc" id="astruct_process_blk_html_a362004851d12dc70281465703a51b9f3"><div class="ttname"><a href="struct_process_blk.html#a362004851d12dc70281465703a51b9f3">ProcessBlk::workbits</a></div><div class="ttdeci">int workbits</div><div class="ttdoc">bits to work with for BICONF/parity check</div><div class="ttdef"><b>Definition:</b> <a href="processblock_8h_source.html#l00117">processblock.h:117</a></div></div>
<div class="ttc" id="astructheader__7_html_aa8f93ad861493fbd92cd41c8d6fa3ea6"><div class="ttname"><a href="structheader__7.html#aa8f93ad861493fbd92cd41c8d6fa3ea6">header_7::numberOfEpochs</a></div><div class="ttdeci">unsigned int numberOfEpochs</div><div class="ttdef"><b>Definition:</b> <a href="pkt__header__7_8h_source.html#l00010">pkt_header_7.h:10</a></div></div>
<div class="ttc" id="astructarguments_html_a9309b6838bd1c1c973b3b20bf7c26736"><div class="ttname"><a href="structarguments.html#a9309b6838bd1c1c973b3b20bf7c26736">arguments::disablePrivAmp</a></div><div class="ttdeci">Boolean disablePrivAmp</div><div class="ttdoc">used by priv_amp</div><div class="ttdef"><b>Definition:</b> <a href="globalvars_8h_source.html#l00083">globalvars.h:83</a></div></div>
<div class="ttc" id="astructheader__7_html_aab7a9200bfffed9a73f057aa631b5b7f"><div class="ttname"><a href="structheader__7.html#aab7a9200bfffed9a73f057aa631b5b7f">header_7::epoc</a></div><div class="ttdeci">unsigned int epoc</div><div class="ttdef"><b>Definition:</b> <a href="pkt__header__7_8h_source.html#l00009">pkt_header_7.h:9</a></div></div>
<div class="ttc" id="astructarguments_html_adbb1d332beeaeab234c275c94bfdef88"><div class="ttname"><a href="structarguments.html#adbb1d332beeaeab234c275c94bfdef88">arguments::verbosityLevel</a></div><div class="ttdeci">enum arguments::@0 verbosityLevel</div><div class="ttdoc">verbosity level of output, used by priv_amp</div></div>
<div class="ttc" id="apackets_8h_html_a8d7b5505e1e2c97c051c0423356147aea910eac00d12d4ce4c61172cfe48c0bd0"><div class="ttname"><a href="packets_8h.html#a8d7b5505e1e2c97c051c0423356147aea910eac00d12d4ce4c61172cfe48c0bd0">SUBTYPE_START_PRIV_AMP</a></div><div class="ttdeci">@ SUBTYPE_START_PRIV_AMP</div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00054">packets.h:54</a></div></div>
<div class="ttc" id="aprocessblock__mgmt_8c_html_ad73d89425bfa5a819b138512f90f67b2"><div class="ttname"><a href="processblock__mgmt_8c.html#ad73d89425bfa5a819b138512f90f67b2">pBlkMgmt_removeProcessBlk</a></div><div class="ttdeci">int pBlkMgmt_removeProcessBlk(unsigned int epoch)</div><div class="ttdoc">Function to remove a processBlock out of the list.</div><div class="ttdef"><b>Definition:</b> <a href="processblock__mgmt_8c_source.html#l00215">processblock_mgmt.c:215</a></div></div>
<div class="ttc" id="astruct_process_blk_html_a1997687e76df9219b2baef75fb3e13b4"><div class="ttname"><a href="struct_process_blk.html#a1997687e76df9219b2baef75fb3e13b4">ProcessBlk::bellValue</a></div><div class="ttdeci">float bellValue</div><div class="ttdoc">for Ekert-type protocols</div><div class="ttdef"><b>Definition:</b> <a href="processblock_8h_source.html#l00121">processblock.h:121</a></div></div>
<div class="ttc" id="astructarguments_html_a010b3658a3dcd362f7515ab8a6058d29"><div class="ttname"><a href="structarguments.html#a010b3658a3dcd362f7515ab8a6058d29">arguments::handle</a></div><div class="ttdeci">int handle[handleId_numberOfHandles]</div><div class="ttdef"><b>Definition:</b> <a href="globalvars_8h_source.html#l00087">globalvars.h:87</a></div></div>
<div class="ttc" id="astruct_e_r_r_c___e_r_r_d_e_t__8_html_a464345774f6f474a182c9c83500c5c08"><div class="ttname"><a href="struct_e_r_r_c___e_r_r_d_e_t__8.html#a464345774f6f474a182c9c83500c5c08">ERRC_ERRDET_8::seed</a></div><div class="ttdeci">unsigned int seed</div><div class="ttdoc">new seed for PRNG</div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00172">packets.h:172</a></div></div>
<div class="ttc" id="astructarguments_html_ac44f2a7e77a2650c6698ac567111326f"><div class="ttname"><a href="structarguments.html#ac44f2a7e77a2650c6698ac567111326f">arguments::intrinsicErrRate</a></div><div class="ttdeci">float intrinsicErrRate</div><div class="ttdoc">error rate generated outside eavesdropper, used by priv_amp</div><div class="ttdef"><b>Definition:</b> <a href="globalvars_8h_source.html#l00073">globalvars.h:73</a></div></div>
<div class="ttc" id="adebug_8c_html_af8c2db3d81151416ecd3dcb6f38e3711"><div class="ttname"><a href="debug_8c.html#af8c2db3d81151416ecd3dcb6f38e3711">malloc2</a></div><div class="ttdeci">char * malloc2(unsigned int s)</div><div class="ttdoc">malloc wrapper for debugging purposes</div><div class="ttdef"><b>Definition:</b> <a href="debug_8c_source.html#l00011">debug.c:11</a></div></div>
<div class="ttc" id="astructarguments_html_abdbee6d4b3a536e2becf596c1bcf5ac5"><div class="ttname"><a href="structarguments.html#abdbee6d4b3a536e2becf596c1bcf5ac5">arguments::fname</a></div><div class="ttdeci">char fname[handleId_numberOfHandles][FNAME_LENGTH]</div><div class="ttdef"><b>Definition:</b> <a href="globalvars_8h_source.html#l00086">globalvars.h:86</a></div></div>
<div class="ttc" id="adefaultdefinitions_8h_html_a92ed8507d1cd2331ad09275c5c4c1c89"><div class="ttname"><a href="defaultdefinitions_8h.html#a92ed8507d1cd2331ad09275c5c4c1c89">WORD_SIZE</a></div><div class="ttdeci">#define WORD_SIZE</div><div class="ttdoc">More readable than sizeof(unsigned int) everywhere.</div><div class="ttdef"><b>Definition:</b> <a href="defaultdefinitions_8h_source.html#l00076">defaultdefinitions.h:75</a></div></div>
<div class="ttc" id="arnd_8h_html_aaf02c22d1eaba1246f132d148dd3d548"><div class="ttname"><a href="rnd_8h.html#aaf02c22d1eaba1246f132d148dd3d548">calcParity</a></div><div class="ttdeci">#define calcParity</div><div class="ttdoc">This should be ridiculously faster.</div><div class="ttdef"><b>Definition:</b> <a href="rnd_8h_source.html#l00050">rnd.h:49</a></div></div>
<div class="ttc" id="arnd_8c_html_aa6b05135c822665d94e10db94975f86a"><div class="ttname"><a href="rnd_8c.html#aa6b05135c822665d94e10db94975f86a">rnd_generateRngSeed</a></div><div class="ttdeci">int rnd_generateRngSeed(unsigned int *rngResult)</div><div class="ttdoc">helper function to get a seed from the random device</div><div class="ttdef"><b>Definition:</b> <a href="rnd_8c_source.html#l00143">rnd.c:143</a></div></div>
<div class="ttc" id="acomms_8c_html_a1477d8fd71e31e647ca5d244bca9da92"><div class="ttname"><a href="comms_8c.html#a1477d8fd71e31e647ca5d244bca9da92">comms_createEcHeader</a></div><div class="ttdeci">int comms_createEcHeader(char **resultingBufferPtr, enum EC_SUBTYPES subtype, unsigned int additionalByteLength, ProcessBlock *processBlock)</div><div class="ttdoc">Helper function to create a message header.</div><div class="ttdef"><b>Definition:</b> <a href="comms_8c_source.html#l00150">comms.c:150</a></div></div>
<div class="ttc" id="astruct_e_r_r_c___e_r_r_d_e_t__8_html_af3d8715d27083d703a50e5b78faf63b7"><div class="ttname"><a href="struct_e_r_r_c___e_r_r_d_e_t__8.html#af3d8715d27083d703a50e5b78faf63b7">ERRC_ERRDET_8::correctedbits</a></div><div class="ttdeci">unsigned int correctedbits</div><div class="ttdoc">number of bits corrected in</div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00174">packets.h:174</a></div></div>
<div class="ttc" id="arnd_8c_html_ac7342e547b47c3b84efa8ce904143330"><div class="ttname"><a href="rnd_8c.html#ac7342e547b47c3b84efa8ce904143330">rnd_getPrngValue2_32</a></div><div class="ttdeci">unsigned int rnd_getPrngValue2_32(unsigned int *state)</div><div class="ttdef"><b>Definition:</b> <a href="rnd_8c_source.html#l00118">rnd.c:118</a></div></div>
<div class="ttc" id="acostream_8c_html_a5e4d5eded57665a7c40e22af8ff60b9a"><div class="ttname"><a href="costream_8c.html#a5e4d5eded57665a7c40e22af8ff60b9a">ffnam</a></div><div class="ttdeci">char ffnam[FNAMELENGTH+10]</div><div class="ttdef"><b>Definition:</b> <a href="costream_8c_source.html#l00702">costream.c:702</a></div></div>
<div class="ttc" id="astructarguments_html_a782cee4d1f7bd03d966a2ea6afd8b999"><div class="ttname"><a href="structarguments.html#a782cee4d1f7bd03d966a2ea6afd8b999">arguments::errorMargin</a></div><div class="ttdeci">float errorMargin</div><div class="ttdoc">number of standard deviations of the detected errors should be added to eve's information leakage est...</div><div class="ttdef"><b>Definition:</b> <a href="globalvars_8h_source.html#l00071">globalvars.h:71</a></div></div>
<div class="ttc" id="astructarguments_html_af78000c59f253e0d7c3ca2f9fb3075c8"><div class="ttname"><a href="structarguments.html#af78000c59f253e0d7c3ca2f9fb3075c8">arguments::bellmode</a></div><div class="ttdeci">Boolean bellmode</div><div class="ttdoc">Expect to receive a value for the Bell violation param, used by priv_amp.</div><div class="ttdef"><b>Definition:</b> <a href="globalvars_8h_source.html#l00082">globalvars.h:82</a></div></div>
<div class="ttc" id="ahelpers_8h_html_a4f662f55b8c7569ec85c48cca009914d"><div class="ttname"><a href="helpers_8h.html#a4f662f55b8c7569ec85c48cca009914d">wordIndex</a></div><div class="ttdeci">#define wordIndex(BIT_INDEX)</div><div class="ttdoc">Macro to get index of 32-bit word given the index of the bit.</div><div class="ttdef"><b>Definition:</b> <a href="helpers_8h_source.html#l00066">helpers.h:65</a></div></div>
<div class="ttc" id="astructarguments_html_acb34c8b6cb0bb283ab18ae33c2fcee21"><div class="ttname"><a href="structarguments.html#acb34c8b6cb0bb283ab18ae33c2fcee21">arguments::fhandle</a></div><div class="ttdeci">FILE * fhandle[8]</div><div class="ttdef"><b>Definition:</b> <a href="globalvars_8h_source.html#l00088">globalvars.h:88</a></div></div>
<div class="ttc" id="astruct_process_blk_html_a6dabf9f2d34fb0aaa09e814078f1e757"><div class="ttname"><a href="struct_process_blk.html#a6dabf9f2d34fb0aaa09e814078f1e757">ProcessBlk::rngState</a></div><div class="ttdeci">unsigned int rngState</div><div class="ttdoc">keeps the state of the PRNG for this processBlock</div><div class="ttdef"><b>Definition:</b> <a href="processblock_8h_source.html#l00110">processblock.h:110</a></div></div>
<div class="ttc" id="apkt__header__7_8h_html_a14ea2cca450c06c029139e6f8a77524f"><div class="ttname"><a href="pkt__header__7_8h.html#a14ea2cca450c06c029139e6f8a77524f">TYPE_7_TAG</a></div><div class="ttdeci">#define TYPE_7_TAG</div><div class="ttdef"><b>Definition:</b> <a href="pkt__header__7_8h_source.html#l00005">pkt_header_7.h:4</a></div></div>
<div class="ttc" id="apriv__amp_8c_html_a6191b118553d1fbe518e4cb9dc10c3cd"><div class="ttname"><a href="priv__amp_8c.html#a6191b118553d1fbe518e4cb9dc10c3cd">binentrop</a></div><div class="ttdeci">float binentrop(float q)</div><div class="ttdef"><b>Definition:</b> <a href="priv__amp_8c_source.html#l00022">priv_amp.c:22</a></div></div>
<div class="ttc" id="astructheader__7_html_a08ea28e2fbeb87380a81fcb3c1bef8f0"><div class="ttname"><a href="structheader__7.html#a08ea28e2fbeb87380a81fcb3c1bef8f0">header_7::tag</a></div><div class="ttdeci">int tag</div><div class="ttdef"><b>Definition:</b> <a href="pkt__header__7_8h_source.html#l00008">pkt_header_7.h:8</a></div></div>
<div class="ttc" id="adefaultdefinitions_8h_html_a60dccdec5aced9500d5f728bce5b9b3ea7a2d9b621d426a7b283d249f78abea59"><div class="ttname"><a href="defaultdefinitions_8h.html#a60dccdec5aced9500d5f728bce5b9b3ea7a2d9b621d426a7b283d249f78abea59">handleId_finalKeyDir</a></div><div class="ttdeci">@ handleId_finalKeyDir</div><div class="ttdef"><b>Definition:</b> <a href="defaultdefinitions_8h_source.html#l00088">defaultdefinitions.h:88</a></div></div>
<div class="ttc" id="astruct_process_blk_html_a63d7547cdbe9adcf0fd4f978b60d450e"><div class="ttname"><a href="struct_process_blk.html#a63d7547cdbe9adcf0fd4f978b60d450e">ProcessBlk::numberOfEpochs</a></div><div class="ttdeci">unsigned int numberOfEpochs</div><div class="ttdoc">number of consecutive epochs being processed</div><div class="ttdef"><b>Definition:</b> <a href="processblock_8h_source.html#l00105">processblock.h:105</a></div></div>
<div class="ttc" id="astruct_process_blk_html_a00d64b570e9257f36870db25eb4cbfa9"><div class="ttname"><a href="struct_process_blk.html#a00d64b570e9257f36870db25eb4cbfa9">ProcessBlk::initialBits</a></div><div class="ttdeci">int initialBits</div><div class="ttdoc">bits to start with</div><div class="ttdef"><b>Definition:</b> <a href="processblock_8h_source.html#l00112">processblock.h:112</a></div></div>
<div class="ttc" id="ahelpers_8h_html_a7638838ced95eb558ffd96635e2e568b"><div class="ttname"><a href="helpers_8h.html#a7638838ced95eb558ffd96635e2e568b">uint32AllZeroExceptAtN</a></div><div class="ttdeci">#define uint32AllZeroExceptAtN(N_FROM_RIGHT)</div><div class="ttdoc">previously uint32AllZeroExceptAtN</div><div class="ttdef"><b>Definition:</b> <a href="helpers_8h_source.html#l00069">helpers.h:68</a></div></div>
<div class="ttc" id="apriv__amp_8c_html_a09193ce60c20fc9ebea0acec44d5e430"><div class="ttname"><a href="priv__amp_8c.html#a09193ce60c20fc9ebea0acec44d5e430">privAmp_doPrivAmp</a></div><div class="ttdeci">int privAmp_doPrivAmp(ProcessBlock *pb, unsigned int seed, int lostbits)</div><div class="ttdoc">Do core part of the privacy amplification.</div><div class="ttdef"><b>Definition:</b> <a href="priv__amp_8c_source.html#l00091">priv_amp.c:91</a></div></div>
<div class="ttc" id="astruct_process_blk_html_a71512748b2ec9f702475209ae8f8b880"><div class="ttname"><a href="struct_process_blk.html#a71512748b2ec9f702475209ae8f8b880">ProcessBlk::mainBufPtr</a></div><div class="ttdeci">unsigned int * mainBufPtr</div><div class="ttdoc">points to main buffer for key</div><div class="ttdef"><b>Definition:</b> <a href="processblock_8h_source.html#l00107">processblock.h:107</a></div></div>
<div class="ttc" id="ahelpers_8c_html_a9e1a87974d8c015ddb41f248076f09e0"><div class="ttname"><a href="helpers_8c.html#a9e1a87974d8c015ddb41f248076f09e0">atohex</a></div><div class="ttdeci">void atohex(char *target, unsigned int v)</div><div class="ttdoc">helper for name.</div><div class="ttdef"><b>Definition:</b> <a href="helpers_8c_source.html#l00012">helpers.c:12</a></div></div>
<div class="ttc" id="atransferd_8h_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="transferd_8h_source.html#l00321">transferd.h:321</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_69202652be06fd0e05a491cdb470f56e.html">errorcorrection</a></li><li class="navelem"><a class="el" href="dir_1e980940fcb577eda0133bd99406c0b2.html">subcomponents</a></li><li class="navelem"><a class="el" href="priv__amp_8h.html">priv_amp.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.19 </li>
  </ul>
</div>
</body>
</html>
