<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.19"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>qCrypto: errorcorrection/comms.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">qCrypto
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
   <div id="projectbrief">A collection of code for a practical entanglement-based quantum key distribution system</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.19 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('comms_8c_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">comms.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="comms_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="comms_8h.html">comms.h</a>&quot;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160; </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// COMMUNICATIONS HELPER FUNCTIONS</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">/* ------------------------------------------------------------------------- */</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno"><a class="line" href="comms_8h.html#ab685a2df59da9e7fb20e4fd477eca731">   16</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="comms_8c.html#ab685a2df59da9e7fb20e4fd477eca731">insert_sendpacket</a>(<span class="keywordtype">char</span> *<a class="code" href="transferd_8h.html#a87a7526f6179b8f26681fe4dec7f9c48">message</a>, <span class="keywordtype">int</span> length) {</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  <span class="keyword">struct </span><a class="code" href="structpacket__to__send.html">packet_to_send</a> *newpacket, *lp;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  <span class="comment">// pidx++; // Unused global int variable</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  newpacket = (<span class="keyword">struct </span><a class="code" href="structpacket__to__send.html">packet_to_send</a> *)<a class="code" href="debug_8c.html#af8c2db3d81151416ecd3dcb6f38e3711">malloc2</a>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structpacket__to__send.html">packet_to_send</a>));</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  <span class="keywordflow">if</span> (!newpacket) <span class="keywordflow">return</span> 43;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  newpacket-&gt;<a class="code" href="structpacket__to__send.html#ad0befdf18a26825a57674a4f59986ca2">length</a> = <a class="code" href="structpacket__to__send.html#ad0befdf18a26825a57674a4f59986ca2">length</a>;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  newpacket-&gt;<a class="code" href="structpacket__to__send.html#a595a74e76d5e95ccc3a6360fe37f43ec">packet</a> = <a class="code" href="transferd_8h.html#a87a7526f6179b8f26681fe4dec7f9c48">message</a>; <span class="comment">/* content */</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  newpacket-&gt;<a class="code" href="structpacket__to__send.html#a3a11edfcaec956d36622c5131abdf239">next</a> = NULL;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  lp = <a class="code" href="ecd2_8h.html#a533147eb4caa484f9a001a15a2a376d5">last_packet_to_send</a>;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keywordflow">if</span> (lp) lp-&gt;<a class="code" href="structpacket__to__send.html#a3a11edfcaec956d36622c5131abdf239">next</a> = newpacket; <span class="comment">/* insetr in chain */</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <a class="code" href="ecd2_8h.html#a533147eb4caa484f9a001a15a2a376d5">last_packet_to_send</a> = newpacket;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="ecd2_8h.html#ad2ccf7edc49e0e4e4d3f6c40df187f9b">next_packet_to_send</a>) <a class="code" href="ecd2_8h.html#ad2ccf7edc49e0e4e4d3f6c40df187f9b">next_packet_to_send</a> = newpacket;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="comment">/* for debug: send message, take identity from first available slot */</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="comment">/*dumpmsg(blocklist-&gt;content, message); */</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordflow">return</span> 0; <span class="comment">/* success */</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;}</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="comms_8h.html#aee47c9c3a089fffd3ef8713caa9d6bf3">   49</a></span>&#160;<span class="keyword">struct </span><a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__0.html">ERRC_ERRDET_0</a> *<a class="code" href="comms_8c.html#aee47c9c3a089fffd3ef8713caa9d6bf3">fillsamplemessage</a>(<span class="keyword">struct</span> <a class="code" href="structkeyblock.html">keyblock</a> *kb, <span class="keywordtype">int</span> bitsneeded,</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                                        <span class="keywordtype">int</span> <a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__0.html#aa95efec38ee85b547859e222c9021223">errormode</a>, <span class="keywordtype">float</span> <a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__0.html#a2bfafae0a91b877e8728e4d552148bca">BellValue</a>) {</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keywordtype">int</span> msgsize;                 <span class="comment">/* keeps size of message */</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__0.html">ERRC_ERRDET_0</a> *msg1;  <span class="comment">/* for header to be sent */</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *msg1_data;     <span class="comment">/* pointer to data array */</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, bipo, rn_order;       <span class="comment">/* counting index, bit position */</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> localdata, bpm; <span class="comment">/* for bit extraction */</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="comment">/* prepare a structure to be sent out to the other side */</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="comment">/* first: get buffer.... */</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  msgsize = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__0.html">ERRC_ERRDET_0</a>) + 4 * ((bitsneeded + 31) / 32);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  msg1 = (<span class="keyword">struct </span><a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__0.html">ERRC_ERRDET_0</a> *)<a class="code" href="debug_8c.html#af8c2db3d81151416ecd3dcb6f38e3711">malloc2</a>(msgsize);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keywordflow">if</span> (!msg1) <span class="keywordflow">return</span> NULL; <span class="comment">/* cannot malloc */</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="comment">/* ...extract pointer to data structure... */</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  msg1_data = (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *)&amp;msg1[1];</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="comment">/* ..fill header.... */</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  msg1-&gt;<a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__0.html#a6688c938cb57a5e2d293c8ac833414c7">tag</a> = <a class="code" href="packets_8h.html#ac4fe1c43e02ab8663f6cd57dfd5c62fb">ERRC_PROTO_tag</a>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  msg1-&gt;<a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__0.html#a0a9aa8f4270d5599dc34e9e2be95bb38">bytelength</a> = msgsize;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  msg1-&gt;<a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__0.html#a7fa4fe558ebcbacb143bdc54828d3cd3">subtype</a> = <a class="code" href="packets_8h.html#ab1d00a1baf15d4e255588cbc0061a760">ERRC_ERRDET_0_subtype</a>;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  msg1-&gt;<a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__0.html#ac80b74c909527ea2364aadefe2008a1b">epoch</a> = kb-&gt;<a class="code" href="structkeyblock.html#af477132d975581ce79cab80a4fdfafd1">startepoch</a>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  msg1-&gt;<a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__0.html#a509fbd9d1d596b4a15316dcbd2cf8c85">number_of_epochs</a> = kb-&gt;<a class="code" href="structkeyblock.html#a39ef5181e0b5a80b4487af22f3fc0424">numberofepochs</a>;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  msg1-&gt;<a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__0.html#a36a186fc3bbd550f2ccfd8c769386e3c">seed</a> = kb-&gt;<a class="code" href="structkeyblock.html#acb4d8d5a8ec6dfeaad5352daf4d8b843">RNG_state</a>; <span class="comment">/* this is the seed */</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  msg1-&gt;<a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__0.html#a6a3187d15716ade00f3a2919c94f06ea">numberofbits</a> = bitsneeded;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  msg1-&gt;<a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__0.html#aa95efec38ee85b547859e222c9021223">errormode</a> = <a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__0.html#aa95efec38ee85b547859e222c9021223">errormode</a>;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  msg1-&gt;<a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__0.html#a2bfafae0a91b877e8728e4d552148bca">BellValue</a> = <a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__0.html#a2bfafae0a91b877e8728e4d552148bca">BellValue</a>;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="comment">/* determine random number order needed for given bitlength */</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="comment">/* can this go into the keyblock preparation ??? */</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  rn_order = <a class="code" href="helpers_8c.html#a68ae99580c147d404785bba0a52f7dc0">get_order_2</a>(kb-&gt;<a class="code" href="structkeyblock.html#a7cc8739f33c53ca94123d468a1c090a4">initialbits</a>);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="comment">/* mark selected bits in this stream and fill this structure with bits */</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  localdata = 0;                     <span class="comment">/* storage for bits */</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; bitsneeded; <a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) { <span class="comment">/* count through all needed bits */</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">do</span> {                             <span class="comment">/* generate a bit position */</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      bipo = <a class="code" href="rnd_8c.html#abd261d6d18bfbb9463ea56f5a221770a">PRNG_value2</a>(rn_order, &amp;kb-&gt;<a class="code" href="structkeyblock.html#acb4d8d5a8ec6dfeaad5352daf4d8b843">RNG_state</a>);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <span class="keywordflow">if</span> (bipo &gt; kb-&gt;<a class="code" href="structkeyblock.html#a7cc8739f33c53ca94123d468a1c090a4">initialbits</a>) <span class="keywordflow">continue</span>;          <span class="comment">/* out of range */</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      bpm = <a class="code" href="helpers_8h.html#ae447cbbcd1ebc2fb52c0ef6c0672cffc">bt_mask</a>(bipo);                           <span class="comment">/* bit mask */</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <span class="keywordflow">if</span> (kb-&gt;<a class="code" href="structkeyblock.html#a61d57ba0147360adcc41320ff84c62ef">testmarker</a>[bipo / 32] &amp; bpm) <span class="keywordflow">continue</span>; <span class="comment">/* already used */</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="comment">/* got finally a bit */</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      kb-&gt;<a class="code" href="structkeyblock.html#a61d57ba0147360adcc41320ff84c62ef">testmarker</a>[bipo / 32] |= bpm; <span class="comment">/* mark as used */</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      <span class="keywordflow">if</span> (kb-&gt;<a class="code" href="structkeyblock.html#a19b74f671254c24bedb3b167c2b73621">mainbuf</a>[bipo / 32] &amp; bpm) localdata |= <a class="code" href="helpers_8h.html#ae447cbbcd1ebc2fb52c0ef6c0672cffc">bt_mask</a>(<a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &amp; 31) == 31) {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        msg1_data[<a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> / 32] = localdata;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        localdata = 0; <span class="comment">/* reset buffer */</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      }</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <span class="keywordflow">break</span>; <span class="comment">/* end rng search cycle */</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    } <span class="keywordflow">while</span> (1);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="comment">/* fill in last localdata */</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &amp; 31) {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    msg1_data[<a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> / 32] = localdata;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  } <span class="comment">/* there was something left */</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="comment">/* update thread structure with used bits */</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  kb-&gt;<a class="code" href="structkeyblock.html#a6fbe46cd00a669058100f9a0b70a34f3">leakagebits</a> += bitsneeded;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  kb-&gt;<a class="code" href="structkeyblock.html#a35590fd5f98257e0a10964384ddba356">processingstate</a> = <a class="code" href="proc__state_8h.html#a9dfb56a993be1284ab01656a33e4835a">PRS_WAITRESPONSE1</a>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordflow">return</span> msg1; <span class="comment">/* pointer to message */</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;}</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="comms_8h.html#aceeb2dd5c38b3d906e4670cdac1925db">  115</a></span>&#160;<span class="keyword">struct </span><a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__5.html">ERRC_ERRDET_5</a> *<a class="code" href="comms_8c.html#aceeb2dd5c38b3d906e4670cdac1925db">make_messagehead_5</a>(<span class="keyword">struct</span> <a class="code" href="structkeyblock.html">keyblock</a> *kb) {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="keywordtype">int</span> msglen; <span class="comment">/* length of outgoing structure (data+header) */</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__5.html">ERRC_ERRDET_5</a> *out_head;                 <span class="comment">/* return value */</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  msglen = ((kb-&gt;<a class="code" href="structkeyblock.html#a3a2a106a9870115b7ef0b00d49d23c43">diffnumber</a> + 31) / 32) * 4 * 2 + <span class="comment">/* two bitfields */</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;           <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__5.html">ERRC_ERRDET_5</a>);          <span class="comment">/* ..plus one header */</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  out_head = (<span class="keyword">struct </span><a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__5.html">ERRC_ERRDET_5</a> *)<a class="code" href="debug_8c.html#af8c2db3d81151416ecd3dcb6f38e3711">malloc2</a>(msglen);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="keywordflow">if</span> (!out_head) <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  out_head-&gt;<a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__5.html#a9a8f7ec08ae972b12072164c39bc59ab">tag</a> = <a class="code" href="packets_8h.html#ac4fe1c43e02ab8663f6cd57dfd5c62fb">ERRC_PROTO_tag</a>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  out_head-&gt;<a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__5.html#a784eb104ba6931cd2db05da60b910e9e">bytelength</a> = msglen;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  out_head-&gt;<a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__5.html#a3784ecd52415a2f613127e6051bce49d">subtype</a> = <a class="code" href="packets_8h.html#ad3160147e9940740f2da9d3380bb6e3c">ERRC_ERRDET_5_subtype</a>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  out_head-&gt;<a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__5.html#aab54054c4d43d38694a449989399a795">epoch</a> = kb-&gt;<a class="code" href="structkeyblock.html#af477132d975581ce79cab80a4fdfafd1">startepoch</a>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  out_head-&gt;<a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__5.html#a9bffabb94876cd95c0184171b8cf8ff1">number_of_epochs</a> = kb-&gt;<a class="code" href="structkeyblock.html#a39ef5181e0b5a80b4487af22f3fc0424">numberofepochs</a>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  out_head-&gt;<a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__5.html#a8c3bd965196c1803e9e8dc28d6100ea1">number_entries</a> = kb-&gt;<a class="code" href="structkeyblock.html#a3a2a106a9870115b7ef0b00d49d23c43">diffnumber</a>;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  out_head-&gt;<a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__5.html#ab8bdb8155b56a89a2e5952cfc718f079">index_present</a> = 0;              <span class="comment">/* this is an ordidary reply */</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  out_head-&gt;<a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__5.html#a9a38ec7e57c9b970d1b36000793f3b58">runlevel</a> = kb-&gt;<a class="code" href="structkeyblock.html#a6b2fc395075221a7edec698fc747c04b">binsearch_depth</a>; <span class="comment">/* next round */</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="keywordflow">return</span> out_head;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;}</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="comms_8h.html#ae360e287fe395beef547c08969660d3c">  146</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="comms_8c.html#ae360e287fe395beef547c08969660d3c">prepare_first_binsearch_msg</a>(<span class="keyword">struct</span> <a class="code" href="structkeyblock.html">keyblock</a> *kb, <span class="keywordtype">int</span> pass) {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, j;                             <span class="comment">/* index variables */</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordtype">int</span> k;                                <span class="comment">/* length of keyblocks */</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *<a class="code" href="chopper_8c.html#a9730d023c4355c7cd5acd01543b14e64">pd</a>;                     <span class="comment">/* parity difference bitfield pointer */</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> msg5size;                <span class="comment">/* size of message */</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__5.html">ERRC_ERRDET_5</a> *h5;             <span class="comment">/* pointer to first message */</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *h5_data, *h5_idx;       <span class="comment">/* data pointers */</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *d;                      <span class="comment">/* temporary pointer on parity data */</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> resbuf, tmp_par, lm, fm; <span class="comment">/* parity determination variables */</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="keywordtype">int</span> kdiff, fbi, lbi, fi, li, ri;      <span class="comment">/* working variables for parity eval */</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keywordtype">int</span> partitions; <span class="comment">/* local partitions o go through for diff idx */</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keywordflow">switch</span> (pass) { <span class="comment">/* sort out specifics */</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordflow">case</span> 0:       <span class="comment">/* unpermutated pass */</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <a class="code" href="structprotocol__details.html">pd</a> = kb-&gt;<a class="code" href="structkeyblock.html#a1c8f5cce6f4cc4cd106eef01127e2ce8">pd0</a>;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      k = kb-&gt;<a class="code" href="structkeyblock.html#aa80fc600c52bfd73abf5f80591bcab85">k0</a>;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      partitions = kb-&gt;<a class="code" href="structkeyblock.html#ae314ec8f6d803cc48f9451080aeb13e0">partitions0</a>;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      d = kb-&gt;<a class="code" href="structkeyblock.html#a19b74f671254c24bedb3b167c2b73621">mainbuf</a>; <span class="comment">/* unpermuted key */</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordflow">case</span> 1: <span class="comment">/* permutated pass */</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <a class="code" href="structprotocol__details.html">pd</a> = kb-&gt;<a class="code" href="structkeyblock.html#a2967977b023a5e74532df4eac5bf773e">pd1</a>;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      k = kb-&gt;<a class="code" href="structkeyblock.html#a2b4995d4c06a41acc9720753ee1f6e0e">k1</a>;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      partitions = kb-&gt;<a class="code" href="structkeyblock.html#ae05b307d9c0e5fef4f65163ca099e834">partitions1</a>;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      d = kb-&gt;<a class="code" href="structkeyblock.html#a50c5a9eb9973e7648bd1359fa31fa789">permutebuf</a>; <span class="comment">/* permuted key */</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordflow">default</span>:     <span class="comment">/* illegal */</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      <span class="keywordflow">return</span> 59; <span class="comment">/* illegal pass arg */</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="comment">/* fill difference index memory */</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  j = 0; <span class="comment">/* index for mismatching blocks */</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; partitions; <a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="helpers_8h.html#ae447cbbcd1ebc2fb52c0ef6c0672cffc">bt_mask</a>(<a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>) &amp; <a class="code" href="structprotocol__details.html">pd</a>[<a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> / 32]) {       <span class="comment">/* this block is mismatched */</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      kb-&gt;<a class="code" href="structkeyblock.html#a4ec05d5e560406d74383c7b3b2c805eb">diffidx</a>[j] = <a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> * k;            <span class="comment">/* store bit index, not block index */</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      kb-&gt;<a class="code" href="structkeyblock.html#aad9a85897bab20d52c1c39fd5d61e95e">diffidxe</a>[j] = <a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> * k + (k - 1); <span class="comment">/* last block */</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      j++;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="comment">/* mark pass/round correctly in kb */</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  kb-&gt;<a class="code" href="structkeyblock.html#a6b2fc395075221a7edec698fc747c04b">binsearch_depth</a> = (pass == 0 ? <a class="code" href="packets_8h.html#a808615e67d1e011f3e19fef7c4a08d58">RUNLEVEL_FIRSTPASS</a> : <a class="code" href="packets_8h.html#a019dde3ab1b5b014ebec3af3d946ba23">RUNLEVEL_SECONDPASS</a>) |</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                        0; <span class="comment">/* first round */</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="comment">/* prepare message buffer for first binsearch message  */</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  msg5size = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__5.html">ERRC_ERRDET_5</a>) <span class="comment">/* header need */</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;             + ((kb-&gt;diffnumber + 31) / 32) *</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                   <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> int)               <span class="comment">/* parity data need */</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;             + kb-&gt;diffnumber * <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>); <span class="comment">/* indexing need */</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  h5 = (<span class="keyword">struct </span><a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__5.html">ERRC_ERRDET_5</a> *)<a class="code" href="debug_8c.html#af8c2db3d81151416ecd3dcb6f38e3711">malloc2</a>(msg5size);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="keywordflow">if</span> (!h5) <span class="keywordflow">return</span> 55;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  h5_data = (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *)&amp;h5[1]; <span class="comment">/* start of data */</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  h5-&gt;<a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__5.html#a9a8f7ec08ae972b12072164c39bc59ab">tag</a> = <a class="code" href="packets_8h.html#ac4fe1c43e02ab8663f6cd57dfd5c62fb">ERRC_PROTO_tag</a>;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  h5-&gt;<a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__5.html#a3784ecd52415a2f613127e6051bce49d">subtype</a> = <a class="code" href="packets_8h.html#ad3160147e9940740f2da9d3380bb6e3c">ERRC_ERRDET_5_subtype</a>;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  h5-&gt;<a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__5.html#a784eb104ba6931cd2db05da60b910e9e">bytelength</a> = msg5size;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  h5-&gt;<a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__5.html#aab54054c4d43d38694a449989399a795">epoch</a> = kb-&gt;startepoch;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  h5-&gt;<a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__5.html#a9bffabb94876cd95c0184171b8cf8ff1">number_of_epochs</a> = kb-&gt;numberofepochs;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  h5-&gt;<a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__5.html#a8c3bd965196c1803e9e8dc28d6100ea1">number_entries</a> = kb-&gt;diffnumber;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  h5-&gt;<a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__5.html#ab8bdb8155b56a89a2e5952cfc718f079">index_present</a> = 1;              <span class="comment">/* this round we have an index table */</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  h5-&gt;<a class="code" href="struct_e_r_r_c___e_r_r_d_e_t__5.html#a9a38ec7e57c9b970d1b36000793f3b58">runlevel</a> = kb-&gt;binsearch_depth; <span class="comment">/* keep local status */</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="comment">/* prepare block index list of simple type 1, uncompressed uint32 */</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  h5_idx = &amp;h5_data[((kb-&gt;diffnumber + 31) / 32)];</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; kb-&gt;diffnumber; <a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) h5_idx[<a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = kb-&gt;diffidx[<a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="comment">/* prepare parity results */</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  resbuf = 0;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  tmp_par = 0;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  for (<a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; kb-&gt;diffnumber; <a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {          <span class="comment">/* go through all keyblocks */</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    kdiff = kb-&gt;diffidxe[<a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] - kb-&gt;diffidx[<a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] + 1; <span class="comment">/* left length */</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    fbi = kb-&gt;diffidx[<a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    lbi = fbi + kdiff / 2 - 1; <span class="comment">/* first and last bitidx */</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    fi = fbi / 32;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    fm = <a class="code" href="helpers_8h.html#a25416c9f7516d1e7efb0023fe4fab909">firstmask</a>(fbi &amp; 31); <span class="comment">/* beginning */</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    li = lbi / 32;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    lm = <a class="code" href="helpers_8h.html#a1184ea14470ba58e26ee321f40be77e0">lastmask</a>(lbi &amp; 31); <span class="comment">/* end */</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordflow">if</span> (li == fi) {          <span class="comment">/* in same word */</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      tmp_par = d[fi] &amp; lm &amp; fm;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      tmp_par = (d[fi] &amp; fm) ^ (d[li] &amp; lm);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <span class="keywordflow">for</span> (ri = fi + 1; ri &lt; li; ri++) tmp_par ^= d[ri];</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    } <span class="comment">/* tmp_par holds now a combination of bits to be tested */</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    resbuf = (resbuf &lt;&lt; 1) + <a class="code" href="rnd_8c.html#abcc0dd5e29de4965c7b9816465f933b7">parity</a>(tmp_par);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &amp; 31) == 31) {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      h5_data[<a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> / 32] = resbuf;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    }</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &amp; 31)</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    h5_data[<a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> / 32] = resbuf &lt;&lt; (32 - (<a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &amp; 31)); <span class="comment">/* last parity bits */</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="comment">/* increment lost bits */</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  kb-&gt;leakagebits += kb-&gt;diffnumber;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="comment">/* send out message */</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <a class="code" href="comms_8c.html#ab685a2df59da9e7fb20e4fd477eca731">insert_sendpacket</a>((<span class="keywordtype">char</span> *)h5, msg5size);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="astruct_e_r_r_c___e_r_r_d_e_t__0_html_aa95efec38ee85b547859e222c9021223"><div class="ttname"><a href="struct_e_r_r_c___e_r_r_d_e_t__0.html#aa95efec38ee85b547859e222c9021223">ERRC_ERRDET_0::errormode</a></div><div class="ttdeci">unsigned int errormode</div><div class="ttdoc">initial error est skip?</div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00063">packets.h:63</a></div></div>
<div class="ttc" id="astruct_e_r_r_c___e_r_r_d_e_t__5_html_a9bffabb94876cd95c0184171b8cf8ff1"><div class="ttname"><a href="struct_e_r_r_c___e_r_r_d_e_t__5.html#a9bffabb94876cd95c0184171b8cf8ff1">ERRC_ERRDET_5::number_of_epochs</a></div><div class="ttdeci">unsigned int number_of_epochs</div><div class="ttdoc">length of the block</div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00139">packets.h:139</a></div></div>
<div class="ttc" id="arnd_8c_html_abd261d6d18bfbb9463ea56f5a221770a"><div class="ttname"><a href="rnd_8c.html#abd261d6d18bfbb9463ea56f5a221770a">PRNG_value2</a></div><div class="ttdeci">unsigned int PRNG_value2(int k, unsigned int *state)</div><div class="ttdoc">version which iterates the PRNG from a given state location</div><div class="ttdef"><b>Definition:</b> <a href="rnd_8c_source.html#l00100">rnd.c:100</a></div></div>
<div class="ttc" id="astruct_e_r_r_c___e_r_r_d_e_t__0_html_a0a9aa8f4270d5599dc34e9e2be95bb38"><div class="ttname"><a href="struct_e_r_r_c___e_r_r_d_e_t__0.html#a0a9aa8f4270d5599dc34e9e2be95bb38">ERRC_ERRDET_0::bytelength</a></div><div class="ttdeci">unsigned int bytelength</div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00057">packets.h:57</a></div></div>
<div class="ttc" id="astruct_e_r_r_c___e_r_r_d_e_t__5_html_a784eb104ba6931cd2db05da60b910e9e"><div class="ttname"><a href="struct_e_r_r_c___e_r_r_d_e_t__5.html#a784eb104ba6931cd2db05da60b910e9e">ERRC_ERRDET_5::bytelength</a></div><div class="ttdeci">unsigned int bytelength</div><div class="ttdoc">the length of the packet incl header</div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00136">packets.h:136</a></div></div>
<div class="ttc" id="astruct_e_r_r_c___e_r_r_d_e_t__0_html_a2bfafae0a91b877e8728e4d552148bca"><div class="ttname"><a href="struct_e_r_r_c___e_r_r_d_e_t__0.html#a2bfafae0a91b877e8728e4d552148bca">ERRC_ERRDET_0::BellValue</a></div><div class="ttdeci">float BellValue</div><div class="ttdoc">may contain a value for Bell violat</div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00064">packets.h:64</a></div></div>
<div class="ttc" id="ahelpers_8c_html_a68ae99580c147d404785bba0a52f7dc0"><div class="ttname"><a href="helpers_8c.html#a68ae99580c147d404785bba0a52f7dc0">get_order_2</a></div><div class="ttdeci">int get_order_2(int x)</div><div class="ttdoc">get the number of bits necessary to carry a number x</div><div class="ttdef"><b>Definition:</b> <a href="helpers_8c_source.html#l00026">helpers.c:26</a></div></div>
<div class="ttc" id="acomms_8c_html_ae360e287fe395beef547c08969660d3c"><div class="ttname"><a href="comms_8c.html#ae360e287fe395beef547c08969660d3c">prepare_first_binsearch_msg</a></div><div class="ttdeci">int prepare_first_binsearch_msg(struct keyblock *kb, int pass)</div><div class="ttdoc">Function to prepare the first message head (header_5) for a binary search.</div><div class="ttdef"><b>Definition:</b> <a href="comms_8c_source.html#l00146">comms.c:146</a></div></div>
<div class="ttc" id="astruct_e_r_r_c___e_r_r_d_e_t__0_html_a509fbd9d1d596b4a15316dcbd2cf8c85"><div class="ttname"><a href="struct_e_r_r_c___e_r_r_d_e_t__0.html#a509fbd9d1d596b4a15316dcbd2cf8c85">ERRC_ERRDET_0::number_of_epochs</a></div><div class="ttdeci">unsigned int number_of_epochs</div><div class="ttdoc">defines implicitly the block length</div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00060">packets.h:60</a></div></div>
<div class="ttc" id="ahelpers_8h_html_a25416c9f7516d1e7efb0023fe4fab909"><div class="ttname"><a href="helpers_8h.html#a25416c9f7516d1e7efb0023fe4fab909">firstmask</a></div><div class="ttdeci">__inline__ unsigned int firstmask(int i)</div><div class="ttdoc">Helper function for parity isolation.</div><div class="ttdef"><b>Definition:</b> <a href="helpers_8h_source.html#l00084">helpers.h:84</a></div></div>
<div class="ttc" id="astruct_e_r_r_c___e_r_r_d_e_t__5_html_aab54054c4d43d38694a449989399a795"><div class="ttname"><a href="struct_e_r_r_c___e_r_r_d_e_t__5.html#aab54054c4d43d38694a449989399a795">ERRC_ERRDET_5::epoch</a></div><div class="ttdeci">unsigned int epoch</div><div class="ttdoc">defines epoch of first packet</div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00138">packets.h:138</a></div></div>
<div class="ttc" id="apackets_8h_html_ad3160147e9940740f2da9d3380bb6e3c"><div class="ttname"><a href="packets_8h.html#ad3160147e9940740f2da9d3380bb6e3c">ERRC_ERRDET_5_subtype</a></div><div class="ttdeci">#define ERRC_ERRDET_5_subtype</div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00145">packets.h:144</a></div></div>
<div class="ttc" id="astructkeyblock_html_a7cc8739f33c53ca94123d468a1c090a4"><div class="ttname"><a href="structkeyblock.html#a7cc8739f33c53ca94123d468a1c090a4">keyblock::initialbits</a></div><div class="ttdeci">int initialbits</div><div class="ttdoc">bits to start with</div><div class="ttdef"><b>Definition:</b> <a href="keyblock_8h_source.html#l00043">keyblock.h:43</a></div></div>
<div class="ttc" id="astructkeyblock_html_af477132d975581ce79cab80a4fdfafd1"><div class="ttname"><a href="structkeyblock.html#af477132d975581ce79cab80a4fdfafd1">keyblock::startepoch</a></div><div class="ttdeci">unsigned int startepoch</div><div class="ttdoc">initial epoch of block</div><div class="ttdef"><b>Definition:</b> <a href="keyblock_8h_source.html#l00034">keyblock.h:34</a></div></div>
<div class="ttc" id="acomms_8c_html_ab685a2df59da9e7fb20e4fd477eca731"><div class="ttname"><a href="comms_8c.html#ab685a2df59da9e7fb20e4fd477eca731">insert_sendpacket</a></div><div class="ttdeci">int insert_sendpacket(char *message, int length)</div><div class="ttdoc">Helper to insert a send packet in the sendpacket queue.</div><div class="ttdef"><b>Definition:</b> <a href="comms_8c_source.html#l00016">comms.c:16</a></div></div>
<div class="ttc" id="astructkeyblock_html_a35590fd5f98257e0a10964384ddba356"><div class="ttname"><a href="structkeyblock.html#a35590fd5f98257e0a10964384ddba356">keyblock::processingstate</a></div><div class="ttdeci">int processingstate</div><div class="ttdoc">determines processing status current block.</div><div class="ttdef"><b>Definition:</b> <a href="keyblock_8h_source.html#l00045">keyblock.h:45</a></div></div>
<div class="ttc" id="apackets_8h_html_a019dde3ab1b5b014ebec3af3d946ba23"><div class="ttname"><a href="packets_8h.html#a019dde3ab1b5b014ebec3af3d946ba23">RUNLEVEL_SECONDPASS</a></div><div class="ttdeci">#define RUNLEVEL_SECONDPASS</div><div class="ttdoc">for message 5</div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00148">packets.h:147</a></div></div>
<div class="ttc" id="astructkeyblock_html"><div class="ttname"><a href="structkeyblock.html">keyblock</a></div><div class="ttdoc">Definition of a structure containing all informations about a block.</div><div class="ttdef"><b>Definition:</b> <a href="keyblock_8h_source.html#l00033">keyblock.h:33</a></div></div>
<div class="ttc" id="ahelpers_8h_html_a1184ea14470ba58e26ee321f40be77e0"><div class="ttname"><a href="helpers_8h.html#a1184ea14470ba58e26ee321f40be77e0">lastmask</a></div><div class="ttdeci">__inline__ unsigned int lastmask(int i)</div><div class="ttdef"><b>Definition:</b> <a href="helpers_8h_source.html#l00085">helpers.h:85</a></div></div>
<div class="ttc" id="astructkeyblock_html_a19b74f671254c24bedb3b167c2b73621"><div class="ttname"><a href="structkeyblock.html#a19b74f671254c24bedb3b167c2b73621">keyblock::mainbuf</a></div><div class="ttdeci">unsigned int * mainbuf</div><div class="ttdoc">points to main buffer for key</div><div class="ttdef"><b>Definition:</b> <a href="keyblock_8h_source.html#l00037">keyblock.h:37</a></div></div>
<div class="ttc" id="astruct_e_r_r_c___e_r_r_d_e_t__0_html_ac80b74c909527ea2364aadefe2008a1b"><div class="ttname"><a href="struct_e_r_r_c___e_r_r_d_e_t__0.html#ac80b74c909527ea2364aadefe2008a1b">ERRC_ERRDET_0::epoch</a></div><div class="ttdeci">unsigned int epoch</div><div class="ttdoc">defines epoch of first packet</div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00059">packets.h:59</a></div></div>
<div class="ttc" id="achopper_8c_html_a9730d023c4355c7cd5acd01543b14e64"><div class="ttname"><a href="chopper_8c.html#a9730d023c4355c7cd5acd01543b14e64">pd</a></div><div class="ttdeci">struct protocol_details pd</div></div>
<div class="ttc" id="astructpacket__to__send_html_a595a74e76d5e95ccc3a6360fe37f43ec"><div class="ttname"><a href="structpacket__to__send.html#a595a74e76d5e95ccc3a6360fe37f43ec">packet_to_send::packet</a></div><div class="ttdeci">char * packet</div><div class="ttdoc">pointer to content</div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00204">packets.h:204</a></div></div>
<div class="ttc" id="astructkeyblock_html_ae05b307d9c0e5fef4f65163ca099e834"><div class="ttname"><a href="structkeyblock.html#ae05b307d9c0e5fef4f65163ca099e834">keyblock::partitions1</a></div><div class="ttdeci">int partitions1</div><div class="ttdoc">number of partitions of k0,k1 length</div><div class="ttdef"><b>Definition:</b> <a href="keyblock_8h_source.html#l00055">keyblock.h:55</a></div></div>
<div class="ttc" id="apackets_8h_html_ac4fe1c43e02ab8663f6cd57dfd5c62fb"><div class="ttname"><a href="packets_8h.html#ac4fe1c43e02ab8663f6cd57dfd5c62fb">ERRC_PROTO_tag</a></div><div class="ttdeci">#define ERRC_PROTO_tag</div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00050">packets.h:49</a></div></div>
<div class="ttc" id="astructkeyblock_html_a2b4995d4c06a41acc9720753ee1f6e0e"><div class="ttname"><a href="structkeyblock.html#a2b4995d4c06a41acc9720753ee1f6e0e">keyblock::k1</a></div><div class="ttdeci">int k1</div><div class="ttdoc">binary block search lengths</div><div class="ttdef"><b>Definition:</b> <a href="keyblock_8h_source.html#l00053">keyblock.h:53</a></div></div>
<div class="ttc" id="apackets_8h_html_a808615e67d1e011f3e19fef7c4a08d58"><div class="ttname"><a href="packets_8h.html#a808615e67d1e011f3e19fef7c4a08d58">RUNLEVEL_FIRSTPASS</a></div><div class="ttdeci">#define RUNLEVEL_FIRSTPASS</div><div class="ttdoc">for message 5</div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00147">packets.h:146</a></div></div>
<div class="ttc" id="arnd_8c_html_abcc0dd5e29de4965c7b9816465f933b7"><div class="ttname"><a href="rnd_8c.html#abcc0dd5e29de4965c7b9816465f933b7">parity</a></div><div class="ttdeci">int parity(unsigned int a)</div><div class="ttdoc">this is an implementation of an m-sequence</div><div class="ttdef"><b>Definition:</b> <a href="rnd_8c_source.html#l00043">rnd.c:43</a></div></div>
<div class="ttc" id="aproc__state_8h_html_a9dfb56a993be1284ab01656a33e4835a"><div class="ttname"><a href="proc__state_8h.html#a9dfb56a993be1284ab01656a33e4835a">PRS_WAITRESPONSE1</a></div><div class="ttdeci">#define PRS_WAITRESPONSE1</div><div class="ttdoc">waiting for error est response from bob</div><div class="ttdef"><b>Definition:</b> <a href="proc__state_8h_source.html#l00042">proc_state.h:41</a></div></div>
<div class="ttc" id="astructkeyblock_html_a1c8f5cce6f4cc4cd106eef01127e2ce8"><div class="ttname"><a href="structkeyblock.html#a1c8f5cce6f4cc4cd106eef01127e2ce8">keyblock::pd0</a></div><div class="ttdeci">unsigned int * pd0</div><div class="ttdef"><b>Definition:</b> <a href="keyblock_8h_source.html#l00058">keyblock.h:58</a></div></div>
<div class="ttc" id="astruct_e_r_r_c___e_r_r_d_e_t__5_html"><div class="ttname"><a href="struct_e_r_r_c___e_r_r_d_e_t__5.html">ERRC_ERRDET_5</a></div><div class="ttdoc">Binary search message packet.</div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00134">packets.h:134</a></div></div>
<div class="ttc" id="adebug_8c_html_af8c2db3d81151416ecd3dcb6f38e3711"><div class="ttname"><a href="debug_8c.html#af8c2db3d81151416ecd3dcb6f38e3711">malloc2</a></div><div class="ttdeci">char * malloc2(unsigned int s)</div><div class="ttdoc">malloc wrapper for debugging purposes</div><div class="ttdef"><b>Definition:</b> <a href="debug_8c_source.html#l00011">debug.c:11</a></div></div>
<div class="ttc" id="astruct_e_r_r_c___e_r_r_d_e_t__0_html_a6a3187d15716ade00f3a2919c94f06ea"><div class="ttname"><a href="struct_e_r_r_c___e_r_r_d_e_t__0.html#a6a3187d15716ade00f3a2919c94f06ea">ERRC_ERRDET_0::numberofbits</a></div><div class="ttdeci">unsigned int numberofbits</div><div class="ttdoc">bits to follow</div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00062">packets.h:62</a></div></div>
<div class="ttc" id="acomms_8c_html_aceeb2dd5c38b3d906e4670cdac1925db"><div class="ttname"><a href="comms_8c.html#aceeb2dd5c38b3d906e4670cdac1925db">make_messagehead_5</a></div><div class="ttdeci">struct ERRC_ERRDET_5 * make_messagehead_5(struct keyblock *kb)</div><div class="ttdoc">Helper function for binsearch replies; mallocs and fills msg header.</div><div class="ttdef"><b>Definition:</b> <a href="comms_8c_source.html#l00115">comms.c:115</a></div></div>
<div class="ttc" id="astructkeyblock_html_a6b2fc395075221a7edec698fc747c04b"><div class="ttname"><a href="structkeyblock.html#a6b2fc395075221a7edec698fc747c04b">keyblock::binsearch_depth</a></div><div class="ttdeci">int binsearch_depth</div><div class="ttdoc">encodes state of the scan.</div><div class="ttdef"><b>Definition:</b> <a href="keyblock_8h_source.html#l00063">keyblock.h:63</a></div></div>
<div class="ttc" id="astruct_e_r_r_c___e_r_r_d_e_t__0_html_a6688c938cb57a5e2d293c8ac833414c7"><div class="ttname"><a href="struct_e_r_r_c___e_r_r_d_e_t__0.html#a6688c938cb57a5e2d293c8ac833414c7">ERRC_ERRDET_0::tag</a></div><div class="ttdeci">unsigned int tag</div><div class="ttdoc">always 6</div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00056">packets.h:56</a></div></div>
<div class="ttc" id="astruct_e_r_r_c___e_r_r_d_e_t__0_html"><div class="ttname"><a href="struct_e_r_r_c___e_r_r_d_e_t__0.html">ERRC_ERRDET_0</a></div><div class="ttdoc">packet for PRNG based subset for bit subset transmission in err estim</div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00055">packets.h:55</a></div></div>
<div class="ttc" id="astructkeyblock_html_a39ef5181e0b5a80b4487af22f3fc0424"><div class="ttname"><a href="structkeyblock.html#a39ef5181e0b5a80b4487af22f3fc0424">keyblock::numberofepochs</a></div><div class="ttdeci">unsigned int numberofepochs</div><div class="ttdef"><b>Definition:</b> <a href="keyblock_8h_source.html#l00035">keyblock.h:35</a></div></div>
<div class="ttc" id="astructkeyblock_html_aad9a85897bab20d52c1c39fd5d61e95e"><div class="ttname"><a href="structkeyblock.html#aad9a85897bab20d52c1c39fd5d61e95e">keyblock::diffidxe</a></div><div class="ttdeci">unsigned int * diffidxe</div><div class="ttdoc">end of interval</div><div class="ttdef"><b>Definition:</b> <a href="keyblock_8h_source.html#l00062">keyblock.h:62</a></div></div>
<div class="ttc" id="ahelpers_8h_html_ae447cbbcd1ebc2fb52c0ef6c0672cffc"><div class="ttname"><a href="helpers_8h.html#ae447cbbcd1ebc2fb52c0ef6c0672cffc">bt_mask</a></div><div class="ttdeci">__inline__ unsigned int bt_mask(int i)</div><div class="ttdoc">Helper for mask for a given index i on the longint array.</div><div class="ttdef"><b>Definition:</b> <a href="helpers_8h_source.html#l00076">helpers.h:76</a></div></div>
<div class="ttc" id="astructkeyblock_html_a4ec05d5e560406d74383c7b3b2c805eb"><div class="ttname"><a href="structkeyblock.html#a4ec05d5e560406d74383c7b3b2c805eb">keyblock::diffidx</a></div><div class="ttdeci">unsigned int * diffidx</div><div class="ttdoc">pointer to a list of parity mismatch blocks</div><div class="ttdef"><b>Definition:</b> <a href="keyblock_8h_source.html#l00061">keyblock.h:61</a></div></div>
<div class="ttc" id="astruct_e_r_r_c___e_r_r_d_e_t__5_html_a3784ecd52415a2f613127e6051bce49d"><div class="ttname"><a href="struct_e_r_r_c___e_r_r_d_e_t__5.html#a3784ecd52415a2f613127e6051bce49d">ERRC_ERRDET_5::subtype</a></div><div class="ttdeci">unsigned int subtype</div><div class="ttdoc">5 for request of bit number packet</div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00137">packets.h:137</a></div></div>
<div class="ttc" id="astructpacket__to__send_html_ad0befdf18a26825a57674a4f59986ca2"><div class="ttname"><a href="structpacket__to__send.html#ad0befdf18a26825a57674a4f59986ca2">packet_to_send::length</a></div><div class="ttdeci">int length</div><div class="ttdoc">in bytes</div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00203">packets.h:203</a></div></div>
<div class="ttc" id="astruct_e_r_r_c___e_r_r_d_e_t__5_html_a8c3bd965196c1803e9e8dc28d6100ea1"><div class="ttname"><a href="struct_e_r_r_c___e_r_r_d_e_t__5.html#a8c3bd965196c1803e9e8dc28d6100ea1">ERRC_ERRDET_5::number_entries</a></div><div class="ttdeci">unsigned int number_entries</div><div class="ttdoc">number of blocks with parity mismatch</div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00140">packets.h:140</a></div></div>
<div class="ttc" id="astructkeyblock_html_a3a2a106a9870115b7ef0b00d49d23c43"><div class="ttname"><a href="structkeyblock.html#a3a2a106a9870115b7ef0b00d49d23c43">keyblock::diffnumber</a></div><div class="ttdeci">int diffnumber</div><div class="ttdoc">number of different blocks in current round</div><div class="ttdef"><b>Definition:</b> <a href="keyblock_8h_source.html#l00059">keyblock.h:59</a></div></div>
<div class="ttc" id="astructkeyblock_html_a2967977b023a5e74532df4eac5bf773e"><div class="ttname"><a href="structkeyblock.html#a2967977b023a5e74532df4eac5bf773e">keyblock::pd1</a></div><div class="ttdeci">unsigned int * pd1</div><div class="ttdoc">pointer to parity difference fileld</div><div class="ttdef"><b>Definition:</b> <a href="keyblock_8h_source.html#l00058">keyblock.h:58</a></div></div>
<div class="ttc" id="astructkeyblock_html_acb4d8d5a8ec6dfeaad5352daf4d8b843"><div class="ttname"><a href="structkeyblock.html#acb4d8d5a8ec6dfeaad5352daf4d8b843">keyblock::RNG_state</a></div><div class="ttdeci">unsigned int RNG_state</div><div class="ttdoc">keeps the state of the PRNG for this thread</div><div class="ttdef"><b>Definition:</b> <a href="keyblock_8h_source.html#l00052">keyblock.h:52</a></div></div>
<div class="ttc" id="astructkeyblock_html_a6fbe46cd00a669058100f9a0b70a34f3"><div class="ttname"><a href="structkeyblock.html#a6fbe46cd00a669058100f9a0b70a34f3">keyblock::leakagebits</a></div><div class="ttdeci">int leakagebits</div><div class="ttdoc">information which has gone public</div><div class="ttdef"><b>Definition:</b> <a href="keyblock_8h_source.html#l00044">keyblock.h:44</a></div></div>
<div class="ttc" id="aecd2_8h_html_a533147eb4caa484f9a001a15a2a376d5"><div class="ttname"><a href="ecd2_8h.html#a533147eb4caa484f9a001a15a2a376d5">last_packet_to_send</a></div><div class="ttdeci">struct packet_to_send * last_packet_to_send</div><div class="ttdef"><b>Definition:</b> <a href="ecd2_8h_source.html#l00202">ecd2.h:202</a></div></div>
<div class="ttc" id="aecd2_8h_html_ad2ccf7edc49e0e4e4d3f6c40df187f9b"><div class="ttname"><a href="ecd2_8h.html#ad2ccf7edc49e0e4e4d3f6c40df187f9b">next_packet_to_send</a></div><div class="ttdeci">struct packet_to_send * next_packet_to_send</div><div class="ttdef"><b>Definition:</b> <a href="ecd2_8h_source.html#l00201">ecd2.h:201</a></div></div>
<div class="ttc" id="atransferd_8h_html_a87a7526f6179b8f26681fe4dec7f9c48"><div class="ttname"><a href="transferd_8h.html#a87a7526f6179b8f26681fe4dec7f9c48">message</a></div><div class="ttdeci">char message[MESSAGELENGTH]</div><div class="ttdef"><b>Definition:</b> <a href="transferd_8h_source.html#l00360">transferd.h:360</a></div></div>
<div class="ttc" id="astruct_e_r_r_c___e_r_r_d_e_t__0_html_a7fa4fe558ebcbacb143bdc54828d3cd3"><div class="ttname"><a href="struct_e_r_r_c___e_r_r_d_e_t__0.html#a7fa4fe558ebcbacb143bdc54828d3cd3">ERRC_ERRDET_0::subtype</a></div><div class="ttdeci">unsigned int subtype</div><div class="ttdoc">0 for PRNG based subset</div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00058">packets.h:58</a></div></div>
<div class="ttc" id="acomms_8c_html_aee47c9c3a089fffd3ef8713caa9d6bf3"><div class="ttname"><a href="comms_8c.html#aee47c9c3a089fffd3ef8713caa9d6bf3">fillsamplemessage</a></div><div class="ttdeci">struct ERRC_ERRDET_0 * fillsamplemessage(struct keyblock *kb, int bitsneeded, int errormode, float BellValue)</div><div class="ttdoc">Helper function to prepare a message containing a given sample of bits.</div><div class="ttdef"><b>Definition:</b> <a href="comms_8c_source.html#l00049">comms.c:49</a></div></div>
<div class="ttc" id="astructkeyblock_html_aa80fc600c52bfd73abf5f80591bcab85"><div class="ttname"><a href="structkeyblock.html#aa80fc600c52bfd73abf5f80591bcab85">keyblock::k0</a></div><div class="ttdeci">int k0</div><div class="ttdef"><b>Definition:</b> <a href="keyblock_8h_source.html#l00053">keyblock.h:53</a></div></div>
<div class="ttc" id="astruct_e_r_r_c___e_r_r_d_e_t__0_html_a36a186fc3bbd550f2ccfd8c769386e3c"><div class="ttname"><a href="struct_e_r_r_c___e_r_r_d_e_t__0.html#a36a186fc3bbd550f2ccfd8c769386e3c">ERRC_ERRDET_0::seed</a></div><div class="ttdeci">unsigned int seed</div><div class="ttdoc">seed for PRNG</div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00061">packets.h:61</a></div></div>
<div class="ttc" id="acomms_8h_html"><div class="ttname"><a href="comms_8h.html">comms.h</a></div><div class="ttdoc">code on communications w.r.t. error correction.</div></div>
<div class="ttc" id="astruct_e_r_r_c___e_r_r_d_e_t__5_html_a9a38ec7e57c9b970d1b36000793f3b58"><div class="ttname"><a href="struct_e_r_r_c___e_r_r_d_e_t__5.html#a9a38ec7e57c9b970d1b36000793f3b58">ERRC_ERRDET_5::runlevel</a></div><div class="ttdeci">unsigned int runlevel</div><div class="ttdoc">pass and bisectioning depth</div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00142">packets.h:142</a></div></div>
<div class="ttc" id="astructpacket__to__send_html_a3a11edfcaec956d36622c5131abdf239"><div class="ttname"><a href="structpacket__to__send.html#a3a11edfcaec956d36622c5131abdf239">packet_to_send::next</a></div><div class="ttdeci">struct packet_to_send * next</div><div class="ttdoc">next one to send</div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00205">packets.h:205</a></div></div>
<div class="ttc" id="astruct_e_r_r_c___e_r_r_d_e_t__5_html_a9a8f7ec08ae972b12072164c39bc59ab"><div class="ttname"><a href="struct_e_r_r_c___e_r_r_d_e_t__5.html#a9a8f7ec08ae972b12072164c39bc59ab">ERRC_ERRDET_5::tag</a></div><div class="ttdeci">unsigned int tag</div><div class="ttdoc">6 for an error correction packet</div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00135">packets.h:135</a></div></div>
<div class="ttc" id="atransferd_8h_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="transferd_8h_source.html#l00321">transferd.h:321</a></div></div>
<div class="ttc" id="astructkeyblock_html_ae314ec8f6d803cc48f9451080aeb13e0"><div class="ttname"><a href="structkeyblock.html#ae314ec8f6d803cc48f9451080aeb13e0">keyblock::partitions0</a></div><div class="ttdeci">int partitions0</div><div class="ttdef"><b>Definition:</b> <a href="keyblock_8h_source.html#l00055">keyblock.h:55</a></div></div>
<div class="ttc" id="astructprotocol__details_html"><div class="ttname"><a href="structprotocol__details.html">protocol_details</a></div><div class="ttdef"><b>Definition:</b> <a href="chopper_8c_source.html#l00212">chopper.c:212</a></div></div>
<div class="ttc" id="astructkeyblock_html_a50c5a9eb9973e7648bd1359fa31fa789"><div class="ttname"><a href="structkeyblock.html#a50c5a9eb9973e7648bd1359fa31fa789">keyblock::permutebuf</a></div><div class="ttdeci">unsigned int * permutebuf</div><div class="ttdoc">keeps permuted bits</div><div class="ttdef"><b>Definition:</b> <a href="keyblock_8h_source.html#l00038">keyblock.h:38</a></div></div>
<div class="ttc" id="astructkeyblock_html_a61d57ba0147360adcc41320ff84c62ef"><div class="ttname"><a href="structkeyblock.html#a61d57ba0147360adcc41320ff84c62ef">keyblock::testmarker</a></div><div class="ttdeci">unsigned int * testmarker</div><div class="ttdoc">marks tested bits</div><div class="ttdef"><b>Definition:</b> <a href="keyblock_8h_source.html#l00039">keyblock.h:39</a></div></div>
<div class="ttc" id="astruct_e_r_r_c___e_r_r_d_e_t__5_html_ab8bdb8155b56a89a2e5952cfc718f079"><div class="ttname"><a href="struct_e_r_r_c___e_r_r_d_e_t__5.html#ab8bdb8155b56a89a2e5952cfc718f079">ERRC_ERRDET_5::index_present</a></div><div class="ttdeci">unsigned int index_present</div><div class="ttdoc">format /presence of index data</div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00141">packets.h:141</a></div></div>
<div class="ttc" id="apackets_8h_html_ab1d00a1baf15d4e255588cbc0061a760"><div class="ttname"><a href="packets_8h.html#ab1d00a1baf15d4e255588cbc0061a760">ERRC_ERRDET_0_subtype</a></div><div class="ttdeci">#define ERRC_ERRDET_0_subtype</div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00067">packets.h:66</a></div></div>
<div class="ttc" id="astructpacket__to__send_html"><div class="ttname"><a href="structpacket__to__send.html">packet_to_send</a></div><div class="ttdoc">structure which holds packets to send</div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00202">packets.h:202</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_69202652be06fd0e05a491cdb470f56e.html">errorcorrection</a></li><li class="navelem"><a class="el" href="comms_8c.html">comms.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.19 </li>
  </ul>
</div>
</body>
</html>
