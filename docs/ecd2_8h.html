<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.19"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>qCrypto: errorcorrection/ecd2.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">qCrypto
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
   <div id="projectbrief">A collection of code for a practical entanglement-based quantum key distribution system</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.19 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('ecd2_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">ecd2.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Error correction demon. (modifications to original errcd see below).  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="defaultdefinitions_8h_source.html">defaultdefinitions.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="globalvars_8h_source.html">globalvars.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="cascade__biconf_8h_source.html">cascade_biconf.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="comms_8h_source.html">comms.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="helpers_8h_source.html">helpers.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="qber__estim_8h_source.html">qber_estim.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="thread__mgmt_8h_source.html">thread_mgmt.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="debug_8h_source.html">debug.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="priv__amp_8h_source.html">priv_amp.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for ecd2.h:</div>
<div class="dyncontent">
<div class="center"><img src="ecd2_8h__incl.png" border="0" usemap="#aerrorcorrection_2ecd2_8h" alt=""/></div>
<map name="errorcorrection_2ecd2_8h" id="aerrorcorrection_2ecd2_8h">
<area shape="rect" title="Error correction demon. (modifications to original errcd see below)." alt="" coords="877,5,1025,32"/>
<area shape="rect" href="defaultdefinitions_8h.html" title=" " alt="" coords="67,393,197,420"/>
<area shape="rect" href="globalvars_8h.html" title="Definition file for global variables in ecd2." alt="" coords="195,311,287,338"/>
<area shape="rect" href="cascade__biconf_8h.html" title="Cascade biconf algorithm implementation." alt="" coords="1015,80,1139,107"/>
<area shape="rect" href="comms_8h.html" title=" " alt="" coords="1141,229,1217,256"/>
<area shape="rect" href="helpers_8h.html" title=" " alt="" coords="1365,311,1440,338"/>
<area shape="rect" href="debug_8h.html" title=" " alt="" coords="1270,311,1338,338"/>
<area shape="rect" href="priv__amp_8h.html" title=" " alt="" coords="629,155,715,181"/>
<area shape="rect" href="thread__mgmt_8h.html" title=" " alt="" coords="703,229,812,256"/>
<area shape="rect" href="qber__estim_8h.html" title=" " alt="" coords="902,155,999,181"/>
<area shape="rect" href="packets_8h.html" title=" " alt="" coords="794,393,873,420"/>
<area shape="rect" href="keyblock_8h.html" title="Header file containing the definitions of the keyblock &amp; block related data for the error correction ..." alt="" coords="1189,393,1275,420"/>
<area shape="rect" href="proc__state_8h.html" title=" " alt="" coords="1049,311,1143,338"/>
<area shape="rect" href="rnd_8h.html" title=" " alt="" coords="1505,393,1556,420"/>
<area shape="rect" href="pkt__header__7_8h.html" title=" " alt="" coords="413,304,555,345"/>
<area shape="rect" href="pkt__header__3_8h.html" title=" " alt="" coords="629,304,771,345"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="ecd2_8h__dep__incl.png" border="0" usemap="#aerrorcorrection_2ecd2_8hdep" alt=""/></div>
<map name="errorcorrection_2ecd2_8hdep" id="aerrorcorrection_2ecd2_8hdep">
<area shape="rect" title="Error correction demon. (modifications to original errcd see below)." alt="" coords="5,5,153,32"/>
<area shape="rect" href="ecd2_8c.html" title=" " alt="" coords="5,80,153,107"/>
</map>
</div>
</div>
<p><a href="ecd2_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:acd2e1b2dee36ccbff485d8e70b117170"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecd2_8h.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a> (int code)</td></tr>
<tr class="separator:acd2e1b2dee36ccbff485d8e70b117170"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a512509fe92d58e86e974fa3944b2e93c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecd2_8h.html#a512509fe92d58e86e974fa3944b2e93c">process_command</a> (char *in)</td></tr>
<tr class="separator:a512509fe92d58e86e974fa3944b2e93c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ddf1224851353fc92bfbff6f499fa97"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecd2_8h.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> (int argc, char *argv[])</td></tr>
<tr class="separator:a0ddf1224851353fc92bfbff6f499fa97"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a7f5d903352c2133a67099abbf29041dc"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structblockpointer.html">blockpointer</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecd2_8h.html#a7f5d903352c2133a67099abbf29041dc">blocklist</a> = NULL</td></tr>
<tr class="separator:a7f5d903352c2133a67099abbf29041dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2ccf7edc49e0e4e4d3f6c40df187f9b"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structpacket__to__send.html">packet_to_send</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecd2_8h.html#ad2ccf7edc49e0e4e4d3f6c40df187f9b">next_packet_to_send</a> = NULL</td></tr>
<tr class="separator:ad2ccf7edc49e0e4e4d3f6c40df187f9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a533147eb4caa484f9a001a15a2a376d5"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structpacket__to__send.html">packet_to_send</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecd2_8h.html#a533147eb4caa484f9a001a15a2a376d5">last_packet_to_send</a> = NULL</td></tr>
<tr class="separator:a533147eb4caa484f9a001a15a2a376d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa89fe691c73c21c1e909754c91c7db9f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecd2_8h.html#aa89fe691c73c21c1e909754c91c7db9f">biconf_rounds</a> = <a class="el" href="defaultdefinitions_8h.html#a94c768f8a25f442a8e10e5cdd446eb58">DEFAULT_BICONF_ROUNDS</a></td></tr>
<tr class="separator:aa89fe691c73c21c1e909754c91c7db9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1deaeda7bb9652c0e5a6d1b6a4ad1fca"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecd2_8h.html#a1deaeda7bb9652c0e5a6d1b6a4ad1fca">ini_err_skipmode</a> = <a class="el" href="defaultdefinitions_8h.html#a6d9f01958be014ec79c7618bb7b14ffd">DEFAULT_ERR_SKIPMODE</a></td></tr>
<tr class="memdesc:a1deaeda7bb9652c0e5a6d1b6a4ad1fca"><td class="mdescLeft">&#160;</td><td class="mdescRight">1 if error est to be skipped  <a href="ecd2_8h.html#a1deaeda7bb9652c0e5a6d1b6a4ad1fca">More...</a><br /></td></tr>
<tr class="separator:a1deaeda7bb9652c0e5a6d1b6a4ad1fca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc82c5e3834b5f3d4ede523bb17f3ea9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecd2_8h.html#afc82c5e3834b5f3d4ede523bb17f3ea9">killmode</a> = <a class="el" href="transferd_8h.html#a98e046db9316871de564e6a4b966775c">DEFAULT_KILLMODE</a></td></tr>
<tr class="memdesc:afc82c5e3834b5f3d4ede523bb17f3ea9"><td class="mdescLeft">&#160;</td><td class="mdescRight">decides on removal of raw key files  <a href="ecd2_8h.html#afc82c5e3834b5f3d4ede523bb17f3ea9">More...</a><br /></td></tr>
<tr class="separator:afc82c5e3834b5f3d4ede523bb17f3ea9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46fec7a15e43bfc6c030840db0536485"><td class="memItemLeft" align="right" valign="top">char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecd2_8h.html#a46fec7a15e43bfc6c030840db0536485">fname</a> [8][<a class="el" href="transferd_8h.html#ade60ede0376eec193b38f3f28cb62c5e">FNAMELENGTH</a>] = {&quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;}</td></tr>
<tr class="memdesc:a46fec7a15e43bfc6c030840db0536485"><td class="mdescLeft">&#160;</td><td class="mdescRight">filenames  <a href="ecd2_8h.html#a46fec7a15e43bfc6c030840db0536485">More...</a><br /></td></tr>
<tr class="separator:a46fec7a15e43bfc6c030840db0536485"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7c92fd80ab487ec49cee4f015f112ec"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecd2_8h.html#ad7c92fd80ab487ec49cee4f015f112ec">handle</a> [8]</td></tr>
<tr class="memdesc:ad7c92fd80ab487ec49cee4f015f112ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">handles for files accessed by raw I/O  <a href="ecd2_8h.html#ad7c92fd80ab487ec49cee4f015f112ec">More...</a><br /></td></tr>
<tr class="separator:ad7c92fd80ab487ec49cee4f015f112ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ae62e6ac7053435d99859ae80a3b48f"><td class="memItemLeft" align="right" valign="top">FILE *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecd2_8h.html#a2ae62e6ac7053435d99859ae80a3b48f">fhandle</a> [8]</td></tr>
<tr class="memdesc:a2ae62e6ac7053435d99859ae80a3b48f"><td class="mdescLeft">&#160;</td><td class="mdescRight">handles for files accessed by buffered I/O  <a href="ecd2_8h.html#a2ae62e6ac7053435d99859ae80a3b48f">More...</a><br /></td></tr>
<tr class="separator:a2ae62e6ac7053435d99859ae80a3b48f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cf2a769e7368499d8872067d8ceacfd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecd2_8h.html#a1cf2a769e7368499d8872067d8ceacfd">bellmode</a> = 0</td></tr>
<tr class="separator:a1cf2a769e7368499d8872067d8ceacfd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3dcabd5a7b4998184c8e155bfefc35df"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecd2_8h.html#a3dcabd5a7b4998184c8e155bfefc35df">disable_privacyamplification</a> = 0</td></tr>
<tr class="separator:a3dcabd5a7b4998184c8e155bfefc35df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9609eae2e0e4f132f31d442a8d3acc7f"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecd2_8h.html#a9609eae2e0e4f132f31d442a8d3acc7f">errormargin</a> = <a class="el" href="defaultdefinitions_8h.html#a6a5a750b1c467bf24f5f922a5339b4e3">DEFAULT_ERR_MARGIN</a></td></tr>
<tr class="separator:a9609eae2e0e4f132f31d442a8d3acc7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9705b16acc86a3fcb33a75cd1eb0c43c"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecd2_8h.html#a9705b16acc86a3fcb33a75cd1eb0c43c">intrinsicerr</a> = <a class="el" href="defaultdefinitions_8h.html#a22c6fd5038baa093a7028d80fc2f55df">DEFAULT_INTRINSIC</a></td></tr>
<tr class="separator:a9705b16acc86a3fcb33a75cd1eb0c43c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f893df415a3af2c9b549367a95b99b2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecd2_8h.html#a1f893df415a3af2c9b549367a95b99b2">verbosity_level</a> = <a class="el" href="readevents3_8c.html#a20610841bdaddedcf51131de8f973ed9">DEFAULT_VERBOSITY</a></td></tr>
<tr class="separator:a1f893df415a3af2c9b549367a95b99b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8efd0c1d29e7f4012507ac32171f4f11"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structpacket__received.html">packet_received</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecd2_8h.html#a8efd0c1d29e7f4012507ac32171f4f11">rec_packetlist</a> = NULL</td></tr>
<tr class="separator:a8efd0c1d29e7f4012507ac32171f4f11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a13c9e10a915cf64b0a65fd7ae52884"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecd2_8h.html#a7a13c9e10a915cf64b0a65fd7ae52884">initialerr</a> = <a class="el" href="defaultdefinitions_8h.html#a57379322053c41585c336746149f46c6">DEFAULT_INIERR</a></td></tr>
<tr class="separator:a7a13c9e10a915cf64b0a65fd7ae52884"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4b36682b94d610cc7101b139842c6b8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecd2_8h.html#af4b36682b94d610cc7101b139842c6b8">runtimeerrormode</a> = <a class="el" href="defaultdefinitions_8h.html#ad53a417c047d3d5cee5401496f5e06ca">DEFAULT_RUNTIMEERRORMODE</a></td></tr>
<tr class="separator:af4b36682b94d610cc7101b139842c6b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2ff401096a269a6d82a74ca8ebb3035"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecd2_8h.html#ae2ff401096a269a6d82a74ca8ebb3035">biconf_length</a> = <a class="el" href="defaultdefinitions_8h.html#abb34d804f15e1bbaccfadddee6171913">DEFAULT_BICONF_LENGTH</a></td></tr>
<tr class="separator:ae2ff401096a269a6d82a74ca8ebb3035"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61222323241c09cae5290bdb8e7d4916"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecd2_8h.html#a61222323241c09cae5290bdb8e7d4916">errormessage</a> []</td></tr>
<tr class="separator:a61222323241c09cae5290bdb8e7d4916"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Error correction demon. (modifications to original errcd see below). </p>
<p><br  />
 Part of the quantum key distribution software for error correction and privacy amplification. Description see below. Version as of 20071228, works also for Ekert-91 type protocols.</p>
<p>Copyright (C) 2005-2007 Christian Kurtsiefer, National University of Singapore <a href="#" onclick="location.href='mai'+'lto:'+'chr'+'is'+'tia'+'n.'+'kur'+'ts'+'ief'+'er'+'@gm'+'ai'+'l.c'+'om'; return false;">chris<span style="display: none;">.nosp@m.</span>tian<span style="display: none;">.nosp@m.</span>.kurt<span style="display: none;">.nosp@m.</span>sief<span style="display: none;">.nosp@m.</span>er@gm<span style="display: none;">.nosp@m.</span>ail.<span style="display: none;">.nosp@m.</span>com</a></p>
<p>This source code is free software; you can redistribute it and/or modify it under the terms of the GNU Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.</p>
<p>This source code is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. Please refer to the GNU Public License for more details.</p>
<p>You should have received a copy of the GNU Public License along with this source code; if not, write to: Free Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</p>
<hr  />
<p>Error correction demon. (modifications to original errcd see below).</p>
<p>Runs in the background and performs a cascade error correction algorithm on a block of raw keys. Communication with a higher level controller is done via a command pipeline, and communication with the other side is done via packets which are sent and received via pipes in the filesystem. Some parameters (connection locations, destinations) are communicated via command line parameters, others are sent via the command interface. The program is capable to handle several blocks simultaneously, and to connect corresponding messages to the relevant blocks. The final error-corrected key is stored in a file named after the first epoch. If a block processing is requested on one side, it will fix the role to "Alice", and the remote side will be the "bob" which changes the bits accordingly. Definitions according to the flowchart in DSTA deliverable D3</p>
<p>usage:</p>
<p>errcd -c commandpipe -s sendpipe -r receivepipe -d rawkeydirectory -f finalkeydirectory -l notificationpipe -q responsepipe -Q querypipe [ -e errormargin ] [ -E expectederror ] [ -k ] [ -J basicerror ] [ -T errorbehaviour ] [ -V verbosity ] [ -I ] [ -i ] [ -p ] [ -B BER | -b rounds ]</p>
<p>options/parameters:</p>
<p>DIRECTORY / CONNECTION PARAMETERS:</p>
<p>-c commandpipe: pipe for receiving commands. A command is typically an epoch name and a number of blocks to follow, separated by a whitespace. An optional error argument can be passed as a third parameter. Commands are read via fscanf, and should be terminated with a newline. -s sendpipe: binary connection which reaches to the transfer program. This is for packets to be sent out to the other side. Could be replaced by sockets later. -r receivepipe: same as sendpipe, but for incoming packets. -d rawkeydirectory: directory which contains epoch files for raw keys in stream-3 format -f finalkeydirectory: Directory which contains the final key files. -l notificationpipe: whenever a final key block is processed, its epoch name is written into this pipe or file. The content of the message is determined by the verbosity flag. -Q querypipe: to request the current status of a particular epoch block, requests may be sent into this pipe. Syntax TBD. -q respondpipe: Answers to requests will be written into this pipe or file.</p>
<p>CONTROL OPTIONS:</p>
<p>-e errormargin: A float parameter for how many standard deviations of the detected errors should be added to the information leakage estimation to eve, assuming a poissonian statistics on the found errors (i.e., if 100 error bits are found, one standard deviation in the error rate QBER is QBER /Sqrt(10). ) Default is set to 0. -E expectederror: an initial error rate can be given for choosing the length of the first test. Default is 0.05. This may be overridden by a servoed quantity or by an explicit statement in a command. -k killfile option. If set, the raw key files will be deleted after writing the final key into a file. -J basicerror: Error rate which is assumed to be generated outside the influence of an eavesdropper. -T errorbehavior: Determines the way how to react on errors which should not stop the demon. Default is 0. detailed behavior: 0: terminate program on everything 1: ignore errors on wrong packets??? 2: ignore errors inherited from other side -V verbosity: Defines verbosity mode on the logging output after a block has been processed. options: 0: just output the raw block name (epoch number in hex) 1: output the block name, number of final bits 2: output block name, num of initial bits, number of final bits, error rate 3: same as 2, but in plain text 4: same as 2, but with explicit number of leaked bits in the error correction procedure 5: same as 4, but with plain text comments -I ignoreerroroption. If this option is on, the initial error measurement for block optimization is skipped, and the default value or supplied value is chosen. This option should increase the efficiency of the key regeneration if a servo for the error rate is on. -i deviceindependent option. If this option is set, the deamon expects to receive a value for the Bell violation parameter to estimate the knowledge of an eavesdropper. -p avoid privacy amplification. For debugging purposes, to find the residual error rate -B BER: choose the number of BICONF rounds to meet a final bit error probability of BER. This assumes a residual error rate of 10^-4 after the first two rounds. -b rounds: choose the number of BICONF rounds. Defaults to 10, corresponding to a BER of 10^-7.</p>
<p>History: first specs 17.9.05chk</p>
<p>status 01.4.06 21:37; runs through and leaves no errors in final key. 1.5.06 23:20: removed biconf indexing bugs &amp; leakage errors 2.5.06 10:14 fixed readin problem with word-aligned lengths 3.5.06 19:00 does not hang over 300 calls 28.10.06 fixed sscanf to read in epochs &gt;0x7fffffff 14.07.07 logging leaked bits, verbosity options 4+5 9.-18.10.07 fixed Bell value transmission for other side 24.10.08 fixed error estimation for BB84</p>
<pre class="fragment">   introduce rawbuf variable to clean buffer in keyblock struct (status?)
</pre><p>modified version of errcd to take care of the followig problems:</p><ul>
<li>initial key permutation</li>
<li>more efficient biconf check</li>
<li>allow recursive correction after biconf error discoveries status: seems to work. needs some cleanup, and needs to be tested for longer key lenghts to confirm the BER below 10^-7 with some confidence. (chk 21.7.07)<ul>
<li>inserted error margin option to allow for a few std deviations of the detected error</li>
</ul>
</li>
</ul>
<p>open questions / issues: check assignment of short indices for bit length.... check consistency of processing status get a good RNG source or recycle some bits from the sequence....currently it uses urandom as a seed source. The pseudorandom generator in this program is a Gold sequence and possibly dangerous due to short-length correlations - perhaps something better? should have more consistency tests on packets still very chatty on debug information query/response mechanism not implemented yet </p>

<p class="definition">Definition in file <a class="el" href="ecd2_8h_source.html">ecd2.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="acd2e1b2dee36ccbff485d8e70b117170"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd2e1b2dee36ccbff485d8e70b117170">&#9670;&nbsp;</a></span>emsg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int emsg </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>code</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecd2_8c_source.html#l00006">6</a> of file <a class="el" href="ecd2_8c_source.html">ecd2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;                   {</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;  fprintf(stderr, <span class="stringliteral">&quot;%s\n&quot;</span>, <a class="code" href="ecd2_8h.html#a61222323241c09cae5290bdb8e7d4916">errormessage</a>[code]);</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;  <span class="keywordflow">return</span> code;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0ddf1224851353fc92bfbff6f499fa97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ddf1224851353fc92bfbff6f499fa97">&#9670;&nbsp;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>argv</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecd2_8c_source.html#l00073">73</a> of file <a class="el" href="ecd2_8c_source.html">ecd2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                                 {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="transferd_8h.html#a217e4b46670419e6c3665b3c9f96b7da">opt</a>;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, noshutdown;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keyword">struct </span>stat cmdstat;          <span class="comment">/* for probing pipe */</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  fd_set <a class="code" href="transferd_8h.html#a2d54a5a0b4aa30f9a0161cd3cc222851">readqueue</a>, <a class="code" href="transferd_8h.html#a9b9675408102f948906bc302287f42d2">writequeue</a>; <span class="comment">/* for main event loop */</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a>, retval2;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="keywordtype">int</span> selectmax; <span class="comment">/* keeps largest handle for select call */</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="keyword">struct </span>timeval <a class="code" href="transferd_8h.html#ad996a74def8417bb467ec4af72f1073b">HALFSECOND</a> = {0, 500000};</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keyword">struct </span>timeval TENMILLISEC = {0, 10000};</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keyword">struct </span>timeval <a class="code" href="transferd_8h.html#a03a5df464f7f59f8fe9f8da62642ce06">timeout</a>; <span class="comment">/* for select command */</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="keywordtype">int</span> send_index;         <span class="comment">/* for sending out packets */</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keyword">struct </span><a class="code" href="structpacket__to__send.html">packet_to_send</a> *tmp_packetpointer;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordtype">int</span> receive_index;             <span class="comment">/* for receiving packets */</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_e_r_r_c___p_r_o_t_o.html">ERRC_PROTO</a> msgprotobuf; <span class="comment">/* for reading header of receive packet */</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="keywordtype">char</span> *tmpreadbuf = NULL;       <span class="comment">/* pointer to hold initial read buffer */</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="keyword">struct </span><a class="code" href="structpacket__received.html">packet_received</a> *msgp;  <span class="comment">/* temporary storage of message header */</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keyword">struct </span><a class="code" href="structpacket__received.html">packet_received</a> *sbfp;  <span class="comment">/* index to go through the linked list */</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keywordtype">char</span> instring[<a class="code" href="defaultdefinitions_8h.html#a641524b6c330d204b7aa26d2e57b9c4e">CMD_INBUFLEN</a>];   <span class="comment">/* for parsing commands */</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordtype">int</span> ipt, sl;                   <span class="comment">/* cmd input variables */</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keywordtype">char</span> *dpnt;                    <span class="comment">/* ditto */</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordtype">char</span> *receivebuf;              <span class="comment">/* pointer to the currently processed packet */</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keywordtype">float</span> biconf_BER;              <span class="comment">/* to keep biconf argument */</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="comment">/* parsing parameters */</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  opterr = 0;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="keywordflow">while</span> ((<a class="code" href="transferd_8h.html#a217e4b46670419e6c3665b3c9f96b7da">opt</a> = getopt(argc, argv, <span class="stringliteral">&quot;c:s:r:d:f:l:q:Q:e:E:kJ:T:V:Ipb:B:i&quot;</span>)) !=</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;         EOF) {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <span class="comment">/* for paring filename-containing options */</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="transferd_8h.html#a217e4b46670419e6c3665b3c9f96b7da">opt</a>) {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;V&#39;</span>: <span class="comment">/* verbosity parameter */</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="keywordflow">if</span> (1 != sscanf(optarg, <span class="stringliteral">&quot;%d&quot;</span>, &amp;<a class="code" href="ecd2_8h.html#a1f893df415a3af2c9b549367a95b99b2">verbosity_level</a>)) <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(1);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;q&#39;</span>: <a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++; <span class="comment">/* respondpipe, idx=7 */</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;Q&#39;</span>: <a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++; <span class="comment">/* querypipe, idx=6 */</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;l&#39;</span>: <a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++; <span class="comment">/* notify pipe, idx=5 */</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;f&#39;</span>: <a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++; <span class="comment">/* finalkeydir, idx=4 */</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;d&#39;</span>: <a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++; <span class="comment">/* rawkeydir, idx=3 */</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;r&#39;</span>: <a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++; <span class="comment">/* commreceivepipe, idx=2 */</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;s&#39;</span>: <a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++;    <span class="comment">/* commsendpipe, idx=1 */</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;c&#39;</span>: <span class="comment">/* commandpipe, idx=0 */</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keywordflow">if</span> (1 != sscanf(optarg, <a class="code" href="defaultdefinitions_8h.html#a4f33114b553b628e239aec2724cde8cf">FNAMFORMAT</a>, <a class="code" href="ecd2_8h.html#a46fec7a15e43bfc6c030840db0536485">fname</a>[<a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])) <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(2 + <a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <a class="code" href="ecd2_8h.html#a46fec7a15e43bfc6c030840db0536485">fname</a>[<a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="defaultdefinitions_8h.html#ade60ede0376eec193b38f3f28cb62c5e">FNAMELENGTH</a> - 1] = 0; <span class="comment">/* security termination */</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;e&#39;</span>: <span class="comment">/* read in error threshold */</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="keywordflow">if</span> (1 != sscanf(optarg, <span class="stringliteral">&quot;%f&quot;</span>, &amp;<a class="code" href="ecd2_8h.html#a9609eae2e0e4f132f31d442a8d3acc7f">errormargin</a>)) <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(10);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="ecd2_8h.html#a9609eae2e0e4f132f31d442a8d3acc7f">errormargin</a> &lt; <a class="code" href="defaultdefinitions_8h.html#a4f5ccce5f92b3b188ac0fa110c47eb2d">MIN_ERR_MARGIN</a>) || (<a class="code" href="ecd2_8h.html#a9609eae2e0e4f132f31d442a8d3acc7f">errormargin</a> &gt; <a class="code" href="defaultdefinitions_8h.html#a948dac9319990b61eba637ea0df78176">MAX_ERR_MARGIN</a>))</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;          <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(11);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;E&#39;</span>: <span class="comment">/* expected error rate */</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="keywordflow">if</span> (1 != sscanf(optarg, <span class="stringliteral">&quot;%f&quot;</span>, &amp;<a class="code" href="ecd2_8h.html#a7a13c9e10a915cf64b0a65fd7ae52884">initialerr</a>)) <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(12);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="ecd2_8h.html#a7a13c9e10a915cf64b0a65fd7ae52884">initialerr</a> &lt; <a class="code" href="defaultdefinitions_8h.html#a3f3192b59954406225891ead671764ec">MIN_INI_ERR</a>) || (<a class="code" href="ecd2_8h.html#a7a13c9e10a915cf64b0a65fd7ae52884">initialerr</a> &gt; <a class="code" href="defaultdefinitions_8h.html#a74d8d9c4048eafb7f5406f32ebbe4fad">MAX_INI_ERR</a>))</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;          <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(13);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;k&#39;</span>: <span class="comment">/* kill mode for raw files */</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <a class="code" href="ecd2_8h.html#afc82c5e3834b5f3d4ede523bb17f3ea9">killmode</a> = 1;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;J&#39;</span>: <span class="comment">/* error rate generated outside eavesdropper */</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="keywordflow">if</span> (1 != sscanf(optarg, <span class="stringliteral">&quot;%f&quot;</span>, &amp;<a class="code" href="ecd2_8h.html#a9705b16acc86a3fcb33a75cd1eb0c43c">intrinsicerr</a>)) <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(14);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="ecd2_8h.html#a9705b16acc86a3fcb33a75cd1eb0c43c">intrinsicerr</a> &lt; 0) || (<a class="code" href="ecd2_8h.html#a9705b16acc86a3fcb33a75cd1eb0c43c">intrinsicerr</a> &gt; <a class="code" href="defaultdefinitions_8h.html#a4b88e1eaa0cd37a9a2e207e345146669">MAX_INTRINSIC</a>))</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;          <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(15);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>: <span class="comment">/* runtime error behaviour */</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keywordflow">if</span> (1 != sscanf(optarg, <span class="stringliteral">&quot;%d&quot;</span>, &amp;<a class="code" href="ecd2_8h.html#af4b36682b94d610cc7101b139842c6b8">runtimeerrormode</a>)) <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(16);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="ecd2_8h.html#af4b36682b94d610cc7101b139842c6b8">runtimeerrormode</a> &lt; 0) || (<a class="code" href="ecd2_8h.html#af4b36682b94d610cc7101b139842c6b8">runtimeerrormode</a> &gt; <a class="code" href="defaultdefinitions_8h.html#ae728dda749d80a0faba6d076d2c5efcb">MAXRUNTIMEERROR</a>))</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;          <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(16);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;I&#39;</span>: <span class="comment">/* skip initial error measurement */</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <a class="code" href="ecd2_8h.html#a1deaeda7bb9652c0e5a6d1b6a4ad1fca">ini_err_skipmode</a> = 1;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;i&#39;</span>: <span class="comment">/* expect a bell value for sneakage estimation */</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <a class="code" href="ecd2_8h.html#a1cf2a769e7368499d8872067d8ceacfd">bellmode</a> = 1;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;p&#39;</span>: <span class="comment">/* disable privacy amplification */</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <a class="code" href="ecd2_8h.html#a3dcabd5a7b4998184c8e155bfefc35df">disable_privacyamplification</a> = 1;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;b&#39;</span>: <span class="comment">/* set BICONF rounds */</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keywordflow">if</span> (1 != sscanf(optarg, <span class="stringliteral">&quot;%d&quot;</span>, &amp;<a class="code" href="ecd2_8h.html#aa89fe691c73c21c1e909754c91c7db9f">biconf_rounds</a>)) <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(76);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="ecd2_8h.html#aa89fe691c73c21c1e909754c91c7db9f">biconf_rounds</a> &lt;= 0) || (<a class="code" href="ecd2_8h.html#aa89fe691c73c21c1e909754c91c7db9f">biconf_rounds</a> &gt; <a class="code" href="defaultdefinitions_8h.html#a9d44da3acc0519f827e8fc5c67754ac0">MAX_BICONF_ROUNDS</a>))</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;          <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(77);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>: <span class="comment">/* take BER argument to determine biconf rounds */</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="keywordflow">if</span> (1 != sscanf(optarg, <span class="stringliteral">&quot;%f&quot;</span>, &amp;biconf_BER)) <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(78);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordflow">if</span> ((biconf_BER &lt;= 0) || (biconf_BER &gt; 1)) <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(79);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <a class="code" href="ecd2_8h.html#aa89fe691c73c21c1e909754c91c7db9f">biconf_rounds</a> = (int)(-log(biconf_BER / <a class="code" href="defaultdefinitions_8h.html#a8a9b4ad5680d8c98f36fbddcfea13eaa">AVG_BINSEARCH_ERR</a>) / log(2));</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ecd2_8h.html#aa89fe691c73c21c1e909754c91c7db9f">biconf_rounds</a> &lt;= 0) <a class="code" href="ecd2_8h.html#aa89fe691c73c21c1e909754c91c7db9f">biconf_rounds</a> = 1; <span class="comment">/* at least one */</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ecd2_8h.html#aa89fe691c73c21c1e909754c91c7db9f">biconf_rounds</a> &gt; <a class="code" href="defaultdefinitions_8h.html#a9d44da3acc0519f827e8fc5c67754ac0">MAX_BICONF_ROUNDS</a>) <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(77);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        printf(<span class="stringliteral">&quot;biconf rounds used: %d\n&quot;</span>, <a class="code" href="ecd2_8h.html#aa89fe691c73c21c1e909754c91c7db9f">biconf_rounds</a>);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  }</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="comment">/* checking parameter cosistency */</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 8; <a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ecd2_8h.html#a46fec7a15e43bfc6c030840db0536485">fname</a>[<a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][0] == 0)</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(17); <span class="comment">/* all files and pipes specified ? */</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="comment">/* open pipelines */</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="keywordflow">if</span> (stat(<a class="code" href="ecd2_8h.html#a46fec7a15e43bfc6c030840db0536485">fname</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3ea9902f55cc4b636c1f2501e7892ffdf80">handleId_commandPipe</a>], &amp;cmdstat)) <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(18); <span class="comment">/* command pipeline */</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="keywordflow">if</span> (!S_ISFIFO(cmdstat.st_mode)) <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(19);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="keywordflow">if</span> (!(<a class="code" href="ecd2_8h.html#a2ae62e6ac7053435d99859ae80a3b48f">fhandle</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3ea9902f55cc4b636c1f2501e7892ffdf80">handleId_commandPipe</a>] = fopen(<a class="code" href="ecd2_8h.html#a46fec7a15e43bfc6c030840db0536485">fname</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3ea9902f55cc4b636c1f2501e7892ffdf80">handleId_commandPipe</a>], <span class="stringliteral">&quot;r+&quot;</span>))) <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(18);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <a class="code" href="ecd2_8h.html#ad7c92fd80ab487ec49cee4f015f112ec">handle</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3ea9902f55cc4b636c1f2501e7892ffdf80">handleId_commandPipe</a>] = fileno(<a class="code" href="ecd2_8h.html#a2ae62e6ac7053435d99859ae80a3b48f">fhandle</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3ea9902f55cc4b636c1f2501e7892ffdf80">handleId_commandPipe</a>]);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordflow">if</span> (stat(<a class="code" href="ecd2_8h.html#a46fec7a15e43bfc6c030840db0536485">fname</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3ea359a6ff399089b29328c9e6dc731c354">handleId_sendPipe</a>], &amp;cmdstat)) <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(20); <span class="comment">/* send pipeline */</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keywordflow">if</span> (!S_ISFIFO(cmdstat.st_mode)) <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(21);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="ecd2_8h.html#ad7c92fd80ab487ec49cee4f015f112ec">handle</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3ea359a6ff399089b29328c9e6dc731c354">handleId_sendPipe</a>] = open(<a class="code" href="ecd2_8h.html#a46fec7a15e43bfc6c030840db0536485">fname</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3ea359a6ff399089b29328c9e6dc731c354">handleId_sendPipe</a>], <a class="code" href="defaultdefinitions_8h.html#a5e27e4ff59d87e12f61aaf1b2944de32">FIFOOUTMODE</a>)) == -1) <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(20);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="keywordflow">if</span> (stat(<a class="code" href="ecd2_8h.html#a46fec7a15e43bfc6c030840db0536485">fname</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3eab6c38e60aebca3ab02e49e8cb9e9a055">handleId_receivePipe</a>], &amp;cmdstat)) <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(22); <span class="comment">/* receive pipeline */</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keywordflow">if</span> (!S_ISFIFO(cmdstat.st_mode)) <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(23);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="ecd2_8h.html#ad7c92fd80ab487ec49cee4f015f112ec">handle</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3eab6c38e60aebca3ab02e49e8cb9e9a055">handleId_receivePipe</a>] = open(<a class="code" href="ecd2_8h.html#a46fec7a15e43bfc6c030840db0536485">fname</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3eab6c38e60aebca3ab02e49e8cb9e9a055">handleId_receivePipe</a>], <a class="code" href="defaultdefinitions_8h.html#aba5612817d3db362462229ef4109944c">FIFOINMODE</a>)) == -1) <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(22);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="keywordflow">if</span> (!(<a class="code" href="ecd2_8h.html#a2ae62e6ac7053435d99859ae80a3b48f">fhandle</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3ea61d4048a034b1debc9e694bcbb6ef95c">handleId_notifyPipe</a>] = fopen(<a class="code" href="ecd2_8h.html#a46fec7a15e43bfc6c030840db0536485">fname</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3ea61d4048a034b1debc9e694bcbb6ef95c">handleId_notifyPipe</a>], <span class="stringliteral">&quot;w+&quot;</span>)))</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(24); <span class="comment">/* notify pipeline */</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <a class="code" href="ecd2_8h.html#ad7c92fd80ab487ec49cee4f015f112ec">handle</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3ea61d4048a034b1debc9e694bcbb6ef95c">handleId_notifyPipe</a>] = fileno(<a class="code" href="ecd2_8h.html#a2ae62e6ac7053435d99859ae80a3b48f">fhandle</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3ea61d4048a034b1debc9e694bcbb6ef95c">handleId_notifyPipe</a>]);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="keywordflow">if</span> (stat(<a class="code" href="ecd2_8h.html#a46fec7a15e43bfc6c030840db0536485">fname</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3eaf69c035701e4f7512ccf7ccd393057cc">handleId_queryPipe</a>], &amp;cmdstat)) <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(25); <span class="comment">/* query pipeline */</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="keywordflow">if</span> (!S_ISFIFO(cmdstat.st_mode)) <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(26);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="keywordflow">if</span> (!(<a class="code" href="ecd2_8h.html#a2ae62e6ac7053435d99859ae80a3b48f">fhandle</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3eaf69c035701e4f7512ccf7ccd393057cc">handleId_queryPipe</a>] = fopen(<a class="code" href="ecd2_8h.html#a46fec7a15e43bfc6c030840db0536485">fname</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3eaf69c035701e4f7512ccf7ccd393057cc">handleId_queryPipe</a>], <span class="stringliteral">&quot;r+&quot;</span>))) <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(25);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <a class="code" href="ecd2_8h.html#ad7c92fd80ab487ec49cee4f015f112ec">handle</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3eaf69c035701e4f7512ccf7ccd393057cc">handleId_queryPipe</a>] = fileno(<a class="code" href="ecd2_8h.html#a2ae62e6ac7053435d99859ae80a3b48f">fhandle</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3eaf69c035701e4f7512ccf7ccd393057cc">handleId_queryPipe</a>]);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="keywordflow">if</span> (!(<a class="code" href="ecd2_8h.html#a2ae62e6ac7053435d99859ae80a3b48f">fhandle</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3ead4e3e7fcb78a7102c557c39aa1f200a5">handleId_queryRespPipe</a>] = fopen(<a class="code" href="ecd2_8h.html#a46fec7a15e43bfc6c030840db0536485">fname</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3ead4e3e7fcb78a7102c557c39aa1f200a5">handleId_queryRespPipe</a>], <span class="stringliteral">&quot;w+&quot;</span>)))</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(27); <span class="comment">/* query response pipe */</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <a class="code" href="ecd2_8h.html#ad7c92fd80ab487ec49cee4f015f112ec">handle</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3ead4e3e7fcb78a7102c557c39aa1f200a5">handleId_queryRespPipe</a>] = fileno(<a class="code" href="ecd2_8h.html#a2ae62e6ac7053435d99859ae80a3b48f">fhandle</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3ead4e3e7fcb78a7102c557c39aa1f200a5">handleId_queryRespPipe</a>]);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="comment">/* find largest handle for select call */</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <a class="code" href="ecd2_8h.html#ad7c92fd80ab487ec49cee4f015f112ec">handle</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3eac3244455b484f4e77363dc4e5577e7a7">handleId_rawKeyDir</a>] = 0;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <a class="code" href="ecd2_8h.html#ad7c92fd80ab487ec49cee4f015f112ec">handle</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3ea7a2d9b621d426a7b283d249f78abea59">handleId_finalKeyDir</a>] = 0;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  selectmax = 0;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 8; <a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">if</span> (selectmax &lt; <a class="code" href="ecd2_8h.html#ad7c92fd80ab487ec49cee4f015f112ec">handle</a>[<a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]) selectmax = <a class="code" href="ecd2_8h.html#ad7c92fd80ab487ec49cee4f015f112ec">handle</a>[<a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  selectmax += 1;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="comment">/* initializing buffers */</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <a class="code" href="ecd2_8h.html#ad2ccf7edc49e0e4e4d3f6c40df187f9b">next_packet_to_send</a> = NULL; <span class="comment">/* no packets to be sent */</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <a class="code" href="ecd2_8h.html#a533147eb4caa484f9a001a15a2a376d5">last_packet_to_send</a> = NULL;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  send_index = 0;        <span class="comment">/* index of next packet to send */</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  receive_index = 0;     <span class="comment">/* index for reading in a longer packet */</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <a class="code" href="ecd2_8h.html#a7f5d903352c2133a67099abbf29041dc">blocklist</a> = NULL;      <span class="comment">/* no active key blocks in memory */</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <a class="code" href="ecd2_8h.html#a8efd0c1d29e7f4012507ac32171f4f11">rec_packetlist</a> = NULL; <span class="comment">/* no receive packet s in queue */</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="comment">/* main loop */</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  noshutdown = 1; <span class="comment">/* keep thing running */</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  instring[0] = 0;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  ipt = 0; <span class="comment">/* input parsing */</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="comment">/* prepare select call */</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    FD_ZERO(&amp;<a class="code" href="transferd_8h.html#a2d54a5a0b4aa30f9a0161cd3cc222851">readqueue</a>);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    FD_ZERO(&amp;<a class="code" href="transferd_8h.html#a9b9675408102f948906bc302287f42d2">writequeue</a>);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    FD_SET(<a class="code" href="ecd2_8h.html#ad7c92fd80ab487ec49cee4f015f112ec">handle</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3eaf69c035701e4f7512ccf7ccd393057cc">handleId_queryPipe</a>], &amp;<a class="code" href="transferd_8h.html#a2d54a5a0b4aa30f9a0161cd3cc222851">readqueue</a>); <span class="comment">/* query pipe */</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    FD_SET(<a class="code" href="ecd2_8h.html#ad7c92fd80ab487ec49cee4f015f112ec">handle</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3eab6c38e60aebca3ab02e49e8cb9e9a055">handleId_receivePipe</a>], &amp;<a class="code" href="transferd_8h.html#a2d54a5a0b4aa30f9a0161cd3cc222851">readqueue</a>); <span class="comment">/* receive pipe */</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    FD_SET(<a class="code" href="ecd2_8h.html#ad7c92fd80ab487ec49cee4f015f112ec">handle</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3ea9902f55cc4b636c1f2501e7892ffdf80">handleId_commandPipe</a>], &amp;<a class="code" href="transferd_8h.html#a2d54a5a0b4aa30f9a0161cd3cc222851">readqueue</a>); <span class="comment">/* command pipe */</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ecd2_8h.html#ad2ccf7edc49e0e4e4d3f6c40df187f9b">next_packet_to_send</a> || send_index) {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      FD_SET(<a class="code" href="ecd2_8h.html#ad7c92fd80ab487ec49cee4f015f112ec">handle</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3ea359a6ff399089b29328c9e6dc731c354">handleId_sendPipe</a>], &amp;<a class="code" href="transferd_8h.html#a9b9675408102f948906bc302287f42d2">writequeue</a>); <span class="comment">/* content to send */</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="comment">/* keep timeout short if there is work to do */</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <a class="code" href="transferd_8h.html#a03a5df464f7f59f8fe9f8da62642ce06">timeout</a> = ((instring[0] || <a class="code" href="ecd2_8h.html#a8efd0c1d29e7f4012507ac32171f4f11">rec_packetlist</a>) ? TENMILLISEC : <a class="code" href="transferd_8h.html#ad996a74def8417bb467ec4af72f1073b">HALFSECOND</a>);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a> = select(selectmax, &amp;<a class="code" href="transferd_8h.html#a2d54a5a0b4aa30f9a0161cd3cc222851">readqueue</a>, &amp;<a class="code" href="transferd_8h.html#a9b9675408102f948906bc302287f42d2">writequeue</a>, (fd_set *)0, &amp;<a class="code" href="transferd_8h.html#a03a5df464f7f59f8fe9f8da62642ce06">timeout</a>);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a> == -1) <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(28);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="comment">// If there was a pendeing request from select</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a>) {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <span class="comment">// If there is something to write to send pipe</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <span class="keywordflow">if</span> (FD_ISSET(<a class="code" href="ecd2_8h.html#ad7c92fd80ab487ec49cee4f015f112ec">handle</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3ea359a6ff399089b29328c9e6dc731c354">handleId_sendPipe</a>], &amp;<a class="code" href="transferd_8h.html#a9b9675408102f948906bc302287f42d2">writequeue</a>)) {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="preprocessor">        #ifdef DEBUG</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        printf(<span class="stringliteral">&quot;Writing packet to sendpipe\n&quot;</span>);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        fflush(stdout);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = <a class="code" href="ecd2_8h.html#ad2ccf7edc49e0e4e4d3f6c40df187f9b">next_packet_to_send</a>-&gt;<a class="code" href="structpacket__to__send.html#ad0befdf18a26825a57674a4f59986ca2">length</a> - send_index;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a> = write(<a class="code" href="ecd2_8h.html#ad7c92fd80ab487ec49cee4f015f112ec">handle</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3ea359a6ff399089b29328c9e6dc731c354">handleId_sendPipe</a>], &amp;<a class="code" href="ecd2_8h.html#ad2ccf7edc49e0e4e4d3f6c40df187f9b">next_packet_to_send</a>-&gt;<a class="code" href="structpacket__to__send.html#a595a74e76d5e95ccc3a6360fe37f43ec">packet</a>[send_index], <a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a> == -1) <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(29);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a> == <a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>) { <span class="comment">/* packet is sent */</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;          <a class="code" href="debug_8c.html#ae9cba13dc8aa5d62e13112d01be090ba">free2</a>(<a class="code" href="ecd2_8h.html#ad2ccf7edc49e0e4e4d3f6c40df187f9b">next_packet_to_send</a>-&gt;<a class="code" href="structpacket__to__send.html#a595a74e76d5e95ccc3a6360fe37f43ec">packet</a>);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;          tmp_packetpointer = <a class="code" href="ecd2_8h.html#ad2ccf7edc49e0e4e4d3f6c40df187f9b">next_packet_to_send</a>;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;          <a class="code" href="ecd2_8h.html#ad2ccf7edc49e0e4e4d3f6c40df187f9b">next_packet_to_send</a> = <a class="code" href="ecd2_8h.html#ad2ccf7edc49e0e4e4d3f6c40df187f9b">next_packet_to_send</a>-&gt;<a class="code" href="structpacket__to__send.html#a3a11edfcaec956d36622c5131abdf239">next</a>;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="ecd2_8h.html#a533147eb4caa484f9a001a15a2a376d5">last_packet_to_send</a> == tmp_packetpointer)</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            <a class="code" href="ecd2_8h.html#a533147eb4caa484f9a001a15a2a376d5">last_packet_to_send</a> = NULL;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;          <a class="code" href="debug_8c.html#ae9cba13dc8aa5d62e13112d01be090ba">free2</a>(tmp_packetpointer); <span class="comment">/* remove packet pointer */</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;          send_index = 0;           <span class="comment">/* not digesting packet anymore */</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;          send_index += <a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a>;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      }</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      <span class="comment">// If there is something to read from cmd pipeline</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <span class="keywordflow">if</span> (FD_ISSET(<a class="code" href="ecd2_8h.html#ad7c92fd80ab487ec49cee4f015f112ec">handle</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3ea9902f55cc4b636c1f2501e7892ffdf80">handleId_commandPipe</a>], &amp;<a class="code" href="transferd_8h.html#a2d54a5a0b4aa30f9a0161cd3cc222851">readqueue</a>)) {</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a> = read(<a class="code" href="ecd2_8h.html#ad7c92fd80ab487ec49cee4f015f112ec">handle</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3ea9902f55cc4b636c1f2501e7892ffdf80">handleId_commandPipe</a>], &amp;instring[ipt], <a class="code" href="defaultdefinitions_8h.html#a641524b6c330d204b7aa26d2e57b9c4e">CMD_INBUFLEN</a> - 1 - ipt);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a> &lt; 0) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="preprocessor">        #ifdef DEBUG</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        printf(<span class="stringliteral">&quot;Read something from cmd pipe\n&quot;</span>);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        fflush(stdout);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        ipt += <a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a>;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        instring[ipt] = 0;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="keywordflow">if</span> (ipt &gt;= <a class="code" href="defaultdefinitions_8h.html#a641524b6c330d204b7aa26d2e57b9c4e">CMD_INBUFLEN</a>) <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(75); <span class="comment">/* overflow */</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                                                   <span class="comment">/* parse later... */</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      <span class="comment">/* parse input string */</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      dpnt = index(instring, <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      <span class="keywordflow">if</span> (dpnt) { <span class="comment">/* we got a newline */</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        dpnt[0] = 0;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        sl = strlen(instring);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        retval2 = <a class="code" href="ecd2_8c.html#a512509fe92d58e86e974fa3944b2e93c">process_command</a>(instring);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <span class="keywordflow">if</span> (retval2 &amp;&amp; (<a class="code" href="ecd2_8h.html#af4b36682b94d610cc7101b139842c6b8">runtimeerrormode</a> == 0)) {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;          <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(retval2); <span class="comment">/* complain */</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="comment">/* move back rest */</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; ipt - sl - 1; <a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) instring[<a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = dpnt[<a class="code" href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1];</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        ipt -= sl + 1;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        instring[ipt] = 0; <span class="comment">/* repair index */</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      }</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      <span class="comment">// If there is something to read from receive pipeline</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      <span class="keywordflow">if</span> (FD_ISSET(<a class="code" href="ecd2_8h.html#ad7c92fd80ab487ec49cee4f015f112ec">handle</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3eab6c38e60aebca3ab02e49e8cb9e9a055">handleId_receivePipe</a>], &amp;<a class="code" href="transferd_8h.html#a2d54a5a0b4aa30f9a0161cd3cc222851">readqueue</a>)) {</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="preprocessor">        #ifdef DEBUG</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        printf(<span class="stringliteral">&quot;Read something from rcv pipe\n&quot;</span>);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        fflush(stdout);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="keywordflow">if</span> (receive_index &lt; <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="struct_e_r_r_c___p_r_o_t_o.html">ERRC_PROTO</a>)) {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;          <a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a> = read(<a class="code" href="ecd2_8h.html#ad7c92fd80ab487ec49cee4f015f112ec">handle</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3eab6c38e60aebca3ab02e49e8cb9e9a055">handleId_receivePipe</a>], &amp;((<span class="keywordtype">char</span> *)&amp;msgprotobuf)[receive_index],</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                        <span class="keyword">sizeof</span>(msgprotobuf) - receive_index);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a> == -1) <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(36); <span class="comment">/* can that be better? */</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;          receive_index += <a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a>;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;          <span class="keywordflow">if</span> (receive_index == <span class="keyword">sizeof</span>(msgprotobuf)) {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            <span class="comment">/* prepare for new buffer */</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            tmpreadbuf = (<span class="keywordtype">char</span> *)<a class="code" href="debug_8c.html#af8c2db3d81151416ecd3dcb6f38e3711">malloc2</a>(msgprotobuf.bytelength);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            <span class="keywordflow">if</span> (!tmpreadbuf) <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(37);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            <span class="comment">/* transfer header */</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            memcpy(tmpreadbuf, &amp;msgprotobuf, <span class="keyword">sizeof</span>(msgprotobuf));</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;          }</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        } <span class="keywordflow">else</span> { <span class="comment">/* we are reading the main message now */</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;          <a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a> = read(<a class="code" href="ecd2_8h.html#ad7c92fd80ab487ec49cee4f015f112ec">handle</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3eab6c38e60aebca3ab02e49e8cb9e9a055">handleId_receivePipe</a>], &amp;tmpreadbuf[receive_index],</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                        msgprotobuf.bytelength - receive_index);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a> == -1) <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(36); <span class="comment">/* can that be better? */</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;          receive_index += <a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a>;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;          <span class="keywordflow">if</span> (receive_index == msgprotobuf.bytelength) { <span class="comment">/* got all */</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            msgp = (<span class="keyword">struct </span><a class="code" href="structpacket__received.html">packet_received</a> *)<a class="code" href="debug_8c.html#af8c2db3d81151416ecd3dcb6f38e3711">malloc2</a>(</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structpacket__received.html">packet_received</a>));</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            <span class="keywordflow">if</span> (!msgp) <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(38);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            <span class="comment">/* insert message in message chain */</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            msgp-&gt;<a class="code" href="structpacket__received.html#ad3821c84e373dee38d7ff84f3876fa7c">next</a> = NULL;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            msgp-&gt;<a class="code" href="structpacket__received.html#a8131ca2174b6e6ec87350ed4e2280616">length</a> = receive_index;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            msgp-&gt;<a class="code" href="structpacket__received.html#ae314ec09eb8040ccf4dec6d28c57f148">packet</a> = tmpreadbuf;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            sbfp = <a class="code" href="ecd2_8h.html#a8efd0c1d29e7f4012507ac32171f4f11">rec_packetlist</a>;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            <span class="keywordflow">if</span> (sbfp) {</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;              <span class="keywordflow">while</span> (sbfp-&gt;<a class="code" href="structpacket__received.html#ad3821c84e373dee38d7ff84f3876fa7c">next</a>) sbfp = sbfp-&gt;<a class="code" href="structpacket__received.html#ad3821c84e373dee38d7ff84f3876fa7c">next</a>;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;              sbfp-&gt;<a class="code" href="structpacket__received.html#ad3821c84e373dee38d7ff84f3876fa7c">next</a> = msgp;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;              <a class="code" href="ecd2_8h.html#a8efd0c1d29e7f4012507ac32171f4f11">rec_packetlist</a> = msgp;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            receive_index = 0; <span class="comment">/* ready for next one */</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;          }</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      }</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160; </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      <span class="comment">// If there is something to read from query pipeline</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      <span class="keywordflow">if</span> (FD_ISSET(<a class="code" href="ecd2_8h.html#ad7c92fd80ab487ec49cee4f015f112ec">handle</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3eaf69c035701e4f7512ccf7ccd393057cc">handleId_queryPipe</a>], &amp;<a class="code" href="transferd_8h.html#a2d54a5a0b4aa30f9a0161cd3cc222851">readqueue</a>)) {</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      }</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    }</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="comment">/* enter working routines for packets here */</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordflow">if</span> ((sbfp = <a class="code" href="ecd2_8h.html#a8efd0c1d29e7f4012507ac32171f4f11">rec_packetlist</a>)) { <span class="comment">/* got one message */</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      receivebuf = sbfp-&gt;<a class="code" href="structpacket__received.html#ae314ec09eb8040ccf4dec6d28c57f148">packet</a>;   <span class="comment">/* get pointer */</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      <span class="keywordflow">if</span> (((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *)receivebuf)[0] != <a class="code" href="packets_8h.html#ac4fe1c43e02ab8663f6cd57dfd5c62fb">ERRC_PROTO_tag</a>) {</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(44);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      }</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="preprocessor">      #ifdef DEBUG</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      printf(<span class="stringliteral">&quot;received message, subtype: %d, len: %d\n&quot;</span>,</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;             ((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *)receivebuf)[2],</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;             ((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *)receivebuf)[1]);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      fflush(stdout);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="preprocessor">      #endif</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      <span class="keywordflow">switch</span> (((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *)receivebuf)[2]) { <span class="comment">/* subtype */</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <span class="keywordflow">case</span> 0: <span class="comment">/* received an error estimation packet */</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;          <a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a> = <a class="code" href="qber__estim_8c.html#acce7cf9a46fcc01f52c4437a165e7a9d">process_esti_message_0</a>(receivebuf);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a>) { <span class="comment">/* an error occured */</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ecd2_8h.html#af4b36682b94d610cc7101b139842c6b8">runtimeerrormode</a> &gt; 1) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(<a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a>);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;          }</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <span class="keywordflow">case</span> 2: <span class="comment">/* received request for more bits */</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;          <a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a> = <a class="code" href="qber__estim_8c.html#ae0da977190751f93cb961052cd942fad">send_more_esti_bits</a>(receivebuf);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a>) { <span class="comment">/* an error occured */</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ecd2_8h.html#af4b36682b94d610cc7101b139842c6b8">runtimeerrormode</a> &gt; 1) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(<a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a>);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;          }</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="keywordflow">case</span> 3: <span class="comment">/* reveived error confirmation message */</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;          <a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a> = <a class="code" href="qber__estim_8c.html#a83321efc5bc5da83948e24467cbfc443">prepare_dualpass</a>(receivebuf);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a>) { <span class="comment">/* an error occured */</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ecd2_8h.html#af4b36682b94d610cc7101b139842c6b8">runtimeerrormode</a> &gt; 1) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(<a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a>);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;          }</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <span class="keywordflow">case</span> 4: <span class="comment">/* reveived parity list message */</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;          <a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a> = <a class="code" href="cascade__biconf_8c.html#a2717fa084783c56c589b8c2ebf4033b1">start_binarysearch</a>(receivebuf);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a>) { <span class="comment">/* an error occured */</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ecd2_8h.html#af4b36682b94d610cc7101b139842c6b8">runtimeerrormode</a> &gt; 1) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(<a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a>);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;          }</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <span class="keywordflow">case</span> 5: <span class="comment">/* reveive a binarysearch message */</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;          <a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a> = <a class="code" href="cascade__biconf_8c.html#a880762f9d0d644e11eb2483c17478a91">process_binarysearch</a>(receivebuf);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a>) { <span class="comment">/* an error occured */</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ecd2_8h.html#af4b36682b94d610cc7101b139842c6b8">runtimeerrormode</a> &gt; 1) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(<a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a>);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;          }</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160; </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <span class="keywordflow">case</span> 6: <span class="comment">/* receive a BICONF initiating request */</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;          <a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a> = <a class="code" href="cascade__biconf_8c.html#a11ff668df61f51cc3f7e527cef353661">generate_biconfreply</a>(receivebuf);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a>) { <span class="comment">/* an error occured */</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ecd2_8h.html#af4b36682b94d610cc7101b139842c6b8">runtimeerrormode</a> &gt; 1) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(<a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a>);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;          }</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="keywordflow">case</span> 7: <span class="comment">/* receive a BICONF parity response */</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;          <a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a> = <a class="code" href="cascade__biconf_8c.html#a42ee597caadd50095e38fd2ee47e6de2">receive_biconfreply</a>(receivebuf);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a>) { <span class="comment">/* an error occured */</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ecd2_8h.html#af4b36682b94d610cc7101b139842c6b8">runtimeerrormode</a> &gt; 1) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(<a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a>);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;          }</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        <span class="keywordflow">case</span> 8: <span class="comment">/* receive a privacy amplification start msg */</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;          <a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a> = <a class="code" href="priv__amp_8c.html#af014f9642f652afb57efba0d1eddd37b">receive_privamp_msg</a>(receivebuf);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a>) { <span class="comment">/* an error occured */</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ecd2_8h.html#af4b36682b94d610cc7101b139842c6b8">runtimeerrormode</a> &gt; 1) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(<a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a>);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;          }</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <span class="keywordflow">default</span>: <span class="comment">/* packet subtype not known */</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;          fprintf(stderr, <span class="stringliteral">&quot;received subtype %d; &quot;</span>,</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                  ((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *)receivebuf)[2]);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;          <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(45);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      }</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      <span class="comment">/* printf(&quot;receive packet successfully digested\n&quot;);</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">         fflush(stdout); */</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      <span class="comment">/* remove this packet from the queue */</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      <a class="code" href="ecd2_8h.html#a8efd0c1d29e7f4012507ac32171f4f11">rec_packetlist</a> = sbfp-&gt;<a class="code" href="structpacket__received.html#ad3821c84e373dee38d7ff84f3876fa7c">next</a>; <span class="comment">/* upate packet pointer */</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      <a class="code" href="debug_8c.html#ae9cba13dc8aa5d62e13112d01be090ba">free2</a>(receivebuf);           <span class="comment">/* free data section... */</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      <a class="code" href="debug_8c.html#ae9cba13dc8aa5d62e13112d01be090ba">free2</a>(sbfp);                 <span class="comment">/* ...and pointer entry */</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    }</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  } <span class="keywordflow">while</span> (noshutdown);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <span class="comment">/* close nicely */</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  fclose(<a class="code" href="ecd2_8h.html#a2ae62e6ac7053435d99859ae80a3b48f">fhandle</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3ea9902f55cc4b636c1f2501e7892ffdf80">handleId_commandPipe</a>]);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  close(<a class="code" href="ecd2_8h.html#ad7c92fd80ab487ec49cee4f015f112ec">handle</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3ea359a6ff399089b29328c9e6dc731c354">handleId_sendPipe</a>]);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  close(<a class="code" href="ecd2_8h.html#ad7c92fd80ab487ec49cee4f015f112ec">handle</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3eab6c38e60aebca3ab02e49e8cb9e9a055">handleId_receivePipe</a>]);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  fclose(<a class="code" href="ecd2_8h.html#a2ae62e6ac7053435d99859ae80a3b48f">fhandle</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3ea61d4048a034b1debc9e694bcbb6ef95c">handleId_notifyPipe</a>]);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  fclose(<a class="code" href="ecd2_8h.html#a2ae62e6ac7053435d99859ae80a3b48f">fhandle</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3eaf69c035701e4f7512ccf7ccd393057cc">handleId_queryPipe</a>]);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  fclose(<a class="code" href="ecd2_8h.html#a2ae62e6ac7053435d99859ae80a3b48f">fhandle</a>[<a class="code" href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3ead4e3e7fcb78a7102c557c39aa1f200a5">handleId_queryRespPipe</a>]);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a512509fe92d58e86e974fa3944b2e93c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a512509fe92d58e86e974fa3944b2e93c">&#9670;&nbsp;</a></span>process_command()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int process_command </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>in</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecd2_8c_source.html#l00014">14</a> of file <a class="el" href="ecd2_8c_source.html">ecd2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;                              {</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a>, retval2;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> newepoch; <span class="comment">/* command parser */</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  <span class="keywordtype">int</span> newepochnumber;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  <span class="keywordtype">float</span> newesterror = 0; <span class="comment">/* for initial parsing of a block */</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  <span class="keywordtype">float</span> BellValue;       <span class="comment">/* for Ekert-type protocols */</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a> = sscanf(in, <span class="stringliteral">&quot;%x %i %f %f&quot;</span>, &amp;newepoch, &amp;newepochnumber, &amp;newesterror,</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;                  &amp;BellValue);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  printf(<span class="stringliteral">&quot;got cmd: epoch: %08x, num: %d, esterr: %f retval: %d\n&quot;</span>, newepoch,</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;         newepochnumber, newesterror, <a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a>);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">  #ifdef DEBUG</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  fflush(stdout);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a>) {</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keywordflow">case</span> 0:                            <span class="comment">/* no conversion */</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="ecd2_8h.html#af4b36682b94d610cc7101b139842c6b8">runtimeerrormode</a> &gt; 0) <span class="keywordflow">break</span>; <span class="comment">/* nocomplain */</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;      <span class="keywordflow">return</span> -<a class="code" href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a>(30);                <span class="comment">/* not enough arguments */</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keywordflow">case</span> 1:                            <span class="comment">/* no number and error */</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;      newepochnumber = 1;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keywordflow">case</span> 2: <span class="comment">/* no error */</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;      newesterror = <a class="code" href="ecd2_8h.html#a7a13c9e10a915cf64b0a65fd7ae52884">initialerr</a>;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keywordflow">case</span> 3:                      <span class="comment">/* only error is supplied */</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;      BellValue = 2. * sqrt(2.); <span class="comment">/* assume perfect Bell */</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keywordflow">case</span> 4:                      <span class="comment">/* everything is there */</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      <span class="keywordflow">if</span> (newesterror &lt; 0 || newesterror &gt; <a class="code" href="defaultdefinitions_8h.html#a74d8d9c4048eafb7f5406f32ebbe4fad">MAX_INI_ERR</a>) {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ecd2_8h.html#af4b36682b94d610cc7101b139842c6b8">runtimeerrormode</a> &gt; 0) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <span class="keywordflow">return</span> 31;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      }</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      <span class="keywordflow">if</span> (newepochnumber &lt; 1) {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ecd2_8h.html#af4b36682b94d610cc7101b139842c6b8">runtimeerrormode</a> &gt; 0) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="keywordflow">return</span> 32;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      }</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      <span class="comment">/* ok, we have a sensible command; check existing */</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="thread__mgmt_8c.html#ae85a944ce8e93c3604cef0771bb4cf1d">check_epochoverlap</a>(newepoch, newepochnumber)) {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ecd2_8h.html#af4b36682b94d610cc7101b139842c6b8">runtimeerrormode</a> &gt; 0) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <span class="keywordflow">return</span> 33;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      }</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      <span class="comment">/* create new thread */</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      <span class="keywordflow">if</span> ((retval2 = <a class="code" href="thread__mgmt_8c.html#aedac9d351103f728998a59403338a03d">create_thread</a>(newepoch, newepochnumber, newesterror,</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                                   BellValue))) {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ecd2_8h.html#af4b36682b94d610cc7101b139842c6b8">runtimeerrormode</a> &gt; 0) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="keywordflow">return</span> retval2; <span class="comment">/* error reading files */</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      }</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <span class="comment">/* initiate first step of error estimation */</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <span class="keywordflow">if</span> ((retval2 = <a class="code" href="qber__estim_8c.html#aac721bd8e63ef2f563d58d393e9d4f6d">errorest_1</a>(newepoch))) {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ecd2_8h.html#af4b36682b94d610cc7101b139842c6b8">runtimeerrormode</a> &gt; 0) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="keywordflow">return</span> retval2; <span class="comment">/* error initiating err est */</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      }</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      printf(<span class="stringliteral">&quot;got a thread and will send msg1\n&quot;</span>);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">      #ifdef DEBUG</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      fflush(stdout);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">      #endif</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a1cf2a769e7368499d8872067d8ceacfd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cf2a769e7368499d8872067d8ceacfd">&#9670;&nbsp;</a></span>bellmode</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int bellmode = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecd2_8h_source.html#l00215">215</a> of file <a class="el" href="ecd2_8h_source.html">ecd2.h</a>.</p>

</div>
</div>
<a id="ae2ff401096a269a6d82a74ca8ebb3035"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2ff401096a269a6d82a74ca8ebb3035">&#9670;&nbsp;</a></span>biconf_length</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int biconf_length = <a class="el" href="defaultdefinitions_8h.html#abb34d804f15e1bbaccfadddee6171913">DEFAULT_BICONF_LENGTH</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecd2_8h_source.html#l00230">230</a> of file <a class="el" href="ecd2_8h_source.html">ecd2.h</a>.</p>

</div>
</div>
<a id="aa89fe691c73c21c1e909754c91c7db9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa89fe691c73c21c1e909754c91c7db9f">&#9670;&nbsp;</a></span>biconf_rounds</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int biconf_rounds = <a class="el" href="defaultdefinitions_8h.html#a94c768f8a25f442a8e10e5cdd446eb58">DEFAULT_BICONF_ROUNDS</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecd2_8h_source.html#l00205">205</a> of file <a class="el" href="ecd2_8h_source.html">ecd2.h</a>.</p>

</div>
</div>
<a id="a7f5d903352c2133a67099abbf29041dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f5d903352c2133a67099abbf29041dc">&#9670;&nbsp;</a></span>blocklist</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structblockpointer.html">blockpointer</a>* blocklist = NULL</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecd2_8h_source.html#l00200">200</a> of file <a class="el" href="ecd2_8h_source.html">ecd2.h</a>.</p>

</div>
</div>
<a id="a3dcabd5a7b4998184c8e155bfefc35df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3dcabd5a7b4998184c8e155bfefc35df">&#9670;&nbsp;</a></span>disable_privacyamplification</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int disable_privacyamplification = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecd2_8h_source.html#l00216">216</a> of file <a class="el" href="ecd2_8h_source.html">ecd2.h</a>.</p>

</div>
</div>
<a id="a9609eae2e0e4f132f31d442a8d3acc7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9609eae2e0e4f132f31d442a8d3acc7f">&#9670;&nbsp;</a></span>errormargin</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float errormargin = <a class="el" href="defaultdefinitions_8h.html#a6a5a750b1c467bf24f5f922a5339b4e3">DEFAULT_ERR_MARGIN</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecd2_8h_source.html#l00217">217</a> of file <a class="el" href="ecd2_8h_source.html">ecd2.h</a>.</p>

</div>
</div>
<a id="a61222323241c09cae5290bdb8e7d4916"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61222323241c09cae5290bdb8e7d4916">&#9670;&nbsp;</a></span>errormessage</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* errormessage[]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecd2_8h_source.html#l00232">232</a> of file <a class="el" href="ecd2_8h_source.html">ecd2.h</a>.</p>

</div>
</div>
<a id="a2ae62e6ac7053435d99859ae80a3b48f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ae62e6ac7053435d99859ae80a3b48f">&#9670;&nbsp;</a></span>fhandle</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">FILE* fhandle[8]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>handles for files accessed by buffered I/O </p>

<p class="definition">Definition at line <a class="el" href="ecd2_8h_source.html#l00213">213</a> of file <a class="el" href="ecd2_8h_source.html">ecd2.h</a>.</p>

</div>
</div>
<a id="a46fec7a15e43bfc6c030840db0536485"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46fec7a15e43bfc6c030840db0536485">&#9670;&nbsp;</a></span>fname</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char fname[8][<a class="el" href="transferd_8h.html#ade60ede0376eec193b38f3f28cb62c5e">FNAMELENGTH</a>] = {&quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>filenames </p>

<p class="definition">Definition at line <a class="el" href="ecd2_8h_source.html#l00211">211</a> of file <a class="el" href="ecd2_8h_source.html">ecd2.h</a>.</p>

</div>
</div>
<a id="ad7c92fd80ab487ec49cee4f015f112ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7c92fd80ab487ec49cee4f015f112ec">&#9670;&nbsp;</a></span>handle</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int handle[8]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>handles for files accessed by raw I/O </p>

<p class="definition">Definition at line <a class="el" href="ecd2_8h_source.html#l00212">212</a> of file <a class="el" href="ecd2_8h_source.html">ecd2.h</a>.</p>

</div>
</div>
<a id="a1deaeda7bb9652c0e5a6d1b6a4ad1fca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1deaeda7bb9652c0e5a6d1b6a4ad1fca">&#9670;&nbsp;</a></span>ini_err_skipmode</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ini_err_skipmode = <a class="el" href="defaultdefinitions_8h.html#a6d9f01958be014ec79c7618bb7b14ffd">DEFAULT_ERR_SKIPMODE</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>1 if error est to be skipped </p>

<p class="definition">Definition at line <a class="el" href="ecd2_8h_source.html#l00207">207</a> of file <a class="el" href="ecd2_8h_source.html">ecd2.h</a>.</p>

</div>
</div>
<a id="a7a13c9e10a915cf64b0a65fd7ae52884"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a13c9e10a915cf64b0a65fd7ae52884">&#9670;&nbsp;</a></span>initialerr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float initialerr = <a class="el" href="defaultdefinitions_8h.html#a57379322053c41585c336746149f46c6">DEFAULT_INIERR</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecd2_8h_source.html#l00228">228</a> of file <a class="el" href="ecd2_8h_source.html">ecd2.h</a>.</p>

</div>
</div>
<a id="a9705b16acc86a3fcb33a75cd1eb0c43c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9705b16acc86a3fcb33a75cd1eb0c43c">&#9670;&nbsp;</a></span>intrinsicerr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float intrinsicerr = <a class="el" href="defaultdefinitions_8h.html#a22c6fd5038baa093a7028d80fc2f55df">DEFAULT_INTRINSIC</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecd2_8h_source.html#l00218">218</a> of file <a class="el" href="ecd2_8h_source.html">ecd2.h</a>.</p>

</div>
</div>
<a id="afc82c5e3834b5f3d4ede523bb17f3ea9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc82c5e3834b5f3d4ede523bb17f3ea9">&#9670;&nbsp;</a></span>killmode</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int killmode = <a class="el" href="transferd_8h.html#a98e046db9316871de564e6a4b966775c">DEFAULT_KILLMODE</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>decides on removal of raw key files </p>

<p class="definition">Definition at line <a class="el" href="ecd2_8h_source.html#l00209">209</a> of file <a class="el" href="ecd2_8h_source.html">ecd2.h</a>.</p>

</div>
</div>
<a id="a533147eb4caa484f9a001a15a2a376d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a533147eb4caa484f9a001a15a2a376d5">&#9670;&nbsp;</a></span>last_packet_to_send</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structpacket__to__send.html">packet_to_send</a>* last_packet_to_send = NULL</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecd2_8h_source.html#l00202">202</a> of file <a class="el" href="ecd2_8h_source.html">ecd2.h</a>.</p>

</div>
</div>
<a id="ad2ccf7edc49e0e4e4d3f6c40df187f9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2ccf7edc49e0e4e4d3f6c40df187f9b">&#9670;&nbsp;</a></span>next_packet_to_send</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structpacket__to__send.html">packet_to_send</a>* next_packet_to_send = NULL</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecd2_8h_source.html#l00201">201</a> of file <a class="el" href="ecd2_8h_source.html">ecd2.h</a>.</p>

</div>
</div>
<a id="a8efd0c1d29e7f4012507ac32171f4f11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8efd0c1d29e7f4012507ac32171f4f11">&#9670;&nbsp;</a></span>rec_packetlist</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structpacket__received.html">packet_received</a>* rec_packetlist = NULL</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecd2_8h_source.html#l00226">226</a> of file <a class="el" href="ecd2_8h_source.html">ecd2.h</a>.</p>

</div>
</div>
<a id="af4b36682b94d610cc7101b139842c6b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4b36682b94d610cc7101b139842c6b8">&#9670;&nbsp;</a></span>runtimeerrormode</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int runtimeerrormode = <a class="el" href="defaultdefinitions_8h.html#ad53a417c047d3d5cee5401496f5e06ca">DEFAULT_RUNTIMEERRORMODE</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecd2_8h_source.html#l00229">229</a> of file <a class="el" href="ecd2_8h_source.html">ecd2.h</a>.</p>

</div>
</div>
<a id="a1f893df415a3af2c9b549367a95b99b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f893df415a3af2c9b549367a95b99b2">&#9670;&nbsp;</a></span>verbosity_level</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int verbosity_level = <a class="el" href="readevents3_8c.html#a20610841bdaddedcf51131de8f973ed9">DEFAULT_VERBOSITY</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecd2_8h_source.html#l00219">219</a> of file <a class="el" href="ecd2_8h_source.html">ecd2.h</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="aecd2_8h_html_afc82c5e3834b5f3d4ede523bb17f3ea9"><div class="ttname"><a href="ecd2_8h.html#afc82c5e3834b5f3d4ede523bb17f3ea9">killmode</a></div><div class="ttdeci">int killmode</div><div class="ttdoc">decides on removal of raw key files</div><div class="ttdef"><b>Definition:</b> <a href="ecd2_8h_source.html#l00209">ecd2.h:209</a></div></div>
<div class="ttc" id="adefaultdefinitions_8h_html_ade60ede0376eec193b38f3f28cb62c5e"><div class="ttname"><a href="defaultdefinitions_8h.html#ade60ede0376eec193b38f3f28cb62c5e">FNAMELENGTH</a></div><div class="ttdeci">#define FNAMELENGTH</div><div class="ttdoc">defaultdefinitions.h   Definition file for default variables in ecd2</div><div class="ttdef"><b>Definition:</b> <a href="defaultdefinitions_8h_source.html#l00034">defaultdefinitions.h:33</a></div></div>
<div class="ttc" id="aecd2_8h_html_a9609eae2e0e4f132f31d442a8d3acc7f"><div class="ttname"><a href="ecd2_8h.html#a9609eae2e0e4f132f31d442a8d3acc7f">errormargin</a></div><div class="ttdeci">float errormargin</div><div class="ttdef"><b>Definition:</b> <a href="ecd2_8h_source.html#l00217">ecd2.h:217</a></div></div>
<div class="ttc" id="adefaultdefinitions_8h_html_a4f33114b553b628e239aec2724cde8cf"><div class="ttname"><a href="defaultdefinitions_8h.html#a4f33114b553b628e239aec2724cde8cf">FNAMFORMAT</a></div><div class="ttdeci">#define FNAMFORMAT</div><div class="ttdef"><b>Definition:</b> <a href="defaultdefinitions_8h_source.html#l00035">defaultdefinitions.h:34</a></div></div>
<div class="ttc" id="adebug_8c_html_ae9cba13dc8aa5d62e13112d01be090ba"><div class="ttname"><a href="debug_8c.html#ae9cba13dc8aa5d62e13112d01be090ba">free2</a></div><div class="ttdeci">void free2(void *p)</div><div class="ttdef"><b>Definition:</b> <a href="debug_8c_source.html#l00019">debug.c:19</a></div></div>
<div class="ttc" id="aecd2_8h_html_af4b36682b94d610cc7101b139842c6b8"><div class="ttname"><a href="ecd2_8h.html#af4b36682b94d610cc7101b139842c6b8">runtimeerrormode</a></div><div class="ttdeci">int runtimeerrormode</div><div class="ttdef"><b>Definition:</b> <a href="ecd2_8h_source.html#l00229">ecd2.h:229</a></div></div>
<div class="ttc" id="aqber__estim_8c_html_ae0da977190751f93cb961052cd942fad"><div class="ttname"><a href="qber__estim_8c.html#ae0da977190751f93cb961052cd942fad">send_more_esti_bits</a></div><div class="ttdeci">int send_more_esti_bits(char *receivebuf)</div><div class="ttdef"><b>Definition:</b> <a href="qber__estim_8c_source.html#l00242">qber_estim.c:242</a></div></div>
<div class="ttc" id="athread__mgmt_8c_html_ae85a944ce8e93c3604cef0771bb4cf1d"><div class="ttname"><a href="thread__mgmt_8c.html#ae85a944ce8e93c3604cef0771bb4cf1d">check_epochoverlap</a></div><div class="ttdeci">int check_epochoverlap(unsigned int epoch, int num)</div><div class="ttdoc">ecd2_thread_mgmt.h   Part of the quantum key distribution software for error correction and privacy a...</div><div class="ttdef"><b>Definition:</b> <a href="thread__mgmt_8c_source.html#l00009">thread_mgmt.c:9</a></div></div>
<div class="ttc" id="aqber__estim_8c_html_acce7cf9a46fcc01f52c4437a165e7a9d"><div class="ttname"><a href="qber__estim_8c.html#acce7cf9a46fcc01f52c4437a165e7a9d">process_esti_message_0</a></div><div class="ttdeci">int process_esti_message_0(char *receivebuf)</div><div class="ttdef"><b>Definition:</b> <a href="qber__estim_8c_source.html#l00072">qber_estim.c:72</a></div></div>
<div class="ttc" id="aecd2_8h_html_aa89fe691c73c21c1e909754c91c7db9f"><div class="ttname"><a href="ecd2_8h.html#aa89fe691c73c21c1e909754c91c7db9f">biconf_rounds</a></div><div class="ttdeci">int biconf_rounds</div><div class="ttdef"><b>Definition:</b> <a href="ecd2_8h_source.html#l00205">ecd2.h:205</a></div></div>
<div class="ttc" id="aqber__estim_8c_html_a83321efc5bc5da83948e24467cbfc443"><div class="ttname"><a href="qber__estim_8c.html#a83321efc5bc5da83948e24467cbfc443">prepare_dualpass</a></div><div class="ttdeci">int prepare_dualpass(char *receivebuf)</div><div class="ttdef"><b>Definition:</b> <a href="qber__estim_8c_source.html#l00277">qber_estim.c:277</a></div></div>
<div class="ttc" id="atransferd_8h_html_a03a5df464f7f59f8fe9f8da62642ce06"><div class="ttname"><a href="transferd_8h.html#a03a5df464f7f59f8fe9f8da62642ce06">timeout</a></div><div class="ttdeci">struct timeval timeout</div><div class="ttdef"><b>Definition:</b> <a href="transferd_8h_source.html#l00343">transferd.h:344</a></div></div>
<div class="ttc" id="adefaultdefinitions_8h_html_aba5612817d3db362462229ef4109944c"><div class="ttname"><a href="defaultdefinitions_8h.html#aba5612817d3db362462229ef4109944c">FIFOINMODE</a></div><div class="ttdeci">#define FIFOINMODE</div><div class="ttdef"><b>Definition:</b> <a href="defaultdefinitions_8h_source.html#l00050">defaultdefinitions.h:49</a></div></div>
<div class="ttc" id="aecd2_8h_html_a61222323241c09cae5290bdb8e7d4916"><div class="ttname"><a href="ecd2_8h.html#a61222323241c09cae5290bdb8e7d4916">errormessage</a></div><div class="ttdeci">char * errormessage[]</div><div class="ttdef"><b>Definition:</b> <a href="ecd2_8h_source.html#l00232">ecd2.h:232</a></div></div>
<div class="ttc" id="atransferd_8h_html_a2d54a5a0b4aa30f9a0161cd3cc222851"><div class="ttname"><a href="transferd_8h.html#a2d54a5a0b4aa30f9a0161cd3cc222851">readqueue</a></div><div class="ttdeci">fd_set readqueue</div><div class="ttdef"><b>Definition:</b> <a href="transferd_8h_source.html#l00343">transferd.h:343</a></div></div>
<div class="ttc" id="atransferd_8h_html_a9b9675408102f948906bc302287f42d2"><div class="ttname"><a href="transferd_8h.html#a9b9675408102f948906bc302287f42d2">writequeue</a></div><div class="ttdeci">fd_set writequeue</div><div class="ttdef"><b>Definition:</b> <a href="transferd_8h_source.html#l00343">transferd.h:343</a></div></div>
<div class="ttc" id="aqber__estim_8c_html_aac721bd8e63ef2f563d58d393e9d4f6d"><div class="ttname"><a href="qber__estim_8c.html#aac721bd8e63ef2f563d58d393e9d4f6d">errorest_1</a></div><div class="ttdeci">int errorest_1(unsigned int epoch)</div><div class="ttdef"><b>Definition:</b> <a href="qber__estim_8c_source.html#l00024">qber_estim.c:24</a></div></div>
<div class="ttc" id="acascade__biconf_8c_html_a42ee597caadd50095e38fd2ee47e6de2"><div class="ttname"><a href="cascade__biconf_8c.html#a42ee597caadd50095e38fd2ee47e6de2">receive_biconfreply</a></div><div class="ttdeci">int receive_biconfreply(char *receivebuf)</div><div class="ttdef"><b>Definition:</b> <a href="cascade__biconf_8c_source.html#l00847">cascade_biconf.c:847</a></div></div>
<div class="ttc" id="athread__mgmt_8c_html_aedac9d351103f728998a59403338a03d"><div class="ttname"><a href="thread__mgmt_8c.html#aedac9d351103f728998a59403338a03d">create_thread</a></div><div class="ttdeci">int create_thread(unsigned int epoch, int num, float inierr, float BellValue)</div><div class="ttdef"><b>Definition:</b> <a href="thread__mgmt_8c_source.html#l00029">thread_mgmt.c:29</a></div></div>
<div class="ttc" id="astructpacket__to__send_html_a595a74e76d5e95ccc3a6360fe37f43ec"><div class="ttname"><a href="structpacket__to__send.html#a595a74e76d5e95ccc3a6360fe37f43ec">packet_to_send::packet</a></div><div class="ttdeci">char * packet</div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00168">packets.h:168</a></div></div>
<div class="ttc" id="ahelpers_8h_html_a60dccdec5aced9500d5f728bce5b9b3eaf69c035701e4f7512ccf7ccd393057cc"><div class="ttname"><a href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3eaf69c035701e4f7512ccf7ccd393057cc">handleId_queryPipe</a></div><div class="ttdeci">@ handleId_queryPipe</div><div class="ttdef"><b>Definition:</b> <a href="helpers_8h_source.html#l00057">helpers.h:57</a></div></div>
<div class="ttc" id="apackets_8h_html_ac4fe1c43e02ab8663f6cd57dfd5c62fb"><div class="ttname"><a href="packets_8h.html#ac4fe1c43e02ab8663f6cd57dfd5c62fb">ERRC_PROTO_tag</a></div><div class="ttdeci">#define ERRC_PROTO_tag</div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00044">packets.h:43</a></div></div>
<div class="ttc" id="acascade__biconf_8c_html_a2717fa084783c56c589b8c2ebf4033b1"><div class="ttname"><a href="cascade__biconf_8c.html#a2717fa084783c56c589b8c2ebf4033b1">start_binarysearch</a></div><div class="ttdeci">int start_binarysearch(char *receivebuf)</div><div class="ttdoc">Function to proceed with the parity evaluation message.</div><div class="ttdef"><b>Definition:</b> <a href="cascade__biconf_8c_source.html#l00560">cascade_biconf.c:560</a></div></div>
<div class="ttc" id="ahelpers_8h_html_a60dccdec5aced9500d5f728bce5b9b3ea7a2d9b621d426a7b283d249f78abea59"><div class="ttname"><a href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3ea7a2d9b621d426a7b283d249f78abea59">handleId_finalKeyDir</a></div><div class="ttdeci">@ handleId_finalKeyDir</div><div class="ttdef"><b>Definition:</b> <a href="helpers_8h_source.html#l00055">helpers.h:55</a></div></div>
<div class="ttc" id="ahelpers_8h_html_a60dccdec5aced9500d5f728bce5b9b3ea61d4048a034b1debc9e694bcbb6ef95c"><div class="ttname"><a href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3ea61d4048a034b1debc9e694bcbb6ef95c">handleId_notifyPipe</a></div><div class="ttdeci">@ handleId_notifyPipe</div><div class="ttdef"><b>Definition:</b> <a href="helpers_8h_source.html#l00056">helpers.h:56</a></div></div>
<div class="ttc" id="aecd2_8h_html_a2ae62e6ac7053435d99859ae80a3b48f"><div class="ttname"><a href="ecd2_8h.html#a2ae62e6ac7053435d99859ae80a3b48f">fhandle</a></div><div class="ttdeci">FILE * fhandle[8]</div><div class="ttdoc">handles for files accessed by buffered I/O</div><div class="ttdef"><b>Definition:</b> <a href="ecd2_8h_source.html#l00213">ecd2.h:213</a></div></div>
<div class="ttc" id="adefaultdefinitions_8h_html_a4f5ccce5f92b3b188ac0fa110c47eb2d"><div class="ttname"><a href="defaultdefinitions_8h.html#a4f5ccce5f92b3b188ac0fa110c47eb2d">MIN_ERR_MARGIN</a></div><div class="ttdeci">#define MIN_ERR_MARGIN</div><div class="ttdef"><b>Definition:</b> <a href="defaultdefinitions_8h_source.html#l00037">defaultdefinitions.h:36</a></div></div>
<div class="ttc" id="adefaultdefinitions_8h_html_a8a9b4ad5680d8c98f36fbddcfea13eaa"><div class="ttname"><a href="defaultdefinitions_8h.html#a8a9b4ad5680d8c98f36fbddcfea13eaa">AVG_BINSEARCH_ERR</a></div><div class="ttdeci">#define AVG_BINSEARCH_ERR</div><div class="ttdef"><b>Definition:</b> <a href="defaultdefinitions_8h_source.html#l00061">defaultdefinitions.h:60</a></div></div>
<div class="ttc" id="adebug_8c_html_af8c2db3d81151416ecd3dcb6f38e3711"><div class="ttname"><a href="debug_8c.html#af8c2db3d81151416ecd3dcb6f38e3711">malloc2</a></div><div class="ttdeci">char * malloc2(unsigned int s)</div><div class="ttdef"><b>Definition:</b> <a href="debug_8c_source.html#l00007">debug.c:7</a></div></div>
<div class="ttc" id="aecd2_8c_html_a512509fe92d58e86e974fa3944b2e93c"><div class="ttname"><a href="ecd2_8c.html#a512509fe92d58e86e974fa3944b2e93c">process_command</a></div><div class="ttdeci">int process_command(char *in)</div><div class="ttdef"><b>Definition:</b> <a href="ecd2_8c_source.html#l00014">ecd2.c:14</a></div></div>
<div class="ttc" id="atransferd_8h_html_a217e4b46670419e6c3665b3c9f96b7da"><div class="ttname"><a href="transferd_8h.html#a217e4b46670419e6c3665b3c9f96b7da">opt</a></div><div class="ttdeci">int opt</div><div class="ttdef"><b>Definition:</b> <a href="transferd_8h_source.html#l00321">transferd.h:321</a></div></div>
<div class="ttc" id="ahelpers_8h_html_a60dccdec5aced9500d5f728bce5b9b3eab6c38e60aebca3ab02e49e8cb9e9a055"><div class="ttname"><a href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3eab6c38e60aebca3ab02e49e8cb9e9a055">handleId_receivePipe</a></div><div class="ttdeci">@ handleId_receivePipe</div><div class="ttdef"><b>Definition:</b> <a href="helpers_8h_source.html#l00053">helpers.h:53</a></div></div>
<div class="ttc" id="apriv__amp_8c_html_af014f9642f652afb57efba0d1eddd37b"><div class="ttname"><a href="priv__amp_8c.html#af014f9642f652afb57efba0d1eddd37b">receive_privamp_msg</a></div><div class="ttdeci">int receive_privamp_msg(char *receivebuf)</div><div class="ttdef"><b>Definition:</b> <a href="priv__amp_8c_source.html#l00039">priv_amp.c:39</a></div></div>
<div class="ttc" id="aecd2_8h_html_a8efd0c1d29e7f4012507ac32171f4f11"><div class="ttname"><a href="ecd2_8h.html#a8efd0c1d29e7f4012507ac32171f4f11">rec_packetlist</a></div><div class="ttdeci">struct packet_received * rec_packetlist</div><div class="ttdef"><b>Definition:</b> <a href="ecd2_8h_source.html#l00226">ecd2.h:226</a></div></div>
<div class="ttc" id="adefaultdefinitions_8h_html_a5e27e4ff59d87e12f61aaf1b2944de32"><div class="ttname"><a href="defaultdefinitions_8h.html#a5e27e4ff59d87e12f61aaf1b2944de32">FIFOOUTMODE</a></div><div class="ttdeci">#define FIFOOUTMODE</div><div class="ttdef"><b>Definition:</b> <a href="defaultdefinitions_8h_source.html#l00051">defaultdefinitions.h:50</a></div></div>
<div class="ttc" id="astructpacket__received_html_ad3821c84e373dee38d7ff84f3876fa7c"><div class="ttname"><a href="structpacket__received.html#ad3821c84e373dee38d7ff84f3876fa7c">packet_received::next</a></div><div class="ttdeci">struct packet_received * next</div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00176">packets.h:176</a></div></div>
<div class="ttc" id="astructpacket__received_html_ae314ec09eb8040ccf4dec6d28c57f148"><div class="ttname"><a href="structpacket__received.html#ae314ec09eb8040ccf4dec6d28c57f148">packet_received::packet</a></div><div class="ttdeci">char * packet</div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00175">packets.h:175</a></div></div>
<div class="ttc" id="atransferd_8h_html_a7f345697df7eb20c9aba1ab6980cae8f"><div class="ttname"><a href="transferd_8h.html#a7f345697df7eb20c9aba1ab6980cae8f">retval</a></div><div class="ttdeci">int retval</div><div class="ttdef"><b>Definition:</b> <a href="transferd_8h_source.html#l00321">transferd.h:321</a></div></div>
<div class="ttc" id="astructpacket__received_html"><div class="ttname"><a href="structpacket__received.html">packet_received</a></div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00173">packets.h:173</a></div></div>
<div class="ttc" id="aecd2_8h_html_ad7c92fd80ab487ec49cee4f015f112ec"><div class="ttname"><a href="ecd2_8h.html#ad7c92fd80ab487ec49cee4f015f112ec">handle</a></div><div class="ttdeci">int handle[8]</div><div class="ttdoc">handles for files accessed by raw I/O</div><div class="ttdef"><b>Definition:</b> <a href="ecd2_8h_source.html#l00212">ecd2.h:212</a></div></div>
<div class="ttc" id="astruct_e_r_r_c___p_r_o_t_o_html"><div class="ttname"><a href="struct_e_r_r_c___p_r_o_t_o.html">ERRC_PROTO</a></div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00039">packets.h:39</a></div></div>
<div class="ttc" id="astructpacket__to__send_html_ad0befdf18a26825a57674a4f59986ca2"><div class="ttname"><a href="structpacket__to__send.html#ad0befdf18a26825a57674a4f59986ca2">packet_to_send::length</a></div><div class="ttdeci">int length</div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00167">packets.h:167</a></div></div>
<div class="ttc" id="adefaultdefinitions_8h_html_a3f3192b59954406225891ead671764ec"><div class="ttname"><a href="defaultdefinitions_8h.html#a3f3192b59954406225891ead671764ec">MIN_INI_ERR</a></div><div class="ttdeci">#define MIN_INI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="defaultdefinitions_8h_source.html#l00040">defaultdefinitions.h:39</a></div></div>
<div class="ttc" id="ahelpers_8h_html_a60dccdec5aced9500d5f728bce5b9b3eac3244455b484f4e77363dc4e5577e7a7"><div class="ttname"><a href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3eac3244455b484f4e77363dc4e5577e7a7">handleId_rawKeyDir</a></div><div class="ttdeci">@ handleId_rawKeyDir</div><div class="ttdef"><b>Definition:</b> <a href="helpers_8h_source.html#l00054">helpers.h:54</a></div></div>
<div class="ttc" id="acascade__biconf_8c_html_a880762f9d0d644e11eb2483c17478a91"><div class="ttname"><a href="cascade__biconf_8c.html#a880762f9d0d644e11eb2483c17478a91">process_binarysearch</a></div><div class="ttdeci">int process_binarysearch(char *receivebuf)</div><div class="ttdef"><b>Definition:</b> <a href="cascade__biconf_8c_source.html#l00622">cascade_biconf.c:622</a></div></div>
<div class="ttc" id="aecd2_8h_html_a46fec7a15e43bfc6c030840db0536485"><div class="ttname"><a href="ecd2_8h.html#a46fec7a15e43bfc6c030840db0536485">fname</a></div><div class="ttdeci">char fname[8][FNAMELENGTH]</div><div class="ttdoc">filenames</div><div class="ttdef"><b>Definition:</b> <a href="ecd2_8h_source.html#l00211">ecd2.h:211</a></div></div>
<div class="ttc" id="aecd2_8h_html_a3dcabd5a7b4998184c8e155bfefc35df"><div class="ttname"><a href="ecd2_8h.html#a3dcabd5a7b4998184c8e155bfefc35df">disable_privacyamplification</a></div><div class="ttdeci">int disable_privacyamplification</div><div class="ttdef"><b>Definition:</b> <a href="ecd2_8h_source.html#l00216">ecd2.h:216</a></div></div>
<div class="ttc" id="ahelpers_8h_html_a60dccdec5aced9500d5f728bce5b9b3ea359a6ff399089b29328c9e6dc731c354"><div class="ttname"><a href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3ea359a6ff399089b29328c9e6dc731c354">handleId_sendPipe</a></div><div class="ttdeci">@ handleId_sendPipe</div><div class="ttdef"><b>Definition:</b> <a href="helpers_8h_source.html#l00052">helpers.h:52</a></div></div>
<div class="ttc" id="adefaultdefinitions_8h_html_a641524b6c330d204b7aa26d2e57b9c4e"><div class="ttname"><a href="defaultdefinitions_8h.html#a641524b6c330d204b7aa26d2e57b9c4e">CMD_INBUFLEN</a></div><div class="ttdeci">#define CMD_INBUFLEN</div><div class="ttdef"><b>Definition:</b> <a href="defaultdefinitions_8h_source.html#l00063">defaultdefinitions.h:62</a></div></div>
<div class="ttc" id="adefaultdefinitions_8h_html_a74d8d9c4048eafb7f5406f32ebbe4fad"><div class="ttname"><a href="defaultdefinitions_8h.html#a74d8d9c4048eafb7f5406f32ebbe4fad">MAX_INI_ERR</a></div><div class="ttdeci">#define MAX_INI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="defaultdefinitions_8h_source.html#l00041">defaultdefinitions.h:40</a></div></div>
<div class="ttc" id="aecd2_8h_html_a533147eb4caa484f9a001a15a2a376d5"><div class="ttname"><a href="ecd2_8h.html#a533147eb4caa484f9a001a15a2a376d5">last_packet_to_send</a></div><div class="ttdeci">struct packet_to_send * last_packet_to_send</div><div class="ttdef"><b>Definition:</b> <a href="ecd2_8h_source.html#l00202">ecd2.h:202</a></div></div>
<div class="ttc" id="aecd2_8h_html_a1cf2a769e7368499d8872067d8ceacfd"><div class="ttname"><a href="ecd2_8h.html#a1cf2a769e7368499d8872067d8ceacfd">bellmode</a></div><div class="ttdeci">int bellmode</div><div class="ttdef"><b>Definition:</b> <a href="ecd2_8h_source.html#l00215">ecd2.h:215</a></div></div>
<div class="ttc" id="aecd2_8h_html_a7f5d903352c2133a67099abbf29041dc"><div class="ttname"><a href="ecd2_8h.html#a7f5d903352c2133a67099abbf29041dc">blocklist</a></div><div class="ttdeci">struct blockpointer * blocklist</div><div class="ttdef"><b>Definition:</b> <a href="ecd2_8h_source.html#l00200">ecd2.h:200</a></div></div>
<div class="ttc" id="aecd2_8h_html_ad2ccf7edc49e0e4e4d3f6c40df187f9b"><div class="ttname"><a href="ecd2_8h.html#ad2ccf7edc49e0e4e4d3f6c40df187f9b">next_packet_to_send</a></div><div class="ttdeci">struct packet_to_send * next_packet_to_send</div><div class="ttdef"><b>Definition:</b> <a href="ecd2_8h_source.html#l00201">ecd2.h:201</a></div></div>
<div class="ttc" id="adefaultdefinitions_8h_html_a4b88e1eaa0cd37a9a2e207e345146669"><div class="ttname"><a href="defaultdefinitions_8h.html#a4b88e1eaa0cd37a9a2e207e345146669">MAX_INTRINSIC</a></div><div class="ttdeci">#define MAX_INTRINSIC</div><div class="ttdef"><b>Definition:</b> <a href="defaultdefinitions_8h_source.html#l00047">defaultdefinitions.h:46</a></div></div>
<div class="ttc" id="adefaultdefinitions_8h_html_ae728dda749d80a0faba6d076d2c5efcb"><div class="ttname"><a href="defaultdefinitions_8h.html#ae728dda749d80a0faba6d076d2c5efcb">MAXRUNTIMEERROR</a></div><div class="ttdeci">#define MAXRUNTIMEERROR</div><div class="ttdef"><b>Definition:</b> <a href="defaultdefinitions_8h_source.html#l00049">defaultdefinitions.h:48</a></div></div>
<div class="ttc" id="aecd2_8h_html_a9705b16acc86a3fcb33a75cd1eb0c43c"><div class="ttname"><a href="ecd2_8h.html#a9705b16acc86a3fcb33a75cd1eb0c43c">intrinsicerr</a></div><div class="ttdeci">float intrinsicerr</div><div class="ttdef"><b>Definition:</b> <a href="ecd2_8h_source.html#l00218">ecd2.h:218</a></div></div>
<div class="ttc" id="acascade__biconf_8c_html_a11ff668df61f51cc3f7e527cef353661"><div class="ttname"><a href="cascade__biconf_8c.html#a11ff668df61f51cc3f7e527cef353661">generate_biconfreply</a></div><div class="ttdeci">int generate_biconfreply(char *receivebuf)</div><div class="ttdoc">Start the parity generation process on Alice side.</div><div class="ttdef"><b>Definition:</b> <a href="cascade__biconf_8c_source.html#l00427">cascade_biconf.c:427</a></div></div>
<div class="ttc" id="astructpacket__to__send_html_a3a11edfcaec956d36622c5131abdf239"><div class="ttname"><a href="structpacket__to__send.html#a3a11edfcaec956d36622c5131abdf239">packet_to_send::next</a></div><div class="ttdeci">struct packet_to_send * next</div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00169">packets.h:169</a></div></div>
<div class="ttc" id="adefaultdefinitions_8h_html_a9d44da3acc0519f827e8fc5c67754ac0"><div class="ttname"><a href="defaultdefinitions_8h.html#a9d44da3acc0519f827e8fc5c67754ac0">MAX_BICONF_ROUNDS</a></div><div class="ttdeci">#define MAX_BICONF_ROUNDS</div><div class="ttdef"><b>Definition:</b> <a href="defaultdefinitions_8h_source.html#l00060">defaultdefinitions.h:59</a></div></div>
<div class="ttc" id="aecd2_8h_html_a1f893df415a3af2c9b549367a95b99b2"><div class="ttname"><a href="ecd2_8h.html#a1f893df415a3af2c9b549367a95b99b2">verbosity_level</a></div><div class="ttdeci">int verbosity_level</div><div class="ttdef"><b>Definition:</b> <a href="ecd2_8h_source.html#l00219">ecd2.h:219</a></div></div>
<div class="ttc" id="astructpacket__received_html_a8131ca2174b6e6ec87350ed4e2280616"><div class="ttname"><a href="structpacket__received.html#a8131ca2174b6e6ec87350ed4e2280616">packet_received::length</a></div><div class="ttdeci">int length</div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00174">packets.h:174</a></div></div>
<div class="ttc" id="atransferd_8h_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="transferd_8h.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="transferd_8h_source.html#l00321">transferd.h:321</a></div></div>
<div class="ttc" id="ahelpers_8h_html_a60dccdec5aced9500d5f728bce5b9b3ead4e3e7fcb78a7102c557c39aa1f200a5"><div class="ttname"><a href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3ead4e3e7fcb78a7102c557c39aa1f200a5">handleId_queryRespPipe</a></div><div class="ttdeci">@ handleId_queryRespPipe</div><div class="ttdef"><b>Definition:</b> <a href="helpers_8h_source.html#l00059">helpers.h:58</a></div></div>
<div class="ttc" id="adefaultdefinitions_8h_html_a948dac9319990b61eba637ea0df78176"><div class="ttname"><a href="defaultdefinitions_8h.html#a948dac9319990b61eba637ea0df78176">MAX_ERR_MARGIN</a></div><div class="ttdeci">#define MAX_ERR_MARGIN</div><div class="ttdef"><b>Definition:</b> <a href="defaultdefinitions_8h_source.html#l00038">defaultdefinitions.h:37</a></div></div>
<div class="ttc" id="aecd2_8h_html_a7a13c9e10a915cf64b0a65fd7ae52884"><div class="ttname"><a href="ecd2_8h.html#a7a13c9e10a915cf64b0a65fd7ae52884">initialerr</a></div><div class="ttdeci">float initialerr</div><div class="ttdef"><b>Definition:</b> <a href="ecd2_8h_source.html#l00228">ecd2.h:228</a></div></div>
<div class="ttc" id="aecd2_8c_html_acd2e1b2dee36ccbff485d8e70b117170"><div class="ttname"><a href="ecd2_8c.html#acd2e1b2dee36ccbff485d8e70b117170">emsg</a></div><div class="ttdeci">int emsg(int code)</div><div class="ttdef"><b>Definition:</b> <a href="ecd2_8c_source.html#l00006">ecd2.c:6</a></div></div>
<div class="ttc" id="aecd2_8h_html_a1deaeda7bb9652c0e5a6d1b6a4ad1fca"><div class="ttname"><a href="ecd2_8h.html#a1deaeda7bb9652c0e5a6d1b6a4ad1fca">ini_err_skipmode</a></div><div class="ttdeci">int ini_err_skipmode</div><div class="ttdoc">1 if error est to be skipped</div><div class="ttdef"><b>Definition:</b> <a href="ecd2_8h_source.html#l00207">ecd2.h:207</a></div></div>
<div class="ttc" id="astructpacket__to__send_html"><div class="ttname"><a href="structpacket__to__send.html">packet_to_send</a></div><div class="ttdef"><b>Definition:</b> <a href="packets_8h_source.html#l00166">packets.h:166</a></div></div>
<div class="ttc" id="ahelpers_8h_html_a60dccdec5aced9500d5f728bce5b9b3ea9902f55cc4b636c1f2501e7892ffdf80"><div class="ttname"><a href="helpers_8h.html#a60dccdec5aced9500d5f728bce5b9b3ea9902f55cc4b636c1f2501e7892ffdf80">handleId_commandPipe</a></div><div class="ttdeci">@ handleId_commandPipe</div><div class="ttdef"><b>Definition:</b> <a href="helpers_8h_source.html#l00051">helpers.h:51</a></div></div>
<div class="ttc" id="atransferd_8h_html_ad996a74def8417bb467ec4af72f1073b"><div class="ttname"><a href="transferd_8h.html#ad996a74def8417bb467ec4af72f1073b">HALFSECOND</a></div><div class="ttdeci">struct timeval HALFSECOND</div><div class="ttdef"><b>Definition:</b> <a href="transferd_8h_source.html#l00226">transferd.h:313</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_69202652be06fd0e05a491cdb470f56e.html">errorcorrection</a></li><li class="navelem"><a class="el" href="ecd2_8h.html">ecd2.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.19 </li>
  </ul>
</div>
</body>
</html>
